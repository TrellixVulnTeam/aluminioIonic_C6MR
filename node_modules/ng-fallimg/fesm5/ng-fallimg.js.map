{"version":3,"file":"ng-fallimg.js","sources":["ng:/ng-fallimg/lib/ng-fallimg-sources.ts","ng:/ng-fallimg/lib/ng-fallimg.directive.ts","ng:/ng-fallimg/lib/ng-fallimg.module.ts"],"names":[],"mappings":"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","sourcesContent":["/**\n * Injector token constant that contains all the fallback sources \n */\n\nexport const NG_FALLIMG_SOURCES = 'NG_FALLIMG_SOURCES';\n\n/**\n * Interface that define the object to pass to charged the fallback sources\n */\n\nexport interface IFallimgSource {\n    default: string;\n    [extraProps: string]: string\n}\n","import { Directive, ElementRef, Input, HostListener, Inject } from '@angular/core';\nimport { NG_FALLIMG_SOURCES, IFallimgSource } from './ng-fallimg-sources';\n\n/**\n * Directive for handling the default image when the main image doesn't works\n */\n\n@Directive({\n  selector: 'img[fallimg]'\n})\nexport class NgFallimgDirective {\n\n  /**\n   * Input that receive an optional key for returning the source\n   */\n\n  @Input('fallimg') public fallimg: string;\n\n  /**\n   * It contains the last source setted when the main source fails\n   */\n\n  private lastSource: string;\n\n  /**\n   * \n   * @param el ElementRef service\n   * @param fallimgSources Injector token that contains all the fallback sources\n   */\n\n  constructor(\n    private el: ElementRef,\n    @Inject( NG_FALLIMG_SOURCES ) private fallimgSources: IFallimgSource\n  ) {}\n\n  /**\n   * It handles the error when the main image doesn't load\n   */\n\n  @HostListener('error')\n  private errorImgHandler(): void {\n\n    // The chosen source\n    const source = this.fallimgSources[ this.fallimg || 'default' ];\n\n    // Verify if the key exists in all fallback sources\n    if (!source) {\n      throw new Error(`ng-fallimg error: ${ this.fallimg } doesn't exist as a source or it is an empty source`);\n    }\n\n    // it checks if the charged source is different to the actual source, this avoid the infinite bucle creation\n    if (source !== this.lastSource) {\n\n      // It saves the last source for matching when the fallback source fails and retried, that avoid an infinite bucle\n      this.lastSource = source;\n      (this.el.nativeElement as HTMLImageElement).src = source;\n      \n    }\n  }\n}\n","import { NgModule, ModuleWithProviders } from '@angular/core';\nimport { NgFallimgDirective } from './ng-fallimg.directive';\nimport { NG_FALLIMG_SOURCES, IFallimgSource } from './ng-fallimg-sources';\n\n@NgModule({\n  declarations: [NgFallimgDirective],\n  exports: [NgFallimgDirective]\n})\nexport class NgFallimgModule { \n  \n  /**\n   * @param sources All the fallback sources\n   */\n  \n  static forRoot(sources: IFallimgSource): ModuleWithProviders {\n    return {\n      ngModule: NgFallimgModule,\n      providers: [\n        {\n          provide: NG_FALLIMG_SOURCES,\n          useValue: sources\n        }\n      ]\n    };\n  }\n}\n"]}