/**
 * @fileoverview added by tsickle
 * Generated from: lib/ngx-restangular.ts
 * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingRequire,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { Injectable, Inject, Injector, Optional } from '@angular/core';
import { assign } from 'core-js/features/object';
import { map, bind, union, values, pick, isEmpty, isFunction, isNumber, isUndefined, isArray, isObject, extend, each, every, omit, get, defaults, clone, includes } from 'lodash';
import { BehaviorSubject } from 'rxjs';
import { filter } from 'rxjs/operators';
import { RESTANGULAR } from './ngx-restangular.config';
import { RestangularHttp } from './ngx-restangular-http';
import { RestangularConfigurer } from './ngx-restangular-config.factory';
import * as ɵngcc0 from '@angular/core';
export class Restangular {
    /**
     * @param {?} configObj
     * @param {?} injector
     * @param {?} http
     */
    constructor(configObj, injector, http) {
        this.configObj = configObj;
        this.injector = injector;
        this.http = http;
        this.provider = new providerConfig(http);
        /** @type {?} */
        const element = this.provider.$get();
        assign(this, element);
        this.setDefaultConfig();
    }
    /**
     * @return {?}
     */
    setDefaultConfig() {
        if (!this.configObj || !isFunction(this.configObj.fn)) {
            return;
        }
        /** @type {?} */
        const arrDI = map(this.configObj.arrServices, (/**
         * @param {?} services
         * @return {?}
         */
        (services) => {
            return this.injector.get(services);
        }));
        this.configObj.fn(...[this.provider, ...arrDI]);
    }
}
Restangular.ɵfac = function Restangular_Factory(t) { return new (t || Restangular)(ɵngcc0.ɵɵinject(RESTANGULAR, 8), ɵngcc0.ɵɵinject(ɵngcc0.Injector), ɵngcc0.ɵɵinject(RestangularHttp)); };
Restangular.ɵprov = ɵngcc0.ɵɵdefineInjectable({ token: Restangular, factory: Restangular.ɵfac });
/** @nocollapse */
Restangular.ctorParameters = () => [
    { type: undefined, decorators: [{ type: Optional }, { type: Inject, args: [RESTANGULAR,] }] },
    { type: Injector },
    { type: RestangularHttp }
];
/*@__PURE__*/ (function () { ɵngcc0.ɵsetClassMetadata(Restangular, [{
        type: Injectable
    }], function () { return [{ type: undefined, decorators: [{
                type: Optional
            }, {
                type: Inject,
                args: [RESTANGULAR]
            }] }, { type: ɵngcc0.Injector }, { type: RestangularHttp }]; }, null); })();
if (false) {
    /** @type {?} */
    Restangular.prototype.provider;
    /** @type {?} */
    Restangular.prototype.addElementTransformer;
    /** @type {?} */
    Restangular.prototype.extendCollection;
    /** @type {?} */
    Restangular.prototype.extendModel;
    /** @type {?} */
    Restangular.prototype.copy;
    /** @type {?} */
    Restangular.prototype.configuration;
    /** @type {?} */
    Restangular.prototype.service;
    /** @type {?} */
    Restangular.prototype.id;
    /** @type {?} */
    Restangular.prototype.route;
    /** @type {?} */
    Restangular.prototype.parentResource;
    /** @type {?} */
    Restangular.prototype.restangularCollection;
    /** @type {?} */
    Restangular.prototype.cannonicalId;
    /** @type {?} */
    Restangular.prototype.etag;
    /** @type {?} */
    Restangular.prototype.selfLink;
    /** @type {?} */
    Restangular.prototype.get;
    /** @type {?} */
    Restangular.prototype.getList;
    /** @type {?} */
    Restangular.prototype.put;
    /** @type {?} */
    Restangular.prototype.post;
    /** @type {?} */
    Restangular.prototype.remove;
    /** @type {?} */
    Restangular.prototype.head;
    /** @type {?} */
    Restangular.prototype.trace;
    /** @type {?} */
    Restangular.prototype.options;
    /** @type {?} */
    Restangular.prototype.patch;
    /** @type {?} */
    Restangular.prototype.getRestangularUrl;
    /** @type {?} */
    Restangular.prototype.getRequestedUrl;
    /** @type {?} */
    Restangular.prototype.putElement;
    /** @type {?} */
    Restangular.prototype.addRestangularMethod;
    /** @type {?} */
    Restangular.prototype.getParentList;
    /** @type {?} */
    Restangular.prototype.clone;
    /** @type {?} */
    Restangular.prototype.ids;
    /** @type {?} */
    Restangular.prototype.httpConfig;
    /** @type {?} */
    Restangular.prototype.reqParams;
    /** @type {?} */
    Restangular.prototype.one;
    /** @type {?} */
    Restangular.prototype.all;
    /** @type {?} */
    Restangular.prototype.several;
    /** @type {?} */
    Restangular.prototype.oneUrl;
    /** @type {?} */
    Restangular.prototype.allUrl;
    /** @type {?} */
    Restangular.prototype.customPUT;
    /** @type {?} */
    Restangular.prototype.customPATCH;
    /** @type {?} */
    Restangular.prototype.customPOST;
    /** @type {?} */
    Restangular.prototype.customDELETE;
    /** @type {?} */
    Restangular.prototype.customGET;
    /** @type {?} */
    Restangular.prototype.customGETLIST;
    /** @type {?} */
    Restangular.prototype.customOperation;
    /** @type {?} */
    Restangular.prototype.doPUT;
    /** @type {?} */
    Restangular.prototype.doPATCH;
    /** @type {?} */
    Restangular.prototype.doPOST;
    /** @type {?} */
    Restangular.prototype.doDELETE;
    /** @type {?} */
    Restangular.prototype.doGET;
    /** @type {?} */
    Restangular.prototype.doGETLIST;
    /** @type {?} */
    Restangular.prototype.fromServer;
    /** @type {?} */
    Restangular.prototype.withConfig;
    /** @type {?} */
    Restangular.prototype.withHttpConfig;
    /** @type {?} */
    Restangular.prototype.singleOne;
    /** @type {?} */
    Restangular.prototype.plain;
    /** @type {?} */
    Restangular.prototype.save;
    /** @type {?} */
    Restangular.prototype.restangularized;
    /** @type {?} */
    Restangular.prototype.restangularizeElement;
    /** @type {?} */
    Restangular.prototype.restangularizeCollection;
    /** @type {?} */
    Restangular.prototype.configObj;
    /**
     * @type {?}
     * @private
     */
    Restangular.prototype.injector;
    /**
     * @type {?}
     * @private
     */
    Restangular.prototype.http;
}
/**
 * @param {?} $http
 * @return {?}
 */
function providerConfig($http) {
    /** @type {?} */
    const globalConfiguration = {};
    RestangularConfigurer(this, globalConfiguration);
    this.$get = $get;
    /**
     * @return {?}
     */
    function $get() {
        /**
         * @param {?} config
         * @return {?}
         */
        function createServiceForConfiguration(config) {
            /** @type {?} */
            const service = {};
            /** @type {?} */
            const urlHandler = new config.urlCreatorFactory[config.urlCreator]();
            urlHandler.setConfig(config);
            /**
             * @param {?} parent
             * @param {?} elem
             * @param {?} route
             * @param {?} reqParams
             * @param {?} fromServer
             * @return {?}
             */
            function restangularizeBase(parent, elem, route, reqParams, fromServer) {
                elem[config.restangularFields.route] = route;
                elem[config.restangularFields.getRestangularUrl] = bind(urlHandler.fetchUrl, urlHandler, elem);
                elem[config.restangularFields.getRequestedUrl] = bind(urlHandler.fetchRequestedUrl, urlHandler, elem);
                elem[config.restangularFields.addRestangularMethod] = bind(addRestangularMethodFunction, elem);
                elem[config.restangularFields.clone] = bind(copyRestangularizedElement, elem);
                elem[config.restangularFields.reqParams] = isEmpty(reqParams) ? null : reqParams;
                elem[config.restangularFields.withHttpConfig] = bind(withHttpConfig, elem);
                elem[config.restangularFields.plain] = bind(stripRestangular, elem, elem);
                // Tag element as restangularized
                elem[config.restangularFields.restangularized] = true;
                // RequestLess connection
                elem[config.restangularFields.one] = bind(one, elem, elem);
                elem[config.restangularFields.all] = bind(all, elem, elem);
                elem[config.restangularFields.several] = bind(several, elem, elem);
                elem[config.restangularFields.oneUrl] = bind(oneUrl, elem, elem);
                elem[config.restangularFields.allUrl] = bind(allUrl, elem, elem);
                elem[config.restangularFields.fromServer] = !!fromServer;
                if (parent && config.shouldSaveParent(route)) {
                    /** @type {?} */
                    const parentId = config.getIdFromElem(parent);
                    /** @type {?} */
                    const parentUrl = config.getUrlFromElem(parent);
                    /** @type {?} */
                    const restangularFieldsForParent = union(values(pick(config.restangularFields, ['route', 'singleOne', 'parentResource'])), config.extraFields);
                    /** @type {?} */
                    const parentResource = pick(parent, restangularFieldsForParent);
                    if (config.isValidId(parentId)) {
                        config.setIdToElem(parentResource, parentId, route);
                    }
                    if (config.isValidId(parentUrl)) {
                        config.setUrlToElem(parentResource, parentUrl, route);
                    }
                    elem[config.restangularFields.parentResource] = parentResource;
                }
                else {
                    elem[config.restangularFields.parentResource] = null;
                }
                return elem;
            }
            /**
             * @param {?} parent
             * @param {?} route
             * @param {?} id
             * @param {?} singleOne
             * @return {?}
             */
            function one(parent, route, id, singleOne) {
                /** @type {?} */
                let error;
                if (isNumber(route) || isNumber(parent)) {
                    error = 'You\'re creating a Restangular entity with the number ';
                    error += 'instead of the route or the parent. For example, you can\'t call .one(12).';
                    throw new Error(error);
                }
                if (isUndefined(route)) {
                    error = 'You\'re creating a Restangular entity either without the path. ';
                    error += 'For example you can\'t call .one(). Please check if your arguments are valid.';
                    throw new Error(error);
                }
                /** @type {?} */
                const elem = {};
                config.setIdToElem(elem, id, route);
                config.setFieldToElem(config.restangularFields.singleOne, elem, singleOne);
                return restangularizeElem(parent, elem, route, false);
            }
            /**
             * @param {?} parent
             * @param {?} route
             * @return {?}
             */
            function all(parent, route) {
                return restangularizeCollection(parent, [], route, false);
            }
            /**
             * @param {?} parent
             * @param {?} route
             * @return {?}
             */
            function several(parent, route /*, ids */) {
                /** @type {?} */
                const collection = [];
                collection[config.restangularFields.ids] = Array.prototype.splice.call(arguments, 2);
                return restangularizeCollection(parent, collection, route, false);
            }
            /**
             * @param {?} parent
             * @param {?} route
             * @param {?} url
             * @return {?}
             */
            function oneUrl(parent, route, url) {
                if (!route) {
                    throw new Error('Route is mandatory when creating new Restangular objects.');
                }
                /** @type {?} */
                const elem = {};
                config.setUrlToElem(elem, url, route);
                return restangularizeElem(parent, elem, route, false);
            }
            /**
             * @param {?} parent
             * @param {?} route
             * @param {?} url
             * @return {?}
             */
            function allUrl(parent, route, url) {
                if (!route) {
                    throw new Error('Route is mandatory when creating new Restangular objects.');
                }
                /** @type {?} */
                const elem = {};
                config.setUrlToElem(elem, url, route);
                return restangularizeCollection(parent, elem, route, false);
            }
            // Promises
            /**
             * @param {?} subject
             * @param {?} isCollection
             * @param {?} valueToFill
             * @return {?}
             */
            function restangularizeResponse(subject, isCollection, valueToFill) {
                return subject.pipe(filter((/**
                 * @param {?} res
                 * @return {?}
                 */
                res => !!res)));
            }
            /**
             * @param {?} subject
             * @param {?} response
             * @param {?} data
             * @param {?} filledValue
             * @return {?}
             */
            function resolvePromise(subject, response, data, filledValue) {
                extend(filledValue, data);
                // Trigger the full response interceptor.
                if (config.fullResponse) {
                    subject.next(extend(response, {
                        data: data
                    }));
                }
                else {
                    subject.next(data);
                }
                subject.complete();
            }
            // Elements
            /**
             * @param {?} elem
             * @return {?}
             */
            function stripRestangular(elem) {
                if (isArray(elem)) {
                    /** @type {?} */
                    const array = [];
                    each(elem, (/**
                     * @param {?} value
                     * @return {?}
                     */
                    function (value) {
                        array.push(config.isRestangularized(value) ? stripRestangular(value) : value);
                    }));
                    return array;
                }
                else {
                    return omit(elem, values(omit(config.restangularFields, 'id')));
                }
            }
            /**
             * @param {?} elem
             * @return {?}
             */
            function addCustomOperation(elem) {
                elem[config.restangularFields.customOperation] = bind(customFunction, elem);
                /** @type {?} */
                const requestMethods = { get: customFunction, delete: customFunction };
                each(['put', 'patch', 'post'], (/**
                 * @param {?} name
                 * @return {?}
                 */
                function (name) {
                    requestMethods[name] = (/**
                     * @param {?} operation
                     * @param {?} element
                     * @param {?} path
                     * @param {?} params
                     * @param {?} headers
                     * @return {?}
                     */
                    function (operation, element, path, params, headers) {
                        return bind(customFunction, this)(operation, path, params, headers, element);
                    });
                }));
                each(requestMethods, (/**
                 * @param {?} requestFunc
                 * @param {?} name
                 * @return {?}
                 */
                function (requestFunc, name) {
                    /** @type {?} */
                    const callOperation = name === 'delete' ? 'remove' : name;
                    each(['do', 'custom'], (/**
                     * @param {?} alias
                     * @return {?}
                     */
                    function (alias) {
                        elem[alias + name.toUpperCase()] = bind(requestFunc, elem, callOperation);
                    }));
                }));
                elem[config.restangularFields.customGETLIST] = bind(fetchFunction, elem);
                elem[config.restangularFields.doGETLIST] = elem[config.restangularFields.customGETLIST];
            }
            /**
             * @param {?} fromElement
             * @param {?=} toElement
             * @return {?}
             */
            function copyRestangularizedElement(fromElement, toElement = {}) {
                /** @type {?} */
                const copiedElement = assign(toElement, fromElement);
                return restangularizeElem(copiedElement[config.restangularFields.parentResource], copiedElement, copiedElement[config.restangularFields.route], true);
            }
            /**
             * @param {?} parent
             * @param {?} element
             * @param {?} route
             * @param {?=} fromServer
             * @param {?=} collection
             * @param {?=} reqParams
             * @return {?}
             */
            function restangularizeElem(parent, element, route, fromServer, collection, reqParams) {
                /** @type {?} */
                const elem = config.onBeforeElemRestangularized(element, false, route);
                /** @type {?} */
                const localElem = restangularizeBase(parent, elem, route, reqParams, fromServer);
                if (config.useCannonicalId) {
                    localElem[config.restangularFields.cannonicalId] = config.getIdFromElem(localElem);
                }
                if (collection) {
                    localElem[config.restangularFields.getParentList] = (/**
                     * @return {?}
                     */
                    function () {
                        return collection;
                    });
                }
                localElem[config.restangularFields.restangularCollection] = false;
                localElem[config.restangularFields.get] = bind(getFunction, localElem);
                localElem[config.restangularFields.getList] = bind(fetchFunction, localElem);
                localElem[config.restangularFields.put] = bind(putFunction, localElem);
                localElem[config.restangularFields.post] = bind(postFunction, localElem);
                localElem[config.restangularFields.remove] = bind(deleteFunction, localElem);
                localElem[config.restangularFields.head] = bind(headFunction, localElem);
                localElem[config.restangularFields.trace] = bind(traceFunction, localElem);
                localElem[config.restangularFields.options] = bind(optionsFunction, localElem);
                localElem[config.restangularFields.patch] = bind(patchFunction, localElem);
                localElem[config.restangularFields.save] = bind(save, localElem);
                addCustomOperation(localElem);
                return config.transformElem(localElem, false, route, service, true);
            }
            /**
             * @param {?} parent
             * @param {?} element
             * @param {?} route
             * @param {?=} fromServer
             * @param {?=} reqParams
             * @return {?}
             */
            function restangularizeCollection(parent, element, route, fromServer, reqParams) {
                /** @type {?} */
                const elem = config.onBeforeElemRestangularized(element, true, route);
                /** @type {?} */
                const localElem = restangularizeBase(parent, elem, route, reqParams, fromServer);
                localElem[config.restangularFields.restangularCollection] = true;
                localElem[config.restangularFields.post] = bind(postFunction, localElem, null);
                localElem[config.restangularFields.remove] = bind(deleteFunction, localElem);
                localElem[config.restangularFields.head] = bind(headFunction, localElem);
                localElem[config.restangularFields.trace] = bind(traceFunction, localElem);
                localElem[config.restangularFields.putElement] = bind(putElementFunction, localElem);
                localElem[config.restangularFields.options] = bind(optionsFunction, localElem);
                localElem[config.restangularFields.patch] = bind(patchFunction, localElem);
                localElem[config.restangularFields.get] = bind(getById, localElem);
                localElem[config.restangularFields.getList] = bind(fetchFunction, localElem, null);
                addCustomOperation(localElem);
                return config.transformElem(localElem, true, route, service, true);
            }
            /**
             * @param {?} parent
             * @param {?} element
             * @param {?} route
             * @return {?}
             */
            function restangularizeCollectionAndElements(parent, element, route) {
                /** @type {?} */
                const collection = restangularizeCollection(parent, element, route, false);
                each(collection, (/**
                 * @param {?} elem
                 * @return {?}
                 */
                function (elem) {
                    if (elem) {
                        restangularizeElem(parent, elem, route, false);
                    }
                }));
                return collection;
            }
            /**
             * @param {?} id
             * @param {?} reqParams
             * @param {?} headers
             * @return {?}
             */
            function getById(id, reqParams, headers) {
                return this.customGET(id.toString(), reqParams, headers);
            }
            /**
             * @param {?} idx
             * @param {?} params
             * @param {?} headers
             * @return {?}
             */
            function putElementFunction(idx, params, headers) {
                /** @type {?} */
                const __this = this;
                /** @type {?} */
                const elemToPut = this[idx];
                /** @type {?} */
                const subject = new BehaviorSubject(null);
                /** @type {?} */
                let filledArray = [];
                filledArray = config.transformElem(filledArray, true, elemToPut[config.restangularFields.route], service);
                elemToPut.put(params, headers)
                    .subscribe((/**
                 * @param {?} serverElem
                 * @return {?}
                 */
                function (serverElem) {
                    /** @type {?} */
                    const newArray = copyRestangularizedElement(__this);
                    newArray[idx] = serverElem;
                    filledArray = newArray;
                    subject.next(newArray);
                }), (/**
                 * @param {?} response
                 * @return {?}
                 */
                function (response) {
                    subject.error(response);
                }), (/**
                 * @return {?}
                 */
                function () {
                    subject.complete();
                }));
                return restangularizeResponse(subject, true, filledArray);
            }
            /**
             * @param {?} resData
             * @param {?} operation
             * @param {?} route
             * @param {?} fetchUrl
             * @param {?} response
             * @param {?} subject
             * @return {?}
             */
            function parseResponse(resData, operation, route, fetchUrl, response, subject) {
                /** @type {?} */
                const data = config.responseExtractor(resData, operation, route, fetchUrl, response, subject);
                /** @type {?} */
                const etag = response.headers.get('ETag');
                if (data && etag) {
                    data[config.restangularFields.etag] = etag;
                }
                return data;
            }
            /**
             * @param {?} what
             * @param {?} reqParams
             * @param {?} headers
             * @return {?}
             */
            function fetchFunction(what, reqParams, headers) {
                /** @type {?} */
                const __this = this;
                /** @type {?} */
                const subject = new BehaviorSubject(null);
                /** @type {?} */
                const operation = 'getList';
                /** @type {?} */
                const url = urlHandler.fetchUrl(this, what);
                /** @type {?} */
                const whatFetched = what || __this[config.restangularFields.route];
                /** @type {?} */
                const request = config.fullRequestInterceptor(null, operation, whatFetched, url, headers || {}, reqParams || {}, this[config.restangularFields.httpConfig] || {});
                /** @type {?} */
                let filledArray = [];
                filledArray = config.transformElem(filledArray, true, whatFetched, service);
                /** @type {?} */
                let method = 'getList';
                if (config.jsonp) {
                    method = 'jsonp';
                }
                /** @type {?} */
                const okCallback = (/**
                 * @param {?} response
                 * @return {?}
                 */
                function (response) {
                    /** @type {?} */
                    const resData = response.body;
                    /** @type {?} */
                    const fullParams = response.config.params;
                    /** @type {?} */
                    let data = parseResponse(resData, operation, whatFetched, url, response, subject);
                    // support empty response for getList() calls (some APIs respond with 204 and empty body)
                    if (isUndefined(data) || '' === data) {
                        data = [];
                    }
                    if (!isArray(data)) {
                        throw new Error('Response for getList SHOULD be an array and not an object or something else');
                    }
                    if (true === config.plainByDefault) {
                        return resolvePromise(subject, response, data, filledArray);
                    }
                    /** @type {?} */
                    let processedData = map(data, (/**
                     * @param {?} elem
                     * @return {?}
                     */
                    function (elem) {
                        if (!__this[config.restangularFields.restangularCollection]) {
                            return restangularizeElem(__this, elem, what, true, data);
                        }
                        else {
                            return restangularizeElem(__this[config.restangularFields.parentResource], elem, __this[config.restangularFields.route], true, data);
                        }
                    }));
                    processedData = extend(data, processedData);
                    if (!__this[config.restangularFields.restangularCollection]) {
                        resolvePromise(subject, response, restangularizeCollection(__this, processedData, what, true, fullParams), filledArray);
                    }
                    else {
                        resolvePromise(subject, response, restangularizeCollection(__this[config.restangularFields.parentResource], processedData, __this[config.restangularFields.route], true, fullParams), filledArray);
                    }
                });
                urlHandler.resource(this, $http, request.httpConfig, request.headers, request.params, what, this[config.restangularFields.etag], operation)[method]()
                    .subscribe(okCallback, (/**
                 * @param {?} response
                 * @return {?}
                 */
                function error(response) {
                    if (response.status === 304 && __this[config.restangularFields.restangularCollection]) {
                        resolvePromise(subject, response, __this, filledArray);
                    }
                    else if (every(config.errorInterceptors, (/**
                     * @param {?} cb
                     * @return {?}
                     */
                    function (cb) {
                        return cb(response, subject, okCallback) !== false;
                    }))) {
                        // triggered if no callback returns false
                        subject.error(response);
                    }
                }));
                return restangularizeResponse(subject, true, filledArray);
            }
            /**
             * @param {?} httpConfig
             * @return {?}
             */
            function withHttpConfig(httpConfig) {
                this[config.restangularFields.httpConfig] = httpConfig;
                return this;
            }
            /**
             * @param {?} params
             * @param {?} headers
             * @return {?}
             */
            function save(params, headers) {
                if (this[config.restangularFields.fromServer]) {
                    return this[config.restangularFields.put](params, headers);
                }
                else {
                    return bind(elemFunction, this)('post', undefined, params, undefined, headers);
                }
            }
            /**
             * @param {?} operation
             * @param {?} what
             * @param {?} params
             * @param {?} obj
             * @param {?} headers
             * @return {?}
             */
            function elemFunction(operation, what, params, obj, headers) {
                /** @type {?} */
                const __this = this;
                /** @type {?} */
                const subject = new BehaviorSubject(null);
                /** @type {?} */
                const resParams = params || {};
                /** @type {?} */
                const route = what || this[config.restangularFields.route];
                /** @type {?} */
                const fetchUrl = urlHandler.fetchUrl(this, what);
                /** @type {?} */
                let callObj = obj || this;
                // fallback to etag on restangular object (since for custom methods we probably don't explicitly specify the etag field)
                /** @type {?} */
                const etag = callObj[config.restangularFields.etag] || (operation !== 'post' ? this[config.restangularFields.etag] : null);
                if (isObject(callObj) && config.isRestangularized(callObj)) {
                    callObj = stripRestangular(callObj);
                }
                /** @type {?} */
                const request = config.fullRequestInterceptor(callObj, operation, route, fetchUrl, headers || {}, resParams || {}, this[config.restangularFields.httpConfig] || {});
                /** @type {?} */
                let filledObject = {};
                filledObject = config.transformElem(filledObject, false, route, service);
                /** @type {?} */
                const okCallback = (/**
                 * @param {?} response
                 * @return {?}
                 */
                function (response) {
                    /** @type {?} */
                    const resData = get(response, 'body');
                    /** @type {?} */
                    const fullParams = get(response, 'config.params');
                    /** @type {?} */
                    const elem = parseResponse(resData, operation, route, fetchUrl, response, subject);
                    if (elem) {
                        /** @type {?} */
                        let data;
                        if (true === config.plainByDefault) {
                            return resolvePromise(subject, response, elem, filledObject);
                        }
                        if (operation === 'post' && !__this[config.restangularFields.restangularCollection]) {
                            data = restangularizeElem(__this[config.restangularFields.parentResource], elem, route, true, null, fullParams);
                            resolvePromise(subject, response, data, filledObject);
                        }
                        else {
                            data = restangularizeElem(__this[config.restangularFields.parentResource], elem, __this[config.restangularFields.route], true, null, fullParams);
                            data[config.restangularFields.singleOne] = __this[config.restangularFields.singleOne];
                            resolvePromise(subject, response, data, filledObject);
                        }
                    }
                    else {
                        resolvePromise(subject, response, undefined, filledObject);
                    }
                });
                /** @type {?} */
                const errorCallback = (/**
                 * @param {?} response
                 * @return {?}
                 */
                function (response) {
                    if (response.status === 304 && config.isSafe(operation)) {
                        resolvePromise(subject, response, __this, filledObject);
                    }
                    else if (every(config.errorInterceptors, (/**
                     * @param {?} cb
                     * @return {?}
                     */
                    function (cb) {
                        return cb(response, subject, okCallback) !== false;
                    }))) {
                        // triggered if no callback returns false
                        subject.error(response);
                    }
                });
                // Overriding HTTP Method
                /** @type {?} */
                let callOperation = operation;
                /** @type {?} */
                let callHeaders = extend({}, request.headers);
                /** @type {?} */
                const isOverrideOperation = config.isOverridenMethod(operation);
                if (isOverrideOperation) {
                    callOperation = 'post';
                    callHeaders = extend(callHeaders, { 'X-HTTP-Method-Override': operation === 'remove' ? 'DELETE' : operation.toUpperCase() });
                }
                else if (config.jsonp && callOperation === 'get') {
                    callOperation = 'jsonp';
                }
                if (config.isSafe(operation)) {
                    if (isOverrideOperation) {
                        urlHandler.resource(this, $http, request.httpConfig, callHeaders, request.params, what, etag, callOperation)[callOperation]({}).subscribe(okCallback, errorCallback);
                    }
                    else {
                        urlHandler.resource(this, $http, request.httpConfig, callHeaders, request.params, what, etag, callOperation)[callOperation]().subscribe(okCallback, errorCallback);
                    }
                }
                else {
                    urlHandler.resource(this, $http, request.httpConfig, callHeaders, request.params, what, etag, callOperation)[callOperation](request.element).subscribe(okCallback, errorCallback);
                }
                return restangularizeResponse(subject, false, filledObject);
            }
            /**
             * @param {?} params
             * @param {?} headers
             * @return {?}
             */
            function getFunction(params, headers) {
                return bind(elemFunction, this)('get', undefined, params, undefined, headers);
            }
            /**
             * @param {?} params
             * @param {?} headers
             * @return {?}
             */
            function deleteFunction(params, headers) {
                return bind(elemFunction, this)('remove', undefined, params, undefined, headers);
            }
            /**
             * @param {?} params
             * @param {?} headers
             * @return {?}
             */
            function putFunction(params, headers) {
                return bind(elemFunction, this)('put', undefined, params, undefined, headers);
            }
            /**
             * @param {?} what
             * @param {?} elem
             * @param {?} params
             * @param {?} headers
             * @return {?}
             */
            function postFunction(what, elem, params, headers) {
                return bind(elemFunction, this)('post', what, params, elem, headers);
            }
            /**
             * @param {?} params
             * @param {?} headers
             * @return {?}
             */
            function headFunction(params, headers) {
                return bind(elemFunction, this)('head', undefined, params, undefined, headers);
            }
            /**
             * @param {?} params
             * @param {?} headers
             * @return {?}
             */
            function traceFunction(params, headers) {
                return bind(elemFunction, this)('trace', undefined, params, undefined, headers);
            }
            /**
             * @param {?} params
             * @param {?} headers
             * @return {?}
             */
            function optionsFunction(params, headers) {
                return bind(elemFunction, this)('options', undefined, params, undefined, headers);
            }
            /**
             * @param {?} elem
             * @param {?} params
             * @param {?} headers
             * @return {?}
             */
            function patchFunction(elem, params, headers) {
                return bind(elemFunction, this)('patch', undefined, params, elem, headers);
            }
            /**
             * @param {?} operation
             * @param {?} path
             * @param {?} params
             * @param {?} headers
             * @param {?} elem
             * @return {?}
             */
            function customFunction(operation, path, params, headers, elem) {
                return bind(elemFunction, this)(operation, path, params, elem, headers);
            }
            /**
             * @param {?} name
             * @param {?} operation
             * @param {?} path
             * @param {?} defaultParams
             * @param {?} defaultHeaders
             * @param {?} defaultElem
             * @return {?}
             */
            function addRestangularMethodFunction(name, operation, path, defaultParams, defaultHeaders, defaultElem) {
                /** @type {?} */
                let bindedFunction;
                if (operation === 'getList') {
                    bindedFunction = bind(fetchFunction, this, path);
                }
                else {
                    bindedFunction = bind(customFunction, this, operation, path);
                }
                /** @type {?} */
                const createdFunction = (/**
                 * @param {?} params
                 * @param {?} headers
                 * @param {?} elem
                 * @return {?}
                 */
                function (params, headers, elem) {
                    /** @type {?} */
                    const callParams = defaults({
                        params: params,
                        headers: headers,
                        elem: elem
                    }, {
                        params: defaultParams,
                        headers: defaultHeaders,
                        elem: defaultElem
                    });
                    return bindedFunction(callParams.params, callParams.headers, callParams.elem);
                });
                if (config.isSafe(operation)) {
                    this[name] = createdFunction;
                }
                else {
                    this[name] = (/**
                     * @param {?} elem
                     * @param {?} params
                     * @param {?} headers
                     * @return {?}
                     */
                    function (elem, params, headers) {
                        return createdFunction(params, headers, elem);
                    });
                }
            }
            /**
             * @param {?} configurer
             * @return {?}
             */
            function withConfigurationFunction(configurer) {
                /** @type {?} */
                const newConfig = clone(omit(config, 'configuration'));
                RestangularConfigurer(newConfig, newConfig);
                configurer(newConfig);
                return createServiceForConfiguration(newConfig);
            }
            /**
             * @param {?} route
             * @param {?} parent
             * @return {?}
             */
            function toService(route, parent) {
                /** @type {?} */
                const knownCollectionMethods = values(config.restangularFields);
                /** @type {?} */
                const serv = {};
                /** @type {?} */
                const collection = (parent || service).all(route);
                serv.one = bind(one, (parent || service), parent, route);
                serv.all = bind(collection.all, collection);
                serv.post = bind(collection.post, collection);
                serv.getList = bind(collection.getList, collection);
                serv.withHttpConfig = bind(collection.withHttpConfig, collection);
                serv.get = bind(collection.get, collection);
                for (const prop in collection) {
                    if (collection.hasOwnProperty(prop) && isFunction(collection[prop]) && !includes(knownCollectionMethods, prop)) {
                        serv[prop] = bind(collection[prop], collection);
                    }
                }
                return serv;
            }
            RestangularConfigurer(service, config);
            service.copy = bind(copyRestangularizedElement, service);
            service.service = bind(toService, service);
            service.withConfig = bind(withConfigurationFunction, service);
            service.one = bind(one, service, null);
            service.all = bind(all, service, null);
            service.several = bind(several, service, null);
            service.oneUrl = bind(oneUrl, service, null);
            service.allUrl = bind(allUrl, service, null);
            service.stripRestangular = bind(stripRestangular, service);
            service.restangularizeElement = bind(restangularizeElem, service);
            service.restangularizeCollection = bind(restangularizeCollectionAndElements, service);
            return service;
        }
        return createServiceForConfiguration(globalConfiguration);
    }
}

//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibmd4LXJlc3Rhbmd1bGFyLmpzIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi9wcm9qZWN0cy9uZ3gtcmVzdGFuZ3VsYXIvc3JjL2xpYi9uZ3gtcmVzdGFuZ3VsYXIudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7QUFBQSxPQUFPLEVBQUUsVUFBVSxFQUFFLE1BQU0sRUFBRSxRQUFRLEVBQUUsUUFBUSxFQUFRLE1BQU0sZUFBZSxDQUFDO0FBQzdFLE9BQU8sRUFBRSxNQUFNLEVBQUUsTUFBTSx5QkFBeUIsQ0FBQztBQUNqRCxPQUFPLEVBQ0wsR0FBRyxFQUNILElBQUksRUFDSixLQUFLLEVBQ0wsTUFBTSxFQUNOLElBQUksRUFDSixPQUFPLEVBQ1AsVUFBVSxFQUNWLFFBQVEsRUFDUixXQUFXLEVBQ1gsT0FBTyxFQUNQLFFBQVEsRUFDUixNQUFNLEVBQ04sSUFBSSxFQUNKLEtBQUssRUFDTCxJQUFJLEVBQ0osR0FBRyxFQUNILFFBQVEsRUFDUixLQUFLLEVBQ0wsUUFBUSxFQUNULE1BQU0sUUFBUSxDQUFDO0FBRWhCLE9BQU8sRUFBRSxlQUFlLEVBQUUsTUFBTSxNQUFNLENBQUM7QUFDdkMsT0FBTyxFQUFFLE1BQU0sRUFBRSxNQUFNLGdCQUFnQixDQUFDO0FBRXhDLE9BQU8sRUFBRSxXQUFXLEVBQUUsTUFBTSwwQkFBMEIsQ0FBQztBQUN2RCxPQUFPLEVBQUUsZUFBZSxFQUFFLE1BQU0sd0JBQXdCLENBQUM7QUFDekQsT0FBTyxFQUFFLHFCQUFxQixFQUFFLE1BQU0sa0NBQWtDLENBQUM7O0FBR3pFLE1BQU0sT0FBTyxXQUFXO0FBQ3hCO0FBQVE7QUFFUDtBQUNEO0FBQXVCO0FBQ2hCLElBK0ZMLFlBQzBDLFNBQVMsRUFDekMsUUFBa0IsRUFDbEIsSUFBcUI7QUFDOUIsUUFIeUMsY0FBUyxHQUFULFNBQVMsQ0FBQTtBQUFDLFFBQzFDLGFBQVEsR0FBUixRQUFRLENBQVU7QUFBQyxRQUNuQixTQUFJLEdBQUosSUFBSSxDQUFpQjtBQUNqQyxRQUNJLElBQUksQ0FBQyxRQUFRLEdBQUcsSUFBSSxjQUFjLENBQUMsSUFBSSxDQUFDLENBQUM7QUFDN0M7QUFBeUIsY0FBZixPQUFPLEdBQUcsSUFBSSxDQUFDLFFBQVEsQ0FBQyxJQUFJLEVBQUU7QUFDeEMsUUFBSSxNQUFNLENBQUMsSUFBSSxFQUFFLE9BQU8sQ0FBQyxDQUFDO0FBQzFCLFFBQ0ksSUFBSSxDQUFDLGdCQUFnQixFQUFFLENBQUM7QUFDNUIsSUFBRSxDQUFDO0FBQ0g7QUFDTztBQUNKO0FBQVEsSUFEVCxnQkFBZ0I7QUFDbEIsUUFBSSxJQUFJLENBQUMsSUFBSSxDQUFDLFNBQVMsSUFBSSxDQUFDLFVBQVUsQ0FBQyxJQUFJLENBQUMsU0FBUyxDQUFDLEVBQUUsQ0FBQyxFQUFFO0FBQzNELFlBQU0sT0FBTztBQUNiLFNBQUs7QUFDTDtBQUN3QixjQUFkLEtBQUssR0FBRyxHQUFHLENBQUMsSUFBSSxDQUFDLFNBQVMsQ0FBQyxXQUFXO0FBQU87QUFDOUM7QUFBdUI7QUFDOUIsUUFGZ0QsQ0FBQyxRQUFtQixFQUFFLEVBQUU7QUFDMUUsWUFBTSxPQUFPLElBQUksQ0FBQyxRQUFRLENBQUMsR0FBRyxDQUFDLFFBQVEsQ0FBQyxDQUFDO0FBQ3pDLFFBQUksQ0FBQyxFQUFDO0FBQ04sUUFDSSxJQUFJLENBQUMsU0FBUyxDQUFDLEVBQUUsQ0FBQyxHQUFHLENBQUMsSUFBSSxDQUFDLFFBQVEsRUFBRSxHQUFHLEtBQUssQ0FBQyxDQUFDLENBQUM7QUFDcEQsSUFBRSxDQUFDO0FBQ0g7dUNBNUhDLFVBQVU7aUdBQ1Q7QUFBQztBQUFtQjtBQUVKLDRDQW1HYixRQUFRLFlBQUksTUFBTSxTQUFDLFdBQVc7QUFBUyxZQXJJZixRQUFRO0FBQUksWUE0QmhDLGVBQWU7QUFBRzs7Ozs7Ozs7d0ZBQUU7QUFBQztBQUFhO0FBQ3JDLElBSUosK0JBdUNFO0FBQ0o7QUFBcUIsSUFBbkIsNENBQTJCO0FBQzdCO0FBQXFCLElBQW5CLHVDQUFzQjtBQUN4QjtBQUNDLElBREMsa0NBQWlCO0FBQ25CO0FBQ2EsSUFEWCwyQkFBSztBQUNQO0FBQ0ksSUFERixvQ0FBYztBQUNoQjtBQUVJLElBRkYsOEJBQVE7QUFDVjtBQUVNLElBRkoseUJBQUc7QUFDTDtBQUNZLElBRFYsNEJBQU07QUFDUjtBQUNHLElBREQscUNBQWU7QUFDakI7QUFBcUIsSUFBbkIsNENBQXNCO0FBQ3hCO0FBQ0ssSUFESCxtQ0FBYTtBQUNmO0FBRUMsSUFGQywyQkFBSztBQUNQO0FBRUUsSUFGQSwrQkFBUztBQUNYO0FBRUcsSUFGRCwwQkFBSTtBQUNOO0FBRUcsSUFGRCw4QkFBUTtBQUNWO0FBRU0sSUFGSiwwQkFBSTtBQUNOO0FBRUcsSUFGRCwyQkFBSztBQUNQO0FBRUcsSUFGRCw2QkFBTztBQUNUO0FBRUksSUFGRiwyQkFBSztBQUNQO0FBRUMsSUFGQyw0QkFBTTtBQUNSO0FBRUMsSUFGQyw4QkFBUTtBQUNWO0FBQ1ksSUFEViw0QkFBTTtBQUNSO0FBQ0EsSUFERSx3Q0FBa0I7QUFDcEI7QUFDRSxJQURBLHNDQUFnQjtBQUNsQjtBQUNPLElBREwsaUNBQVc7QUFDYjtBQUFxQixJQUFuQiwyQ0FBcUI7QUFDdkI7QUFDSSxJQURGLG9DQUFjO0FBQ2hCO0FBRUssSUFGSCw0QkFBTTtBQUNSO0FBRUEsSUFGRSwwQkFBSTtBQUNOO0FBQ08sSUFETCxpQ0FBVztBQUNiO0FBRUMsSUFGQyxnQ0FBVTtBQUNaO0FBRU8sSUFGTCwwQkFBSTtBQUNOO0FBRUcsSUFGRCwwQkFBSTtBQUNOO0FBRUEsSUFGRSw4QkFBUTtBQUNWO0FBRUMsSUFGQyw2QkFBTztBQUNUO0FBQ1csSUFEVCw2QkFBTztBQUNUO0FBQ1EsSUFETixnQ0FBVTtBQUNaO0FBQ00sSUFESixrQ0FBWTtBQUNkO0FBQ08sSUFETCxpQ0FBVztBQUNiO0FBQ0ssSUFESCxtQ0FBYTtBQUNmO0FBQ1EsSUFETixnQ0FBVTtBQUNaO0FBQ0ksSUFERixvQ0FBYztBQUNoQjtBQUNFLElBREEsc0NBQWdCO0FBQ2xCO0FBRUMsSUFGQyw0QkFBTTtBQUNSO0FBRUEsSUFGRSw4QkFBUTtBQUNWO0FBQ1csSUFEVCw2QkFBTztBQUNUO0FBRUEsSUFGRSwrQkFBUztBQUNYO0FBQ1ksSUFEViw0QkFBTTtBQUNSO0FBQ1EsSUFETixnQ0FBVTtBQUNaO0FBQ08sSUFETCxpQ0FBVztBQUNiO0FBQ08sSUFETCxpQ0FBVztBQUNiO0FBQ0csSUFERCxxQ0FBZTtBQUNqQjtBQUNRLElBRE4sZ0NBQVU7QUFDWjtBQUVJLElBRkYsNEJBQU07QUFDUjtBQUNhLElBRFgsMkJBQUs7QUFDUDtBQUNFLElBREEsc0NBQWdCO0FBQ2xCO0FBQXFCLElBQW5CLDRDQUFzQjtBQUN4QjtBQUFxQixJQUFuQiwrQ0FBeUI7QUFDM0I7QUFFSyxJQUFELGdDQUFpRDtBQUFDO0FBQy9DO0FBQWlCO0FBQ2hCO0FBQVEsSUFEWiwrQkFBMEI7QUFBQztBQUN4QjtBQUFpQjtBQUV4QjtBQUFRLElBRkosMkJBQTZCO0FBQ2pDO0FBQUU7QUFDRjtBQUFvQjtBQUFlO0FBb0JuQyxTQUFTLGNBQWMsQ0FBQyxLQUFLO0FBQzdCO0FBQXFCLFVBQWIsbUJBQW1CLEdBQUcsRUFBRTtBQUNoQyxJQUNFLHFCQUFxQixDQUFDLElBQUksRUFBRSxtQkFBbUIsQ0FBQyxDQUFDO0FBQ25ELElBQ0UsSUFBSSxDQUFDLElBQUksR0FBRyxJQUFJLENBQUM7QUFDbkI7QUFDTztBQUVGO0FBQVEsSUFGWCxTQUFTLElBQUk7QUFDZjtBQUNXO0FBQTZCO0FBQzlCO0FBQVksUUFEbEIsU0FBUyw2QkFBNkIsQ0FBQyxNQUFNO0FBQ2pEO0FBQTZCLGtCQUFqQixPQUFPLEdBQVEsRUFBRTtBQUM3QjtBQUM0QixrQkFBaEIsVUFBVSxHQUFHLElBQUksTUFBTSxDQUFDLGlCQUFpQixDQUFDLE1BQU0sQ0FBQyxVQUFVLENBQUMsRUFBRTtBQUMxRSxZQUFNLFVBQVUsQ0FBQyxTQUFTLENBQUMsTUFBTSxDQUFDLENBQUM7QUFDbkM7QUFDZTtBQUFpQztBQUErQjtBQUNoRDtBQUNsQjtBQUFxQztBQUEyQjtBQUFnQixZQUZ2RixTQUFTLGtCQUFrQixDQUFDLE1BQU0sRUFBRSxJQUFJLEVBQUUsS0FBSyxFQUFFLFNBQVMsRUFBRSxVQUFVO0FBQzVFLGdCQUFRLElBQUksQ0FBQyxNQUFNLENBQUMsaUJBQWlCLENBQUMsS0FBSyxDQUFDLEdBQUcsS0FBSyxDQUFDO0FBQ3JELGdCQUFRLElBQUksQ0FBQyxNQUFNLENBQUMsaUJBQWlCLENBQUMsaUJBQWlCLENBQUMsR0FBRyxJQUFJLENBQUMsVUFBVSxDQUFDLFFBQVEsRUFBRSxVQUFVLEVBQUUsSUFBSSxDQUFDLENBQUM7QUFDdkcsZ0JBQVEsSUFBSSxDQUFDLE1BQU0sQ0FBQyxpQkFBaUIsQ0FBQyxlQUFlLENBQUMsR0FBRyxJQUFJLENBQUMsVUFBVSxDQUFDLGlCQUFpQixFQUFFLFVBQVUsRUFBRSxJQUFJLENBQUMsQ0FBQztBQUM5RyxnQkFBUSxJQUFJLENBQUMsTUFBTSxDQUFDLGlCQUFpQixDQUFDLG9CQUFvQixDQUFDLEdBQUcsSUFBSSxDQUFDLDRCQUE0QixFQUFFLElBQUksQ0FBQyxDQUFDO0FBQ3ZHLGdCQUFRLElBQUksQ0FBQyxNQUFNLENBQUMsaUJBQWlCLENBQUMsS0FBSyxDQUFDLEdBQUcsSUFBSSxDQUFDLDBCQUEwQixFQUFFLElBQUksQ0FBQyxDQUFDO0FBQ3RGLGdCQUFRLElBQUksQ0FBQyxNQUFNLENBQUMsaUJBQWlCLENBQUMsU0FBUyxDQUFDLEdBQUcsT0FBTyxDQUFDLFNBQVMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLFNBQVMsQ0FBQztBQUN6RixnQkFBUSxJQUFJLENBQUMsTUFBTSxDQUFDLGlCQUFpQixDQUFDLGNBQWMsQ0FBQyxHQUFHLElBQUksQ0FBQyxjQUFjLEVBQUUsSUFBSSxDQUFDLENBQUM7QUFDbkYsZ0JBQVEsSUFBSSxDQUFDLE1BQU0sQ0FBQyxpQkFBaUIsQ0FBQyxLQUFLLENBQUMsR0FBRyxJQUFJLENBQUMsZ0JBQWdCLEVBQUUsSUFBSSxFQUFFLElBQUksQ0FBQyxDQUFDO0FBQ2xGLGdCQUNRLGlDQUFpQztBQUN6QyxnQkFBUSxJQUFJLENBQUMsTUFBTSxDQUFDLGlCQUFpQixDQUFDLGVBQWUsQ0FBQyxHQUFHLElBQUksQ0FBQztBQUM5RCxnQkFDUSx5QkFBeUI7QUFDakMsZ0JBQVEsSUFBSSxDQUFDLE1BQU0sQ0FBQyxpQkFBaUIsQ0FBQyxHQUFHLENBQUMsR0FBRyxJQUFJLENBQUMsR0FBRyxFQUFFLElBQUksRUFBRSxJQUFJLENBQUMsQ0FBQztBQUNuRSxnQkFBUSxJQUFJLENBQUMsTUFBTSxDQUFDLGlCQUFpQixDQUFDLEdBQUcsQ0FBQyxHQUFHLElBQUksQ0FBQyxHQUFHLEVBQUUsSUFBSSxFQUFFLElBQUksQ0FBQyxDQUFDO0FBQ25FLGdCQUFRLElBQUksQ0FBQyxNQUFNLENBQUMsaUJBQWlCLENBQUMsT0FBTyxDQUFDLEdBQUcsSUFBSSxDQUFDLE9BQU8sRUFBRSxJQUFJLEVBQUUsSUFBSSxDQUFDLENBQUM7QUFDM0UsZ0JBQVEsSUFBSSxDQUFDLE1BQU0sQ0FBQyxpQkFBaUIsQ0FBQyxNQUFNLENBQUMsR0FBRyxJQUFJLENBQUMsTUFBTSxFQUFFLElBQUksRUFBRSxJQUFJLENBQUMsQ0FBQztBQUN6RSxnQkFBUSxJQUFJLENBQUMsTUFBTSxDQUFDLGlCQUFpQixDQUFDLE1BQU0sQ0FBQyxHQUFHLElBQUksQ0FBQyxNQUFNLEVBQUUsSUFBSSxFQUFFLElBQUksQ0FBQyxDQUFDO0FBQ3pFLGdCQUNRLElBQUksQ0FBQyxNQUFNLENBQUMsaUJBQWlCLENBQUMsVUFBVSxDQUFDLEdBQUcsQ0FBQyxDQUFDLFVBQVUsQ0FBQztBQUNqRSxnQkFDUSxJQUFJLE1BQU0sSUFBSSxNQUFNLENBQUMsZ0JBQWdCLENBQUMsS0FBSyxDQUFDLEVBQUU7QUFDdEQ7QUFBcUMsMEJBQXJCLFFBQVEsR0FBRyxNQUFNLENBQUMsYUFBYSxDQUFDLE1BQU0sQ0FBQztBQUN2RDtBQUFxQywwQkFBckIsU0FBUyxHQUFHLE1BQU0sQ0FBQyxjQUFjLENBQUMsTUFBTSxDQUFDO0FBQ3pEO0FBQ29DLDBCQUFwQiwwQkFBMEIsR0FBRyxLQUFLLENBQ3RDLE1BQU0sQ0FBQyxJQUFJLENBQUMsTUFBTSxDQUFDLGlCQUFpQixFQUFFLENBQUMsT0FBTyxFQUFFLFdBQVcsRUFBRSxnQkFBZ0IsQ0FBQyxDQUFDLENBQUMsRUFDaEYsTUFBTSxDQUFDLFdBQVcsQ0FDbkI7QUFDWDtBQUFxQywwQkFBckIsY0FBYyxHQUFHLElBQUksQ0FBQyxNQUFNLEVBQUUsMEJBQTBCLENBQUM7QUFDekUsb0JBQ1UsSUFBSSxNQUFNLENBQUMsU0FBUyxDQUFDLFFBQVEsQ0FBQyxFQUFFO0FBQzFDLHdCQUFZLE1BQU0sQ0FBQyxXQUFXLENBQUMsY0FBYyxFQUFFLFFBQVEsRUFBRSxLQUFLLENBQUMsQ0FBQztBQUNoRSxxQkFBVztBQUNYLG9CQUFVLElBQUksTUFBTSxDQUFDLFNBQVMsQ0FBQyxTQUFTLENBQUMsRUFBRTtBQUMzQyx3QkFBWSxNQUFNLENBQUMsWUFBWSxDQUFDLGNBQWMsRUFBRSxTQUFTLEVBQUUsS0FBSyxDQUFDLENBQUM7QUFDbEUscUJBQVc7QUFDWCxvQkFDVSxJQUFJLENBQUMsTUFBTSxDQUFDLGlCQUFpQixDQUFDLGNBQWMsQ0FBQyxHQUFHLGNBQWMsQ0FBQztBQUN6RSxpQkFBUztBQUFDLHFCQUFLO0FBQ2Ysb0JBQVUsSUFBSSxDQUFDLE1BQU0sQ0FBQyxpQkFBaUIsQ0FBQyxjQUFjLENBQUMsR0FBRyxJQUFJLENBQUM7QUFDL0QsaUJBQVM7QUFDVCxnQkFBUSxPQUFPLElBQUksQ0FBQztBQUNwQixZQUFNLENBQUM7QUFDUDtBQUNlO0FBQWlDO0FBRXRDO0FBQTZCO0FBQ2Y7QUFBMkI7QUFBZ0IsWUFIN0QsU0FBUyxHQUFHLENBQUMsTUFBTSxFQUFFLEtBQUssRUFBRSxFQUFFLEVBQUUsU0FBUztBQUMvQztBQUNjLG9CQURGLEtBQUs7QUFDakIsZ0JBQVEsSUFBSSxRQUFRLENBQUMsS0FBSyxDQUFDLElBQUksUUFBUSxDQUFDLE1BQU0sQ0FBQyxFQUFFO0FBQ2pELG9CQUFVLEtBQUssR0FBRyx3REFBd0QsQ0FBQztBQUMzRSxvQkFBVSxLQUFLLElBQUksNEVBQTRFLENBQUM7QUFDaEcsb0JBQVUsTUFBTSxJQUFJLEtBQUssQ0FBQyxLQUFLLENBQUMsQ0FBQztBQUNqQyxpQkFBUztBQUNULGdCQUFRLElBQUksV0FBVyxDQUFDLEtBQUssQ0FBQyxFQUFFO0FBQ2hDLG9CQUFVLEtBQUssR0FBRyxpRUFBaUUsQ0FBQztBQUNwRixvQkFBVSxLQUFLLElBQUksK0VBQStFLENBQUM7QUFDbkcsb0JBQVUsTUFBTSxJQUFJLEtBQUssQ0FBQyxLQUFLLENBQUMsQ0FBQztBQUNqQyxpQkFBUztBQUNUO0FBQ1Esc0JBRE0sSUFBSSxHQUFHLEVBQUU7QUFDdkIsZ0JBQVEsTUFBTSxDQUFDLFdBQVcsQ0FBQyxJQUFJLEVBQUUsRUFBRSxFQUFFLEtBQUssQ0FBQyxDQUFDO0FBQzVDLGdCQUFRLE1BQU0sQ0FBQyxjQUFjLENBQUMsTUFBTSxDQUFDLGlCQUFpQixDQUFDLFNBQVMsRUFBRSxJQUFJLEVBQUUsU0FBUyxDQUFDLENBQUM7QUFDbkYsZ0JBQVEsT0FBTyxrQkFBa0IsQ0FBQyxNQUFNLEVBQUUsSUFBSSxFQUFFLEtBQUssRUFBRSxLQUFLLENBQUMsQ0FBQztBQUM5RCxZQUFNLENBQUM7QUFDUDtBQUNlO0FBQ0g7QUFBZ0M7QUFDeEM7QUFFTyxZQUpMLFNBQVMsR0FBRyxDQUFDLE1BQU0sRUFBRSxLQUFLO0FBQ2hDLGdCQUFRLE9BQU8sd0JBQXdCLENBQUMsTUFBTSxFQUFFLEVBQUUsRUFBRSxLQUFLLEVBQUUsS0FBSyxDQUFDLENBQUM7QUFDbEUsWUFBTSxDQUFDO0FBQ1A7QUFDZTtBQUFpQztBQUNuQjtBQUNKO0FBQWdCLFlBRm5DLFNBQVMsT0FBTyxDQUFDLE1BQU0sRUFBRSxLQUFLLENBQUMsVUFBVTtBQUMvQztBQUNFLHNCQURZLFVBQVUsR0FBRyxFQUFFO0FBQzdCLGdCQUFRLFVBQVUsQ0FBQyxNQUFNLENBQUMsaUJBQWlCLENBQUMsR0FBRyxDQUFDLEdBQUcsS0FBSyxDQUFDLFNBQVMsQ0FBQyxNQUFNLENBQUMsSUFBSSxDQUFDLFNBQVMsRUFBRSxDQUFDLENBQUMsQ0FBQztBQUM3RixnQkFBUSxPQUFPLHdCQUF3QixDQUFDLE1BQU0sRUFBRSxVQUFVLEVBQUUsS0FBSyxFQUFFLEtBQUssQ0FBQyxDQUFDO0FBQzFFLFlBQU0sQ0FBQztBQUNQO0FBQ2U7QUFDWDtBQUNVO0FBQThCO0FBQTJCO0FBQWdCLFlBRmpGLFNBQVMsTUFBTSxDQUFDLE1BQU0sRUFBRSxLQUFLLEVBQUUsR0FBRztBQUN4QyxnQkFBUSxJQUFJLENBQUMsS0FBSyxFQUFFO0FBQ3BCLG9CQUFVLE1BQU0sSUFBSSxLQUFLLENBQUMsMkRBQTJELENBQUMsQ0FBQztBQUN2RixpQkFBUztBQUNUO0FBQ1Esc0JBRE0sSUFBSSxHQUFHLEVBQUU7QUFDdkIsZ0JBQVEsTUFBTSxDQUFDLFlBQVksQ0FBQyxJQUFJLEVBQUUsR0FBRyxFQUFFLEtBQUssQ0FBQyxDQUFDO0FBQzlDLGdCQUFRLE9BQU8sa0JBQWtCLENBQUMsTUFBTSxFQUFFLElBQUksRUFBRSxLQUFLLEVBQUUsS0FBSyxDQUFDLENBQUM7QUFDOUQsWUFBTSxDQUFDO0FBQ1A7QUFDZTtBQUNYO0FBQ1U7QUFBOEI7QUFBMkI7QUFBZ0IsWUFGakYsU0FBUyxNQUFNLENBQUMsTUFBTSxFQUFFLEtBQUssRUFBRSxHQUFHO0FBQ3hDLGdCQUFRLElBQUksQ0FBQyxLQUFLLEVBQUU7QUFDcEIsb0JBQVUsTUFBTSxJQUFJLEtBQUssQ0FBQywyREFBMkQsQ0FBQyxDQUFDO0FBQ3ZGLGlCQUFTO0FBQ1Q7QUFDUSxzQkFETSxJQUFJLEdBQUcsRUFBRTtBQUN2QixnQkFBUSxNQUFNLENBQUMsWUFBWSxDQUFDLElBQUksRUFBRSxHQUFHLEVBQUUsS0FBSyxDQUFDLENBQUM7QUFDOUMsZ0JBQVEsT0FBTyx3QkFBd0IsQ0FBQyxNQUFNLEVBQUUsSUFBSSxFQUFFLEtBQUssRUFBRSxLQUFLLENBQUMsQ0FBQztBQUNwRSxZQUFNLENBQUM7QUFDUDtBQUVLO0FBQWdCO0FBQWtDO0FBQ3JDO0FBQ2I7QUFFa0I7QUFBZ0IsWUFKakMsU0FBUyxzQkFBc0IsQ0FBQyxPQUFPLEVBQUUsWUFBWSxFQUFFLFdBQVc7QUFDeEUsZ0JBQVEsT0FBTyxPQUFPLENBQUMsSUFBSSxDQUFDLE1BQU07QUFBTTtBQUcxQjtBQUErQjtBQUFvQixnQkFIOUIsR0FBRyxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUMsR0FBRyxFQUFDLENBQUMsQ0FBQztBQUNsRCxZQUFNLENBQUM7QUFDUDtBQUNlO0FBQWtDO0FBQ25DO0FBRUw7QUFBc0M7QUFDdkI7QUFDbkIsWUFMQyxTQUFTLGNBQWMsQ0FBQyxPQUFPLEVBQUUsUUFBUSxFQUFFLElBQUksRUFBRSxXQUFXO0FBQ2xFLGdCQUFRLE1BQU0sQ0FBQyxXQUFXLEVBQUUsSUFBSSxDQUFDLENBQUM7QUFDbEMsZ0JBQ1EseUNBQXlDO0FBQ2pELGdCQUFRLElBQUksTUFBTSxDQUFDLFlBQVksRUFBRTtBQUNqQyxvQkFBVSxPQUFPLENBQUMsSUFBSSxDQUFDLE1BQU0sQ0FBQyxRQUFRLEVBQUU7QUFDeEMsd0JBQVksSUFBSSxFQUFFLElBQUk7QUFDdEIscUJBQVcsQ0FBQyxDQUFDLENBQUM7QUFDZCxpQkFBUztBQUFDLHFCQUFLO0FBQ2Ysb0JBQVUsT0FBTyxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsQ0FBQztBQUM3QixpQkFBUztBQUNULGdCQUNRLE9BQU8sQ0FBQyxRQUFRLEVBQUUsQ0FBQztBQUMzQixZQUFNLENBQUM7QUFDUDtBQUVLO0FBQWdCO0FBQ1Q7QUFDRjtBQUFnQixZQUZwQixTQUFTLGdCQUFnQixDQUFDLElBQUk7QUFDcEMsZ0JBQVEsSUFBSSxPQUFPLENBQUMsSUFBSSxDQUFDLEVBQUU7QUFDM0I7QUFDUywwQkFETyxLQUFLLEdBQUcsRUFBRTtBQUMxQixvQkFBVSxJQUFJLENBQUMsSUFBSTtBQUFPO0FBQ0E7QUFBbUM7QUFBd0Isb0JBRGhFLFVBQVUsS0FBSztBQUNwQyx3QkFBWSxLQUFLLENBQUMsSUFBSSxDQUFDLE1BQU0sQ0FBQyxpQkFBaUIsQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFDLENBQUMsZ0JBQWdCLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQyxDQUFDLEtBQUssQ0FBQyxDQUFDO0FBQzFGLG9CQUFVLENBQUMsRUFBQyxDQUFDO0FBQ2Isb0JBQVUsT0FBTyxLQUFLLENBQUM7QUFDdkIsaUJBQVM7QUFBQyxxQkFBSztBQUNmLG9CQUFVLE9BQU8sSUFBSSxDQUFDLElBQUksRUFBRSxNQUFNLENBQUMsSUFBSSxDQUFDLE1BQU0sQ0FBQyxpQkFBaUIsRUFBRSxJQUFJLENBQUMsQ0FBQyxDQUFDLENBQUM7QUFDMUUsaUJBQVM7QUFDVCxZQUFNLENBQUM7QUFDUDtBQUNlO0FBQ1g7QUFBMkI7QUFBZ0IsWUFEekMsU0FBUyxrQkFBa0IsQ0FBQyxJQUFJO0FBQ3RDLGdCQUFRLElBQUksQ0FBQyxNQUFNLENBQUMsaUJBQWlCLENBQUMsZUFBZSxDQUFDLEdBQUcsSUFBSSxDQUFDLGNBQWMsRUFBRSxJQUFJLENBQUMsQ0FBQztBQUNwRjtBQUFpQyxzQkFBbkIsY0FBYyxHQUFHLEVBQUMsR0FBRyxFQUFFLGNBQWMsRUFBRSxNQUFNLEVBQUUsY0FBYyxFQUFDO0FBQzVFLGdCQUFRLElBQUksQ0FBQyxDQUFDLEtBQUssRUFBRSxPQUFPLEVBQUUsTUFBTSxDQUFDO0FBQU87QUFDdEI7QUFBK0I7QUFBb0IsZ0JBRGxDLFVBQVUsSUFBSTtBQUNyRCxvQkFBVSxjQUFjLENBQUMsSUFBSSxDQUFDO0FBQVE7QUFBNEM7QUFDOUM7QUFBdUM7QUFHMUU7QUFBMEM7QUFDekI7QUFBd0Isb0JBTFQsVUFBVSxTQUFTLEVBQUUsT0FBTyxFQUFFLElBQUksRUFBRSxNQUFNLEVBQUUsT0FBTztBQUNwRix3QkFBWSxPQUFPLElBQUksQ0FBQyxjQUFjLEVBQUUsSUFBSSxDQUFDLENBQUMsU0FBUyxFQUFFLElBQUksRUFBRSxNQUFNLEVBQUUsT0FBTyxFQUFFLE9BQU8sQ0FBQyxDQUFDO0FBQ3pGLG9CQUFVLENBQUMsQ0FBQSxDQUFDO0FBQ1osZ0JBQVEsQ0FBQyxFQUFDLENBQUM7QUFDWCxnQkFBUSxJQUFJLENBQUMsY0FBYztBQUFPO0FBQ2xCO0FBQW1DO0FBQ3RDO0FBQW9CLGdCQUZKLFVBQVUsV0FBVyxFQUFFLElBQUk7QUFDeEQ7QUFBcUMsMEJBQXJCLGFBQWEsR0FBRyxJQUFJLEtBQUssUUFBUSxDQUFDLENBQUMsQ0FBQyxRQUFRLENBQUMsQ0FBQyxDQUFDLElBQUk7QUFDbkUsb0JBQVUsSUFBSSxDQUFDLENBQUMsSUFBSSxFQUFFLFFBQVEsQ0FBQztBQUFPO0FBQ1o7QUFBbUM7QUFBd0Isb0JBRHBELFVBQVUsS0FBSztBQUNoRCx3QkFBWSxJQUFJLENBQUMsS0FBSyxHQUFHLElBQUksQ0FBQyxXQUFXLEVBQUUsQ0FBQyxHQUFHLElBQUksQ0FBQyxXQUFXLEVBQUUsSUFBSSxFQUFFLGFBQWEsQ0FBQyxDQUFDO0FBQ3RGLG9CQUFVLENBQUMsRUFBQyxDQUFDO0FBQ2IsZ0JBQVEsQ0FBQyxFQUFDLENBQUM7QUFDWCxnQkFBUSxJQUFJLENBQUMsTUFBTSxDQUFDLGlCQUFpQixDQUFDLGFBQWEsQ0FBQyxHQUFHLElBQUksQ0FBQyxhQUFhLEVBQUUsSUFBSSxDQUFDLENBQUM7QUFDakYsZ0JBQVEsSUFBSSxDQUFDLE1BQU0sQ0FBQyxpQkFBaUIsQ0FBQyxTQUFTLENBQUMsR0FBRyxJQUFJLENBQUMsTUFBTSxDQUFDLGlCQUFpQixDQUFDLGFBQWEsQ0FBQyxDQUFDO0FBQ2hHLFlBQU0sQ0FBQztBQUNQO0FBQ2U7QUFBc0M7QUFDcEM7QUFBMkI7QUFBZ0IsWUFEdEQsU0FBUywwQkFBMEIsQ0FBQyxXQUFXLEVBQUUsU0FBUyxHQUFHLEVBQUU7QUFDckU7QUFBaUMsc0JBQW5CLGFBQWEsR0FBRyxNQUFNLENBQUMsU0FBUyxFQUFFLFdBQVcsQ0FBQztBQUM1RCxnQkFBUSxPQUFPLGtCQUFrQixDQUFDLGFBQWEsQ0FBQyxNQUFNLENBQUMsaUJBQWlCLENBQUMsY0FBYyxDQUFDLEVBQzlFLGFBQWEsRUFBRSxhQUFhLENBQUMsTUFBTSxDQUFDLGlCQUFpQixDQUFDLEtBQUssQ0FBQyxFQUFFLElBQUksQ0FBQyxDQUFDO0FBQzlFLFlBQU0sQ0FBQztBQUNQO0FBQ2U7QUFBaUM7QUFBa0M7QUFDbEU7QUFBc0M7QUFFM0M7QUFBcUM7QUFBMkI7QUFFM0UsWUFMTSxTQUFTLGtCQUFrQixDQUFDLE1BQU0sRUFBRSxPQUFPLEVBQUUsS0FBSyxFQUFFLFVBQVcsRUFBRSxVQUFXLEVBQUUsU0FBVTtBQUM5RjtBQUFpQyxzQkFBbkIsSUFBSSxHQUFHLE1BQU0sQ0FBQywyQkFBMkIsQ0FBQyxPQUFPLEVBQUUsS0FBSyxFQUFFLEtBQUssQ0FBQztBQUM5RTtBQUNnQyxzQkFBbEIsU0FBUyxHQUFHLGtCQUFrQixDQUFDLE1BQU0sRUFBRSxJQUFJLEVBQUUsS0FBSyxFQUFFLFNBQVMsRUFBRSxVQUFVLENBQUM7QUFDeEYsZ0JBQ1EsSUFBSSxNQUFNLENBQUMsZUFBZSxFQUFFO0FBQ3BDLG9CQUFVLFNBQVMsQ0FBQyxNQUFNLENBQUMsaUJBQWlCLENBQUMsWUFBWSxDQUFDLEdBQUcsTUFBTSxDQUFDLGFBQWEsQ0FBQyxTQUFTLENBQUMsQ0FBQztBQUM3RixpQkFBUztBQUNULGdCQUNRLElBQUksVUFBVSxFQUFFO0FBQ3hCLG9CQUFVLFNBQVMsQ0FBQyxNQUFNLENBQUMsaUJBQWlCLENBQUMsYUFBYSxDQUFDO0FBQVE7QUFDekM7QUFFcEIsb0JBSHdEO0FBQzlELHdCQUFZLE9BQU8sVUFBVSxDQUFDO0FBQzlCLG9CQUFVLENBQUMsQ0FBQSxDQUFDO0FBQ1osaUJBQVM7QUFDVCxnQkFDUSxTQUFTLENBQUMsTUFBTSxDQUFDLGlCQUFpQixDQUFDLHFCQUFxQixDQUFDLEdBQUcsS0FBSyxDQUFDO0FBQzFFLGdCQUFRLFNBQVMsQ0FBQyxNQUFNLENBQUMsaUJBQWlCLENBQUMsR0FBRyxDQUFDLEdBQUcsSUFBSSxDQUFDLFdBQVcsRUFBRSxTQUFTLENBQUMsQ0FBQztBQUMvRSxnQkFBUSxTQUFTLENBQUMsTUFBTSxDQUFDLGlCQUFpQixDQUFDLE9BQU8sQ0FBQyxHQUFHLElBQUksQ0FBQyxhQUFhLEVBQUUsU0FBUyxDQUFDLENBQUM7QUFDckYsZ0JBQVEsU0FBUyxDQUFDLE1BQU0sQ0FBQyxpQkFBaUIsQ0FBQyxHQUFHLENBQUMsR0FBRyxJQUFJLENBQUMsV0FBVyxFQUFFLFNBQVMsQ0FBQyxDQUFDO0FBQy9FLGdCQUFRLFNBQVMsQ0FBQyxNQUFNLENBQUMsaUJBQWlCLENBQUMsSUFBSSxDQUFDLEdBQUcsSUFBSSxDQUFDLFlBQVksRUFBRSxTQUFTLENBQUMsQ0FBQztBQUNqRixnQkFBUSxTQUFTLENBQUMsTUFBTSxDQUFDLGlCQUFpQixDQUFDLE1BQU0sQ0FBQyxHQUFHLElBQUksQ0FBQyxjQUFjLEVBQUUsU0FBUyxDQUFDLENBQUM7QUFDckYsZ0JBQVEsU0FBUyxDQUFDLE1BQU0sQ0FBQyxpQkFBaUIsQ0FBQyxJQUFJLENBQUMsR0FBRyxJQUFJLENBQUMsWUFBWSxFQUFFLFNBQVMsQ0FBQyxDQUFDO0FBQ2pGLGdCQUFRLFNBQVMsQ0FBQyxNQUFNLENBQUMsaUJBQWlCLENBQUMsS0FBSyxDQUFDLEdBQUcsSUFBSSxDQUFDLGFBQWEsRUFBRSxTQUFTLENBQUMsQ0FBQztBQUNuRixnQkFBUSxTQUFTLENBQUMsTUFBTSxDQUFDLGlCQUFpQixDQUFDLE9BQU8sQ0FBQyxHQUFHLElBQUksQ0FBQyxlQUFlLEVBQUUsU0FBUyxDQUFDLENBQUM7QUFDdkYsZ0JBQVEsU0FBUyxDQUFDLE1BQU0sQ0FBQyxpQkFBaUIsQ0FBQyxLQUFLLENBQUMsR0FBRyxJQUFJLENBQUMsYUFBYSxFQUFFLFNBQVMsQ0FBQyxDQUFDO0FBQ25GLGdCQUFRLFNBQVMsQ0FBQyxNQUFNLENBQUMsaUJBQWlCLENBQUMsSUFBSSxDQUFDLEdBQUcsSUFBSSxDQUFDLElBQUksRUFBRSxTQUFTLENBQUMsQ0FBQztBQUN6RSxnQkFDUSxrQkFBa0IsQ0FBQyxTQUFTLENBQUMsQ0FBQztBQUN0QyxnQkFBUSxPQUFPLE1BQU0sQ0FBQyxhQUFhLENBQUMsU0FBUyxFQUFFLEtBQUssRUFBRSxLQUFLLEVBQUUsT0FBTyxFQUFFLElBQUksQ0FBQyxDQUFDO0FBQzVFLFlBQU0sQ0FBQztBQUNQO0FBQ2U7QUFBaUM7QUFBa0M7QUFDM0Q7QUFBc0M7QUFFM0M7QUFBMkI7QUFBZ0IsWUFIdkQsU0FBUyx3QkFBd0IsQ0FBQyxNQUFNLEVBQUUsT0FBTyxFQUFFLEtBQUssRUFBRSxVQUFXLEVBQUUsU0FBVTtBQUN2RjtBQUFpQyxzQkFBbkIsSUFBSSxHQUFHLE1BQU0sQ0FBQywyQkFBMkIsQ0FBQyxPQUFPLEVBQUUsSUFBSSxFQUFFLEtBQUssQ0FBQztBQUM3RTtBQUNnQyxzQkFBbEIsU0FBUyxHQUFHLGtCQUFrQixDQUFDLE1BQU0sRUFBRSxJQUFJLEVBQUUsS0FBSyxFQUFFLFNBQVMsRUFBRSxVQUFVLENBQUM7QUFDeEYsZ0JBQVEsU0FBUyxDQUFDLE1BQU0sQ0FBQyxpQkFBaUIsQ0FBQyxxQkFBcUIsQ0FBQyxHQUFHLElBQUksQ0FBQztBQUN6RSxnQkFBUSxTQUFTLENBQUMsTUFBTSxDQUFDLGlCQUFpQixDQUFDLElBQUksQ0FBQyxHQUFHLElBQUksQ0FBQyxZQUFZLEVBQUUsU0FBUyxFQUFFLElBQUksQ0FBQyxDQUFDO0FBQ3ZGLGdCQUFRLFNBQVMsQ0FBQyxNQUFNLENBQUMsaUJBQWlCLENBQUMsTUFBTSxDQUFDLEdBQUcsSUFBSSxDQUFDLGNBQWMsRUFBRSxTQUFTLENBQUMsQ0FBQztBQUNyRixnQkFBUSxTQUFTLENBQUMsTUFBTSxDQUFDLGlCQUFpQixDQUFDLElBQUksQ0FBQyxHQUFHLElBQUksQ0FBQyxZQUFZLEVBQUUsU0FBUyxDQUFDLENBQUM7QUFDakYsZ0JBQVEsU0FBUyxDQUFDLE1BQU0sQ0FBQyxpQkFBaUIsQ0FBQyxLQUFLLENBQUMsR0FBRyxJQUFJLENBQUMsYUFBYSxFQUFFLFNBQVMsQ0FBQyxDQUFDO0FBQ25GLGdCQUFRLFNBQVMsQ0FBQyxNQUFNLENBQUMsaUJBQWlCLENBQUMsVUFBVSxDQUFDLEdBQUcsSUFBSSxDQUFDLGtCQUFrQixFQUFFLFNBQVMsQ0FBQyxDQUFDO0FBQzdGLGdCQUFRLFNBQVMsQ0FBQyxNQUFNLENBQUMsaUJBQWlCLENBQUMsT0FBTyxDQUFDLEdBQUcsSUFBSSxDQUFDLGVBQWUsRUFBRSxTQUFTLENBQUMsQ0FBQztBQUN2RixnQkFBUSxTQUFTLENBQUMsTUFBTSxDQUFDLGlCQUFpQixDQUFDLEtBQUssQ0FBQyxHQUFHLElBQUksQ0FBQyxhQUFhLEVBQUUsU0FBUyxDQUFDLENBQUM7QUFDbkYsZ0JBQVEsU0FBUyxDQUFDLE1BQU0sQ0FBQyxpQkFBaUIsQ0FBQyxHQUFHLENBQUMsR0FBRyxJQUFJLENBQUMsT0FBTyxFQUFFLFNBQVMsQ0FBQyxDQUFDO0FBQzNFLGdCQUFRLFNBQVMsQ0FBQyxNQUFNLENBQUMsaUJBQWlCLENBQUMsT0FBTyxDQUFDLEdBQUcsSUFBSSxDQUFDLGFBQWEsRUFBRSxTQUFTLEVBQUUsSUFBSSxDQUFDLENBQUM7QUFDM0YsZ0JBQ1Esa0JBQWtCLENBQUMsU0FBUyxDQUFDLENBQUM7QUFDdEMsZ0JBQVEsT0FBTyxNQUFNLENBQUMsYUFBYSxDQUFDLFNBQVMsRUFBRSxJQUFJLEVBQUUsS0FBSyxFQUFFLE9BQU8sRUFBRSxJQUFJLENBQUMsQ0FBQztBQUMzRSxZQUFNLENBQUM7QUFDUDtBQUNlO0FBQWlDO0FBQzNDO0FBQWdDO0FBQTJCO0FBQWdCLFlBRDFFLFNBQVMsbUNBQW1DLENBQUMsTUFBTSxFQUFFLE9BQU8sRUFBRSxLQUFLO0FBQ3pFO0FBQWlDLHNCQUFuQixVQUFVLEdBQUcsd0JBQXdCLENBQUMsTUFBTSxFQUFFLE9BQU8sRUFBRSxLQUFLLEVBQUUsS0FBSyxDQUFDO0FBQ2xGLGdCQUFRLElBQUksQ0FBQyxVQUFVO0FBQU87QUFFOUI7QUFBK0I7QUFBb0IsZ0JBRjFCLFVBQVUsSUFBSTtBQUN2QyxvQkFBVSxJQUFJLElBQUksRUFBRTtBQUNwQix3QkFBWSxrQkFBa0IsQ0FBQyxNQUFNLEVBQUUsSUFBSSxFQUFFLEtBQUssRUFBRSxLQUFLLENBQUMsQ0FBQztBQUMzRCxxQkFBVztBQUNYLGdCQUFRLENBQUMsRUFBQyxDQUFDO0FBQ1gsZ0JBQVEsT0FBTyxVQUFVLENBQUM7QUFDMUIsWUFBTSxDQUFDO0FBQ1A7QUFDZTtBQUE2QjtBQUNiO0FBQWtDO0FBR2hEO0FBQWdCLFlBSjNCLFNBQVMsT0FBTyxDQUFDLEVBQUUsRUFBRSxTQUFTLEVBQUUsT0FBTztBQUM3QyxnQkFBUSxPQUFPLElBQUksQ0FBQyxTQUFTLENBQUMsRUFBRSxDQUFDLFFBQVEsRUFBRSxFQUFFLFNBQVMsRUFBRSxPQUFPLENBQUMsQ0FBQztBQUNqRSxZQUFNLENBQUM7QUFDUDtBQUNlO0FBQThCO0FBQ3pCO0FBQ0s7QUFDVjtBQUFnQixZQUh6QixTQUFTLGtCQUFrQixDQUFDLEdBQUcsRUFBRSxNQUFNLEVBQUUsT0FBTztBQUN0RDtBQUNJLHNCQURVLE1BQU0sR0FBRyxJQUFJO0FBQzNCO0FBQWlDLHNCQUFuQixTQUFTLEdBQUcsSUFBSSxDQUFDLEdBQUcsQ0FBQztBQUNuQztBQUFpQyxzQkFBbkIsT0FBTyxHQUFHLElBQUksZUFBZSxDQUFDLElBQUksQ0FBQztBQUNqRDtBQUNHLG9CQURTLFdBQVcsR0FBRyxFQUFFO0FBQzVCLGdCQUFRLFdBQVcsR0FBRyxNQUFNLENBQUMsYUFBYSxDQUFDLFdBQVcsRUFBRSxJQUFJLEVBQUUsU0FBUyxDQUFDLE1BQU0sQ0FBQyxpQkFBaUIsQ0FBQyxLQUFLLENBQUMsRUFBRSxPQUFPLENBQUMsQ0FBQztBQUNsSCxnQkFDUSxTQUFTLENBQUMsR0FBRyxDQUFDLE1BQU0sRUFBRSxPQUFPLENBQUM7QUFDdEMscUJBQVMsU0FBUztBQUFNO0FBQ0Y7QUFBK0I7QUFDM0MsZ0JBRlMsVUFBVSxVQUFVO0FBQ3ZDO0FBQXFDLDBCQUFyQixRQUFRLEdBQUcsMEJBQTBCLENBQUMsTUFBTSxDQUFDO0FBQzdELG9CQUFVLFFBQVEsQ0FBQyxHQUFHLENBQUMsR0FBRyxVQUFVLENBQUM7QUFDckMsb0JBQVUsV0FBVyxHQUFHLFFBQVEsQ0FBQztBQUNqQyxvQkFBVSxPQUFPLENBQUMsSUFBSSxDQUFDLFFBQVEsQ0FBQyxDQUFDO0FBQ2pDLGdCQUFRLENBQUM7QUFBUTtBQUNNO0FBQ0o7QUFDTCxnQkFISCxVQUFVLFFBQVE7QUFDN0Isb0JBQVUsT0FBTyxDQUFDLEtBQUssQ0FBQyxRQUFRLENBQUMsQ0FBQztBQUNsQyxnQkFBUSxDQUFDO0FBQVE7QUFDTTtBQUd2QixnQkFKVztBQUNYLG9CQUFVLE9BQU8sQ0FBQyxRQUFRLEVBQUUsQ0FBQztBQUM3QixnQkFBUSxDQUFDLEVBQUMsQ0FBQztBQUNYLGdCQUNRLE9BQU8sc0JBQXNCLENBQUMsT0FBTyxFQUFFLElBQUksRUFBRSxXQUFXLENBQUMsQ0FBQztBQUNsRSxZQUFNLENBQUM7QUFDUDtBQUNlO0FBQWtDO0FBQW9DO0FBQ3ZEO0FBQW1DO0FBQW1DO0FBQ3JFO0FBQ3hCO0FBQWdCLFlBSGpCLFNBQVMsYUFBYSxDQUFDLE9BQU8sRUFBRSxTQUFTLEVBQUUsS0FBSyxFQUFFLFFBQVEsRUFBRSxRQUFRLEVBQUUsT0FBTztBQUNuRjtBQUFpQyxzQkFBbkIsSUFBSSxHQUFHLE1BQU0sQ0FBQyxpQkFBaUIsQ0FBQyxPQUFPLEVBQUUsU0FBUyxFQUFFLEtBQUssRUFBRSxRQUFRLEVBQUUsUUFBUSxFQUFFLE9BQU8sQ0FBQztBQUNyRztBQUFpQyxzQkFBbkIsSUFBSSxHQUFHLFFBQVEsQ0FBQyxPQUFPLENBQUMsR0FBRyxDQUFDLE1BQU0sQ0FBQztBQUNqRCxnQkFBUSxJQUFJLElBQUksSUFBSSxJQUFJLEVBQUU7QUFDMUIsb0JBQVUsSUFBSSxDQUFDLE1BQU0sQ0FBQyxpQkFBaUIsQ0FBQyxJQUFJLENBQUMsR0FBRyxJQUFJLENBQUM7QUFDckQsaUJBQVM7QUFDVCxnQkFBUSxPQUFPLElBQUksQ0FBQztBQUNwQixZQUFNLENBQUM7QUFDUDtBQUNlO0FBQStCO0FBQ3JCO0FBQ0s7QUFDeEI7QUFBZ0IsWUFIaEIsU0FBUyxhQUFhLENBQUMsSUFBSSxFQUFFLFNBQVMsRUFBRSxPQUFPO0FBQ3JEO0FBQ0ksc0JBRFUsTUFBTSxHQUFHLElBQUk7QUFDM0I7QUFBaUMsc0JBQW5CLE9BQU8sR0FBRyxJQUFJLGVBQWUsQ0FBQyxJQUFJLENBQUM7QUFDakQ7QUFBaUMsc0JBQW5CLFNBQVMsR0FBRyxTQUFTO0FBQ25DO0FBQWlDLHNCQUFuQixHQUFHLEdBQUcsVUFBVSxDQUFDLFFBQVEsQ0FBQyxJQUFJLEVBQUUsSUFBSSxDQUFDO0FBQ25EO0FBQWlDLHNCQUFuQixXQUFXLEdBQUcsSUFBSSxJQUFJLE1BQU0sQ0FBQyxNQUFNLENBQUMsaUJBQWlCLENBQUMsS0FBSyxDQUFDO0FBQzFFO0FBQ2dDLHNCQUFsQixPQUFPLEdBQUcsTUFBTSxDQUFDLHNCQUFzQixDQUFDLElBQUksRUFBRSxTQUFTLEVBQzNELFdBQVcsRUFBRSxHQUFHLEVBQUUsT0FBTyxJQUFJLEVBQUUsRUFBRSxTQUFTLElBQUksRUFBRSxFQUFFLElBQUksQ0FBQyxNQUFNLENBQUMsaUJBQWlCLENBQUMsVUFBVSxDQUFDLElBQUksRUFBRSxDQUFDO0FBQzVHO0FBRUUsb0JBRFUsV0FBVyxHQUFHLEVBQUU7QUFDNUIsZ0JBQVEsV0FBVyxHQUFHLE1BQU0sQ0FBQyxhQUFhLENBQUMsV0FBVyxFQUFFLElBQUksRUFBRSxXQUFXLEVBQUUsT0FBTyxDQUFDLENBQUM7QUFDcEY7QUFFQSxvQkFEWSxNQUFNLEdBQUcsU0FBUztBQUM5QixnQkFDUSxJQUFJLE1BQU0sQ0FBQyxLQUFLLEVBQUU7QUFDMUIsb0JBQVUsTUFBTSxHQUFHLE9BQU8sQ0FBQztBQUMzQixpQkFBUztBQUNUO0FBQ2dDLHNCQUFsQixVQUFVO0FBQVE7QUFDVjtBQUNWO0FBQW9CLGdCQUZMLFVBQVUsUUFBUTtBQUM3QztBQUFxQywwQkFBckIsT0FBTyxHQUFHLFFBQVEsQ0FBQyxJQUFJO0FBQ3ZDO0FBQXFDLDBCQUFyQixVQUFVLEdBQUcsUUFBUSxDQUFDLE1BQU0sQ0FBQyxNQUFNO0FBQ25EO0FBQXFDLHdCQUF2QixJQUFJLEdBQUcsYUFBYSxDQUFDLE9BQU8sRUFBRSxTQUFTLEVBQUUsV0FBVyxFQUFFLEdBQUcsRUFBRSxRQUFRLEVBQUUsT0FBTyxDQUFDO0FBQzNGLG9CQUNVLHlGQUF5RjtBQUNuRyxvQkFBVSxJQUFJLFdBQVcsQ0FBQyxJQUFJLENBQUMsSUFBSSxFQUFFLEtBQUssSUFBSSxFQUFFO0FBQ2hELHdCQUFZLElBQUksR0FBRyxFQUFFLENBQUM7QUFDdEIscUJBQVc7QUFDWCxvQkFBVSxJQUFJLENBQUMsT0FBTyxDQUFDLElBQUksQ0FBQyxFQUFFO0FBQzlCLHdCQUFZLE1BQU0sSUFBSSxLQUFLLENBQUMsNkVBQTZFLENBQUMsQ0FBQztBQUMzRyxxQkFBVztBQUNYLG9CQUNVLElBQUksSUFBSSxLQUFLLE1BQU0sQ0FBQyxjQUFjLEVBQUU7QUFDOUMsd0JBQVksT0FBTyxjQUFjLENBQUMsT0FBTyxFQUFFLFFBQVEsRUFBRSxJQUFJLEVBQUUsV0FBVyxDQUFDLENBQUM7QUFDeEUscUJBQVc7QUFDWDtBQUNvQyx3QkFBdEIsYUFBYSxHQUFHLEdBQUcsQ0FBQyxJQUFJO0FBQU87QUFDbkI7QUFBbUM7QUFDbkQsb0JBRjhCLFVBQVUsSUFBSTtBQUN0RCx3QkFBWSxJQUFJLENBQUMsTUFBTSxDQUFDLE1BQU0sQ0FBQyxpQkFBaUIsQ0FBQyxxQkFBcUIsQ0FBQyxFQUFFO0FBQ3pFLDRCQUFjLE9BQU8sa0JBQWtCLENBQUMsTUFBTSxFQUFFLElBQUksRUFBRSxJQUFJLEVBQUUsSUFBSSxFQUFFLElBQUksQ0FBQyxDQUFDO0FBQ3hFLHlCQUFhO0FBQUMsNkJBQUs7QUFDbkIsNEJBQWMsT0FBTyxrQkFBa0IsQ0FBQyxNQUFNLENBQUMsTUFBTSxDQUFDLGlCQUFpQixDQUFDLGNBQWMsQ0FBQyxFQUN2RSxJQUFJLEVBQUUsTUFBTSxDQUFDLE1BQU0sQ0FBQyxpQkFBaUIsQ0FBQyxLQUFLLENBQUMsRUFBRSxJQUFJLEVBQUUsSUFBSSxDQUFDLENBQUM7QUFDMUUseUJBQWE7QUFDYixvQkFBVSxDQUFDLEVBQUM7QUFDWixvQkFDVSxhQUFhLEdBQUcsTUFBTSxDQUFDLElBQUksRUFBRSxhQUFhLENBQUMsQ0FBQztBQUN0RCxvQkFDVSxJQUFJLENBQUMsTUFBTSxDQUFDLE1BQU0sQ0FBQyxpQkFBaUIsQ0FBQyxxQkFBcUIsQ0FBQyxFQUFFO0FBQ3ZFLHdCQUFZLGNBQWMsQ0FDWixPQUFPLEVBQ1AsUUFBUSxFQUNSLHdCQUF3QixDQUN0QixNQUFNLEVBQ04sYUFBYSxFQUNiLElBQUksRUFDSixJQUFJLEVBQ0osVUFBVSxDQUNYLEVBQ0QsV0FBVyxDQUNaLENBQUM7QUFDZCxxQkFBVztBQUFDLHlCQUFLO0FBQ2pCLHdCQUFZLGNBQWMsQ0FDWixPQUFPLEVBQ1AsUUFBUSxFQUNSLHdCQUF3QixDQUN0QixNQUFNLENBQUMsTUFBTSxDQUFDLGlCQUFpQixDQUFDLGNBQWMsQ0FBQyxFQUMvQyxhQUFhLEVBQ2IsTUFBTSxDQUFDLE1BQU0sQ0FBQyxpQkFBaUIsQ0FBQyxLQUFLLENBQUMsRUFDdEMsSUFBSSxFQUNKLFVBQVUsQ0FDWCxFQUNELFdBQVcsQ0FDWixDQUFDO0FBQ2QscUJBQVc7QUFDWCxnQkFBUSxDQUFDLENBQUE7QUFDVCxnQkFDUSxVQUFVLENBQUMsUUFBUSxDQUFDLElBQUksRUFBRSxLQUFLLEVBQUUsT0FBTyxDQUFDLFVBQVUsRUFBRSxPQUFPLENBQUMsT0FBTyxFQUFFLE9BQU8sQ0FBQyxNQUFNLEVBQUUsSUFBSSxFQUN4RixJQUFJLENBQUMsTUFBTSxDQUFDLGlCQUFpQixDQUFDLElBQUksQ0FBQyxFQUFFLFNBQVMsQ0FBQyxDQUFDLE1BQU0sQ0FBQyxFQUFFO0FBQ25FLHFCQUFTLFNBQVMsQ0FBQyxVQUFVO0FBQU87QUFDbkI7QUFBK0I7QUFBb0IsZ0JBRHJDLFNBQVMsS0FBSyxDQUFDLFFBQVE7QUFDdEQsb0JBQVUsSUFBSSxRQUFRLENBQUMsTUFBTSxLQUFLLEdBQUcsSUFBSSxNQUFNLENBQUMsTUFBTSxDQUFDLGlCQUFpQixDQUFDLHFCQUFxQixDQUFDLEVBQUU7QUFDakcsd0JBQVksY0FBYyxDQUFDLE9BQU8sRUFBRSxRQUFRLEVBQUUsTUFBTSxFQUFFLFdBQVcsQ0FBQyxDQUFDO0FBQ25FLHFCQUFXO0FBQUMseUJBQUssSUFBSSxLQUFLLENBQUMsTUFBTSxDQUFDLGlCQUFpQjtBQUFPO0FBRXRDO0FBQW1DO0FBQ3hDLG9CQUhzQyxVQUFVLEVBQU87QUFDdEUsd0JBQ1ksT0FBTyxFQUFFLENBQUMsUUFBUSxFQUFFLE9BQU8sRUFBRSxVQUFVLENBQUMsS0FBSyxLQUFLLENBQUM7QUFDL0Qsb0JBQVUsQ0FBQyxFQUFDLEVBQUU7QUFDZCx3QkFBWSx5Q0FBeUM7QUFDckQsd0JBQVksT0FBTyxDQUFDLEtBQUssQ0FBQyxRQUFRLENBQUMsQ0FBQztBQUNwQyxxQkFBVztBQUNYLGdCQUFRLENBQUMsRUFBQyxDQUFDO0FBQ1gsZ0JBQ1EsT0FBTyxzQkFBc0IsQ0FBQyxPQUFPLEVBQUUsSUFBSSxFQUFFLFdBQVcsQ0FBQyxDQUFDO0FBQ2xFLFlBQU0sQ0FBQztBQUNQO0FBQ2U7QUFDUDtBQUEyQjtBQUFnQixZQUQ3QyxTQUFTLGNBQWMsQ0FBQyxVQUFVO0FBQ3hDLGdCQUFRLElBQUksQ0FBQyxNQUFNLENBQUMsaUJBQWlCLENBQUMsVUFBVSxDQUFDLEdBQUcsVUFBVSxDQUFDO0FBQy9ELGdCQUFRLE9BQU8sSUFBSSxDQUFDO0FBQ3BCLFlBQU0sQ0FBQztBQUNQO0FBQ2U7QUFDTjtBQUFrQztBQUM5QjtBQUFnQixZQUZ2QixTQUFTLElBQUksQ0FBQyxNQUFNLEVBQUUsT0FBTztBQUNuQyxnQkFBUSxJQUFJLElBQUksQ0FBQyxNQUFNLENBQUMsaUJBQWlCLENBQUMsVUFBVSxDQUFDLEVBQUU7QUFDdkQsb0JBQVUsT0FBTyxJQUFJLENBQUMsTUFBTSxDQUFDLGlCQUFpQixDQUFDLEdBQUcsQ0FBQyxDQUFDLE1BQU0sRUFBRSxPQUFPLENBQUMsQ0FBQztBQUNyRSxpQkFBUztBQUFDLHFCQUFLO0FBQ2Ysb0JBQVUsT0FBTyxJQUFJLENBQUMsWUFBWSxFQUFFLElBQUksQ0FBQyxDQUFDLE1BQU0sRUFBRSxTQUFTLEVBQUUsTUFBTSxFQUFFLFNBQVMsRUFBRSxPQUFPLENBQUMsQ0FBQztBQUN6RixpQkFBUztBQUNULFlBQU0sQ0FBQztBQUNQO0FBQ2U7QUFBb0M7QUFDdEM7QUFDSTtBQUE4QjtBQUNqQjtBQUNiO0FBQWdCLFlBSjNCLFNBQVMsWUFBWSxDQUFDLFNBQVMsRUFBRSxJQUFJLEVBQUUsTUFBTSxFQUFFLEdBQUcsRUFBRSxPQUFPO0FBQ2pFO0FBQ0ksc0JBRFUsTUFBTSxHQUFHLElBQUk7QUFDM0I7QUFBaUMsc0JBQW5CLE9BQU8sR0FBRyxJQUFJLGVBQWUsQ0FBQyxJQUFJLENBQUM7QUFDakQ7QUFBaUMsc0JBQW5CLFNBQVMsR0FBRyxNQUFNLElBQUksRUFBRTtBQUN0QztBQUFpQyxzQkFBbkIsS0FBSyxHQUFHLElBQUksSUFBSSxJQUFJLENBQUMsTUFBTSxDQUFDLGlCQUFpQixDQUFDLEtBQUssQ0FBQztBQUNsRTtBQUFpQyxzQkFBbkIsUUFBUSxHQUFHLFVBQVUsQ0FBQyxRQUFRLENBQUMsSUFBSSxFQUFFLElBQUksQ0FBQztBQUN4RDtBQUNnQyxvQkFBcEIsT0FBTyxHQUFHLEdBQUcsSUFBSSxJQUFJO0FBQ2pDO0FBQ1E7QUFBaUMsc0JBQTNCLElBQUksR0FBRyxPQUFPLENBQUMsTUFBTSxDQUFDLGlCQUFpQixDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsU0FBUyxLQUFLLE1BQU0sQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLE1BQU0sQ0FBQyxpQkFBaUIsQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDO0FBQ2xJLGdCQUNRLElBQUksUUFBUSxDQUFDLE9BQU8sQ0FBQyxJQUFJLE1BQU0sQ0FBQyxpQkFBaUIsQ0FBQyxPQUFPLENBQUMsRUFBRTtBQUNwRSxvQkFBVSxPQUFPLEdBQUcsZ0JBQWdCLENBQUMsT0FBTyxDQUFDLENBQUM7QUFDOUMsaUJBQVM7QUFDVDtBQUFpQyxzQkFBbkIsT0FBTyxHQUFHLE1BQU0sQ0FBQyxzQkFBc0IsQ0FDM0MsT0FBTyxFQUNQLFNBQVMsRUFDVCxLQUFLLEVBQ0wsUUFBUSxFQUNSLE9BQU8sSUFBSSxFQUFFLEVBQ2IsU0FBUyxJQUFJLEVBQUUsRUFDZixJQUFJLENBQUMsTUFBTSxDQUFDLGlCQUFpQixDQUFDLFVBQVUsQ0FBQyxJQUFJLEVBQUUsQ0FDaEQ7QUFDVDtBQUVDLG9CQURXLFlBQVksR0FBRyxFQUFFO0FBQzdCLGdCQUFRLFlBQVksR0FBRyxNQUFNLENBQUMsYUFBYSxDQUFDLFlBQVksRUFBRSxLQUFLLEVBQUUsS0FBSyxFQUFFLE9BQU8sQ0FBQyxDQUFDO0FBQ2pGO0FBQ2dDLHNCQUFsQixVQUFVO0FBQVE7QUFDVjtBQUNsQjtBQUFvQixnQkFGRyxVQUFVLFFBQVE7QUFDN0M7QUFBcUMsMEJBQXJCLE9BQU8sR0FBRyxHQUFHLENBQUMsUUFBUSxFQUFFLE1BQU0sQ0FBQztBQUMvQztBQUFxQywwQkFBckIsVUFBVSxHQUFHLEdBQUcsQ0FBQyxRQUFRLEVBQUUsZUFBZSxDQUFDO0FBQzNEO0FBQ29DLDBCQUFwQixJQUFJLEdBQUcsYUFBYSxDQUFDLE9BQU8sRUFBRSxTQUFTLEVBQUUsS0FBSyxFQUFFLFFBQVEsRUFBRSxRQUFRLEVBQUUsT0FBTyxDQUFDO0FBQzVGLG9CQUNVLElBQUksSUFBSSxFQUFFO0FBQ3BCO0FBQ21CLDRCQURILElBQUk7QUFDcEIsd0JBQVksSUFBSSxJQUFJLEtBQUssTUFBTSxDQUFDLGNBQWMsRUFBRTtBQUNoRCw0QkFBYyxPQUFPLGNBQWMsQ0FBQyxPQUFPLEVBQUUsUUFBUSxFQUFFLElBQUksRUFBRSxZQUFZLENBQUMsQ0FBQztBQUMzRSx5QkFBYTtBQUNiLHdCQUNZLElBQUksU0FBUyxLQUFLLE1BQU0sSUFBSSxDQUFDLE1BQU0sQ0FBQyxNQUFNLENBQUMsaUJBQWlCLENBQUMscUJBQXFCLENBQUMsRUFBRTtBQUNqRyw0QkFBYyxJQUFJLEdBQUcsa0JBQWtCLENBQ3ZCLE1BQU0sQ0FBQyxNQUFNLENBQUMsaUJBQWlCLENBQUMsY0FBYyxDQUFDLEVBQy9DLElBQUksRUFDSixLQUFLLEVBQ0wsSUFBSSxFQUNKLElBQUksRUFDSixVQUFVLENBQ1gsQ0FBQztBQUNoQiw0QkFBYyxjQUFjLENBQUMsT0FBTyxFQUFFLFFBQVEsRUFBRSxJQUFJLEVBQUUsWUFBWSxDQUFDLENBQUM7QUFDcEUseUJBQWE7QUFBQyw2QkFBSztBQUNuQiw0QkFBYyxJQUFJLEdBQUcsa0JBQWtCLENBQ3ZCLE1BQU0sQ0FBQyxNQUFNLENBQUMsaUJBQWlCLENBQUMsY0FBYyxDQUFDLEVBQy9DLElBQUksRUFDSixNQUFNLENBQUMsTUFBTSxDQUFDLGlCQUFpQixDQUFDLEtBQUssQ0FBQyxFQUN0QyxJQUFJLEVBQ0osSUFBSSxFQUNKLFVBQVUsQ0FDWCxDQUFDO0FBQ2hCLDRCQUNjLElBQUksQ0FBQyxNQUFNLENBQUMsaUJBQWlCLENBQUMsU0FBUyxDQUFDLEdBQUcsTUFBTSxDQUFDLE1BQU0sQ0FBQyxpQkFBaUIsQ0FBQyxTQUFTLENBQUMsQ0FBQztBQUNwRyw0QkFBYyxjQUFjLENBQUMsT0FBTyxFQUFFLFFBQVEsRUFBRSxJQUFJLEVBQUUsWUFBWSxDQUFDLENBQUM7QUFDcEUseUJBQWE7QUFDYixxQkFDVztBQUFDLHlCQUFLO0FBQ2pCLHdCQUFZLGNBQWMsQ0FBQyxPQUFPLEVBQUUsUUFBUSxFQUFFLFNBQVMsRUFBRSxZQUFZLENBQUMsQ0FBQztBQUN2RSxxQkFBVztBQUNYLGdCQUFRLENBQUMsQ0FBQTtBQUNUO0FBQ2dDLHNCQUFsQixhQUFhO0FBQVE7QUFDYjtBQUErQjtBQUNqRCxnQkFGMEIsVUFBVSxRQUFRO0FBQ2hELG9CQUFVLElBQUksUUFBUSxDQUFDLE1BQU0sS0FBSyxHQUFHLElBQUksTUFBTSxDQUFDLE1BQU0sQ0FBQyxTQUFTLENBQUMsRUFBRTtBQUNuRSx3QkFBWSxjQUFjLENBQUMsT0FBTyxFQUFFLFFBQVEsRUFBRSxNQUFNLEVBQUUsWUFBWSxDQUFDLENBQUM7QUFDcEUscUJBQVc7QUFBQyx5QkFBSyxJQUFJLEtBQUssQ0FBQyxNQUFNLENBQUMsaUJBQWlCO0FBQU87QUFDckM7QUFBbUM7QUFFeEQsb0JBSHFELFVBQVUsRUFBTztBQUN0RSx3QkFBWSxPQUFPLEVBQUUsQ0FBQyxRQUFRLEVBQUUsT0FBTyxFQUFFLFVBQVUsQ0FBQyxLQUFLLEtBQUssQ0FBQztBQUMvRCxvQkFBVSxDQUFDLEVBQUMsRUFBRTtBQUNkLHdCQUFZLHlDQUF5QztBQUNyRCx3QkFBWSxPQUFPLENBQUMsS0FBSyxDQUFDLFFBQVEsQ0FBQyxDQUFDO0FBQ3BDLHFCQUFXO0FBQ1gsZ0JBQVEsQ0FBQyxDQUFBO0FBQ1Q7QUFDUTtBQUNOLG9CQURVLGFBQWEsR0FBRyxTQUFTO0FBQ3JDO0FBQWlDLG9CQUFyQixXQUFXLEdBQUcsTUFBTSxDQUFDLEVBQUUsRUFBRSxPQUFPLENBQUMsT0FBTyxDQUFDO0FBQ3JEO0FBQWlDLHNCQUFuQixtQkFBbUIsR0FBRyxNQUFNLENBQUMsaUJBQWlCLENBQUMsU0FBUyxDQUFDO0FBQ3ZFLGdCQUFRLElBQUksbUJBQW1CLEVBQUU7QUFDakMsb0JBQVUsYUFBYSxHQUFHLE1BQU0sQ0FBQztBQUNqQyxvQkFBVSxXQUFXLEdBQUcsTUFBTSxDQUFDLFdBQVcsRUFBRSxFQUFDLHdCQUF3QixFQUFFLFNBQVMsS0FBSyxRQUFRLENBQUMsQ0FBQyxDQUFDLFFBQVEsQ0FBQyxDQUFDLENBQUMsU0FBUyxDQUFDLFdBQVcsRUFBRSxFQUFDLENBQUMsQ0FBQztBQUNySSxpQkFBUztBQUFDLHFCQUFLLElBQUksTUFBTSxDQUFDLEtBQUssSUFBSSxhQUFhLEtBQUssS0FBSyxFQUFFO0FBQzVELG9CQUFVLGFBQWEsR0FBRyxPQUFPLENBQUM7QUFDbEMsaUJBQVM7QUFDVCxnQkFDUSxJQUFJLE1BQU0sQ0FBQyxNQUFNLENBQUMsU0FBUyxDQUFDLEVBQUU7QUFDdEMsb0JBQVUsSUFBSSxtQkFBbUIsRUFBRTtBQUNuQyx3QkFBWSxVQUFVLENBQUMsUUFBUSxDQUFDLElBQUksRUFBRSxLQUFLLEVBQUUsT0FBTyxDQUFDLFVBQVUsRUFBRSxXQUFXLEVBQUUsT0FBTyxDQUFDLE1BQU0sRUFDOUUsSUFBSSxFQUFFLElBQUksRUFBRSxhQUFhLENBQUMsQ0FBQyxhQUFhLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxTQUFTLENBQUMsVUFBVSxFQUFFLGFBQWEsQ0FBQyxDQUFDO0FBQ2pHLHFCQUFXO0FBQUMseUJBQUs7QUFDakIsd0JBQVksVUFBVSxDQUFDLFFBQVEsQ0FBQyxJQUFJLEVBQUUsS0FBSyxFQUFFLE9BQU8sQ0FBQyxVQUFVLEVBQUUsV0FBVyxFQUFFLE9BQU8sQ0FBQyxNQUFNLEVBQzlFLElBQUksRUFBRSxJQUFJLEVBQUUsYUFBYSxDQUFDLENBQUMsYUFBYSxDQUFDLEVBQUUsQ0FBQyxTQUFTLENBQUMsVUFBVSxFQUFFLGFBQWEsQ0FBQyxDQUFDO0FBQy9GLHFCQUFXO0FBQ1gsaUJBQVM7QUFBQyxxQkFBSztBQUNmLG9CQUFVLFVBQVUsQ0FBQyxRQUFRLENBQUMsSUFBSSxFQUFFLEtBQUssRUFBRSxPQUFPLENBQUMsVUFBVSxFQUFFLFdBQVcsRUFBRSxPQUFPLENBQUMsTUFBTSxFQUM5RSxJQUFJLEVBQUUsSUFBSSxFQUFFLGFBQWEsQ0FBQyxDQUFDLGFBQWEsQ0FBQyxDQUFDLE9BQU8sQ0FBQyxPQUFPLENBQUMsQ0FBQyxTQUFTLENBQUMsVUFBVSxFQUFFLGFBQWEsQ0FBQyxDQUFDO0FBQzVHLGlCQUFTO0FBQ1QsZ0JBQ1EsT0FBTyxzQkFBc0IsQ0FBQyxPQUFPLEVBQUUsS0FBSyxFQUFFLFlBQVksQ0FBQyxDQUFDO0FBQ3BFLFlBQU0sQ0FBQztBQUNQO0FBQ2U7QUFDYjtBQUFrQztBQUEyQjtBQUFnQixZQUR6RSxTQUFTLFdBQVcsQ0FBQyxNQUFNLEVBQUUsT0FBTztBQUMxQyxnQkFBUSxPQUFPLElBQUksQ0FBQyxZQUFZLEVBQUUsSUFBSSxDQUFDLENBQUMsS0FBSyxFQUFFLFNBQVMsRUFBRSxNQUFNLEVBQUUsU0FBUyxFQUFFLE9BQU8sQ0FBQyxDQUFDO0FBQ3RGLFlBQU0sQ0FBQztBQUNQO0FBQ2U7QUFBaUM7QUFDZjtBQUEyQjtBQUFnQixZQUR0RSxTQUFTLGNBQWMsQ0FBQyxNQUFNLEVBQUUsT0FBTztBQUM3QyxnQkFBUSxPQUFPLElBQUksQ0FBQyxZQUFZLEVBQUUsSUFBSSxDQUFDLENBQUMsUUFBUSxFQUFFLFNBQVMsRUFBRSxNQUFNLEVBQUUsU0FBUyxFQUFFLE9BQU8sQ0FBQyxDQUFDO0FBQ3pGLFlBQU0sQ0FBQztBQUNQO0FBQ2U7QUFDYjtBQUFrQztBQUEyQjtBQUFnQixZQUR6RSxTQUFTLFdBQVcsQ0FBQyxNQUFNLEVBQUUsT0FBTztBQUMxQyxnQkFBUSxPQUFPLElBQUksQ0FBQyxZQUFZLEVBQUUsSUFBSSxDQUFDLENBQUMsS0FBSyxFQUFFLFNBQVMsRUFBRSxNQUFNLEVBQUUsU0FBUyxFQUFFLE9BQU8sQ0FBQyxDQUFDO0FBQ3RGLFlBQU0sQ0FBQztBQUNQO0FBQ2U7QUFBK0I7QUFDNUI7QUFBaUM7QUFDNUM7QUFFa0I7QUFBZ0IsWUFKbkMsU0FBUyxZQUFZLENBQUMsSUFBSSxFQUFFLElBQUksRUFBRSxNQUFNLEVBQUUsT0FBTztBQUN2RCxnQkFBUSxPQUFPLElBQUksQ0FBQyxZQUFZLEVBQUUsSUFBSSxDQUFDLENBQUMsTUFBTSxFQUFFLElBQUksRUFBRSxNQUFNLEVBQUUsSUFBSSxFQUFFLE9BQU8sQ0FBQyxDQUFDO0FBQzdFLFlBQU0sQ0FBQztBQUNQO0FBQ2U7QUFDZDtBQUFrQztBQUEyQjtBQUFnQixZQUR4RSxTQUFTLFlBQVksQ0FBQyxNQUFNLEVBQUUsT0FBTztBQUMzQyxnQkFBUSxPQUFPLElBQUksQ0FBQyxZQUFZLEVBQUUsSUFBSSxDQUFDLENBQUMsTUFBTSxFQUFFLFNBQVMsRUFBRSxNQUFNLEVBQUUsU0FBUyxFQUFFLE9BQU8sQ0FBQyxDQUFDO0FBQ3ZGLFlBQU0sQ0FBQztBQUNQO0FBQ2U7QUFDZjtBQUFrQztBQUEyQjtBQUFnQixZQUR2RSxTQUFTLGFBQWEsQ0FBQyxNQUFNLEVBQUUsT0FBTztBQUM1QyxnQkFBUSxPQUFPLElBQUksQ0FBQyxZQUFZLEVBQUUsSUFBSSxDQUFDLENBQUMsT0FBTyxFQUFFLFNBQVMsRUFBRSxNQUFNLEVBQUUsU0FBUyxFQUFFLE9BQU8sQ0FBQyxDQUFDO0FBQ3hGLFlBQU0sQ0FBQztBQUNQO0FBQ2U7QUFBaUM7QUFDaEI7QUFBMkI7QUFBZ0IsWUFEckUsU0FBUyxlQUFlLENBQUMsTUFBTSxFQUFFLE9BQU87QUFDOUMsZ0JBQVEsT0FBTyxJQUFJLENBQUMsWUFBWSxFQUFFLElBQUksQ0FBQyxDQUFDLFNBQVMsRUFBRSxTQUFTLEVBQUUsTUFBTSxFQUFFLFNBQVMsRUFBRSxPQUFPLENBQUMsQ0FBQztBQUMxRixZQUFNLENBQUM7QUFDUDtBQUNlO0FBQStCO0FBQ3JCO0FBQWtDO0FBQ3pEO0FBRU8sWUFKSCxTQUFTLGFBQWEsQ0FBQyxJQUFJLEVBQUUsTUFBTSxFQUFFLE9BQU87QUFDbEQsZ0JBQVEsT0FBTyxJQUFJLENBQUMsWUFBWSxFQUFFLElBQUksQ0FBQyxDQUFDLE9BQU8sRUFBRSxTQUFTLEVBQUUsTUFBTSxFQUFFLElBQUksRUFBRSxPQUFPLENBQUMsQ0FBQztBQUNuRixZQUFNLENBQUM7QUFDUDtBQUNlO0FBQW9DO0FBQ3pDO0FBQWlDO0FBQWtDO0FBRzNEO0FBQTJCO0FBQWdCLFlBSnZELFNBQVMsY0FBYyxDQUFDLFNBQVMsRUFBRSxJQUFJLEVBQUUsTUFBTSxFQUFFLE9BQU8sRUFBRSxJQUFJO0FBQ3BFLGdCQUFRLE9BQU8sSUFBSSxDQUFDLFlBQVksRUFBRSxJQUFJLENBQUMsQ0FBQyxTQUFTLEVBQUUsSUFBSSxFQUFFLE1BQU0sRUFBRSxJQUFJLEVBQUUsT0FBTyxDQUFDLENBQUM7QUFDaEYsWUFBTSxDQUFDO0FBQ1A7QUFDZTtBQUErQjtBQUFvQztBQUNsRjtBQUNZO0FBQ0U7QUFBc0M7QUFFbEQ7QUFBZ0IsWUFMWixTQUFTLDRCQUE0QixDQUFDLElBQUksRUFBRSxTQUFTLEVBQUUsSUFBSSxFQUFFLGFBQWEsRUFBRSxjQUFjLEVBQUUsV0FBVztBQUM3RztBQUNLLG9CQURPLGNBQWM7QUFDMUIsZ0JBQVEsSUFBSSxTQUFTLEtBQUssU0FBUyxFQUFFO0FBQ3JDLG9CQUFVLGNBQWMsR0FBRyxJQUFJLENBQUMsYUFBYSxFQUFFLElBQUksRUFBRSxJQUFJLENBQUMsQ0FBQztBQUMzRCxpQkFBUztBQUFDLHFCQUFLO0FBQ2Ysb0JBQVUsY0FBYyxHQUFHLElBQUksQ0FBQyxjQUFjLEVBQUUsSUFBSSxFQUFFLFNBQVMsRUFBRSxJQUFJLENBQUMsQ0FBQztBQUN2RSxpQkFBUztBQUNUO0FBQ2dDLHNCQUFsQixlQUFlO0FBQVE7QUFDOUI7QUFDRjtBQUNPO0FBQ0M7QUFDSCxnQkFMc0IsVUFBVSxNQUFNLEVBQUUsT0FBTyxFQUFFLElBQUk7QUFDL0Q7QUFBcUMsMEJBQXJCLFVBQVUsR0FBRyxRQUFRLENBQUM7QUFDdEMsd0JBQVksTUFBTSxFQUFFLE1BQU07QUFDMUIsd0JBQVksT0FBTyxFQUFFLE9BQU87QUFDNUIsd0JBQVksSUFBSSxFQUFFLElBQUk7QUFDdEIscUJBQVcsRUFBRTtBQUNiLHdCQUFZLE1BQU0sRUFBRSxhQUFhO0FBQ2pDLHdCQUFZLE9BQU8sRUFBRSxjQUFjO0FBQ25DLHdCQUFZLElBQUksRUFBRSxXQUFXO0FBQzdCLHFCQUFXLENBQUM7QUFDWixvQkFBVSxPQUFPLGNBQWMsQ0FBQyxVQUFVLENBQUMsTUFBTSxFQUFFLFVBQVUsQ0FBQyxPQUFPLEVBQUUsVUFBVSxDQUFDLElBQUksQ0FBQyxDQUFDO0FBQ3hGLGdCQUFRLENBQUMsQ0FBQTtBQUNULGdCQUNRLElBQUksTUFBTSxDQUFDLE1BQU0sQ0FBQyxTQUFTLENBQUMsRUFBRTtBQUN0QyxvQkFBVSxJQUFJLENBQUMsSUFBSSxDQUFDLEdBQUcsZUFBZSxDQUFDO0FBQ3ZDLGlCQUFTO0FBQUMscUJBQUs7QUFDZixvQkFBVSxJQUFJLENBQUMsSUFBSSxDQUFDO0FBQVE7QUFDbkI7QUFBeUM7QUFLakQ7QUFBbUM7QUFDL0Isb0JBUGtCLFVBQVUsSUFBSSxFQUFFLE1BQU0sRUFBRSxPQUFPO0FBQ3RELHdCQUFZLE9BQU8sZUFBZSxDQUFDLE1BQU0sRUFBRSxPQUFPLEVBQUUsSUFBSSxDQUFDLENBQUM7QUFDMUQsb0JBQVUsQ0FBQyxDQUFBLENBQUM7QUFDWixpQkFBUztBQUNULFlBQU0sQ0FBQztBQUNQO0FBQ2U7QUFBcUM7QUFDNUI7QUFBZ0IsWUFEbEMsU0FBUyx5QkFBeUIsQ0FBQyxVQUFVO0FBQ25EO0FBQWlDLHNCQUFuQixTQUFTLEdBQUcsS0FBSyxDQUFDLElBQUksQ0FBQyxNQUFNLEVBQUUsZUFBZSxDQUFDLENBQUM7QUFDOUQsZ0JBQVEscUJBQXFCLENBQUMsU0FBUyxFQUFFLFNBQVMsQ0FBQyxDQUFDO0FBQ3BELGdCQUFRLFVBQVUsQ0FBQyxTQUFTLENBQUMsQ0FBQztBQUM5QixnQkFBUSxPQUFPLDZCQUE2QixDQUFDLFNBQVMsQ0FBQyxDQUFDO0FBQ3hELFlBQU0sQ0FBQztBQUNQO0FBQ2U7QUFDVjtBQUFpQztBQUEyQjtBQUN6RCxZQUZGLFNBQVMsU0FBUyxDQUFDLEtBQUssRUFBRSxNQUFNO0FBQ3RDO0FBQWlDLHNCQUFuQixzQkFBc0IsR0FBRyxNQUFNLENBQUMsTUFBTSxDQUFDLGlCQUFpQixDQUFDO0FBQ3ZFO0FBQ0csc0JBRFcsSUFBSSxHQUFRLEVBQUU7QUFDNUI7QUFBaUMsc0JBQW5CLFVBQVUsR0FBRyxDQUFDLE1BQU0sSUFBSSxPQUFPLENBQUMsQ0FBQyxHQUFHLENBQUMsS0FBSyxDQUFDO0FBQ3pELGdCQUFRLElBQUksQ0FBQyxHQUFHLEdBQUcsSUFBSSxDQUFDLEdBQUcsRUFBRSxDQUFDLE1BQU0sSUFBSSxPQUFPLENBQUMsRUFBRSxNQUFNLEVBQUUsS0FBSyxDQUFDLENBQUM7QUFDakUsZ0JBQVEsSUFBSSxDQUFDLEdBQUcsR0FBRyxJQUFJLENBQUMsVUFBVSxDQUFDLEdBQUcsRUFBRSxVQUFVLENBQUMsQ0FBQztBQUNwRCxnQkFBUSxJQUFJLENBQUMsSUFBSSxHQUFHLElBQUksQ0FBQyxVQUFVLENBQUMsSUFBSSxFQUFFLFVBQVUsQ0FBQyxDQUFDO0FBQ3RELGdCQUFRLElBQUksQ0FBQyxPQUFPLEdBQUcsSUFBSSxDQUFDLFVBQVUsQ0FBQyxPQUFPLEVBQUUsVUFBVSxDQUFDLENBQUM7QUFDNUQsZ0JBQVEsSUFBSSxDQUFDLGNBQWMsR0FBRyxJQUFJLENBQUMsVUFBVSxDQUFDLGNBQWMsRUFBRSxVQUFVLENBQUMsQ0FBQztBQUMxRSxnQkFBUSxJQUFJLENBQUMsR0FBRyxHQUFHLElBQUksQ0FBQyxVQUFVLENBQUMsR0FBRyxFQUFFLFVBQVUsQ0FBQyxDQUFDO0FBQ3BELGdCQUNRLEtBQUssTUFBTSxJQUFJLElBQUksVUFBVSxFQUFFO0FBQ3ZDLG9CQUFVLElBQUksVUFBVSxDQUFDLGNBQWMsQ0FBQyxJQUFJLENBQUMsSUFBSSxVQUFVLENBQUMsVUFBVSxDQUFDLElBQUksQ0FBQyxDQUFDLElBQUksQ0FBQyxRQUFRLENBQUMsc0JBQXNCLEVBQUUsSUFBSSxDQUFDLEVBQUU7QUFDMUgsd0JBQVksSUFBSSxDQUFDLElBQUksQ0FBQyxHQUFHLElBQUksQ0FBQyxVQUFVLENBQUMsSUFBSSxDQUFDLEVBQUUsVUFBVSxDQUFDLENBQUM7QUFDNUQscUJBQVc7QUFDWCxpQkFBUztBQUNULGdCQUNRLE9BQU8sSUFBSSxDQUFDO0FBQ3BCLFlBQU0sQ0FBQztBQUNQLFlBQ00scUJBQXFCLENBQUMsT0FBTyxFQUFFLE1BQU0sQ0FBQyxDQUFDO0FBQzdDLFlBQ00sT0FBTyxDQUFDLElBQUksR0FBRyxJQUFJLENBQUMsMEJBQTBCLEVBQUUsT0FBTyxDQUFDLENBQUM7QUFDL0QsWUFDTSxPQUFPLENBQUMsT0FBTyxHQUFHLElBQUksQ0FBQyxTQUFTLEVBQUUsT0FBTyxDQUFDLENBQUM7QUFDakQsWUFDTSxPQUFPLENBQUMsVUFBVSxHQUFHLElBQUksQ0FBQyx5QkFBeUIsRUFBRSxPQUFPLENBQUMsQ0FBQztBQUNwRSxZQUNNLE9BQU8sQ0FBQyxHQUFHLEdBQUcsSUFBSSxDQUFDLEdBQUcsRUFBRSxPQUFPLEVBQUUsSUFBSSxDQUFDLENBQUM7QUFDN0MsWUFDTSxPQUFPLENBQUMsR0FBRyxHQUFHLElBQUksQ0FBQyxHQUFHLEVBQUUsT0FBTyxFQUFFLElBQUksQ0FBQyxDQUFDO0FBQzdDLFlBQ00sT0FBTyxDQUFDLE9BQU8sR0FBRyxJQUFJLENBQUMsT0FBTyxFQUFFLE9BQU8sRUFBRSxJQUFJLENBQUMsQ0FBQztBQUNyRCxZQUNNLE9BQU8sQ0FBQyxNQUFNLEdBQUcsSUFBSSxDQUFDLE1BQU0sRUFBRSxPQUFPLEVBQUUsSUFBSSxDQUFDLENBQUM7QUFDbkQsWUFDTSxPQUFPLENBQUMsTUFBTSxHQUFHLElBQUksQ0FBQyxNQUFNLEVBQUUsT0FBTyxFQUFFLElBQUksQ0FBQyxDQUFDO0FBQ25ELFlBQ00sT0FBTyxDQUFDLGdCQUFnQixHQUFHLElBQUksQ0FBQyxnQkFBZ0IsRUFBRSxPQUFPLENBQUMsQ0FBQztBQUNqRSxZQUNNLE9BQU8sQ0FBQyxxQkFBcUIsR0FBRyxJQUFJLENBQUMsa0JBQWtCLEVBQUUsT0FBTyxDQUFDLENBQUM7QUFDeEUsWUFDTSxPQUFPLENBQUMsd0JBQXdCLEdBQUcsSUFBSSxDQUFDLG1DQUFtQyxFQUFFLE9BQU8sQ0FBQyxDQUFDO0FBQzVGLFlBQ00sT0FBTyxPQUFPLENBQUM7QUFDckIsUUFBSSxDQUFDO0FBQ0wsUUFDSSxPQUFPLDZCQUE2QixDQUFDLG1CQUFtQixDQUFDLENBQUM7QUFDOUQsSUFBRSxDQUFDO0FBRUgsQ0FBQztBQUNEIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgSW5qZWN0YWJsZSwgSW5qZWN0LCBJbmplY3RvciwgT3B0aW9uYWwsIFR5cGUgfSBmcm9tICdAYW5ndWxhci9jb3JlJztcbmltcG9ydCB7IGFzc2lnbiB9IGZyb20gJ2NvcmUtanMvZmVhdHVyZXMvb2JqZWN0JztcbmltcG9ydCB7XG4gIG1hcCxcbiAgYmluZCxcbiAgdW5pb24sXG4gIHZhbHVlcyxcbiAgcGljayxcbiAgaXNFbXB0eSxcbiAgaXNGdW5jdGlvbixcbiAgaXNOdW1iZXIsXG4gIGlzVW5kZWZpbmVkLFxuICBpc0FycmF5LFxuICBpc09iamVjdCxcbiAgZXh0ZW5kLFxuICBlYWNoLFxuICBldmVyeSxcbiAgb21pdCxcbiAgZ2V0LFxuICBkZWZhdWx0cyxcbiAgY2xvbmUsXG4gIGluY2x1ZGVzXG59IGZyb20gJ2xvZGFzaCc7XG5cbmltcG9ydCB7IEJlaGF2aW9yU3ViamVjdCB9IGZyb20gJ3J4anMnO1xuaW1wb3J0IHsgZmlsdGVyIH0gZnJvbSAncnhqcy9vcGVyYXRvcnMnO1xuXG5pbXBvcnQgeyBSRVNUQU5HVUxBUiB9IGZyb20gJy4vbmd4LXJlc3Rhbmd1bGFyLmNvbmZpZyc7XG5pbXBvcnQgeyBSZXN0YW5ndWxhckh0dHAgfSBmcm9tICcuL25neC1yZXN0YW5ndWxhci1odHRwJztcbmltcG9ydCB7IFJlc3Rhbmd1bGFyQ29uZmlndXJlciB9IGZyb20gJy4vbmd4LXJlc3Rhbmd1bGFyLWNvbmZpZy5mYWN0b3J5JztcblxuQEluamVjdGFibGUoKVxuZXhwb3J0IGNsYXNzIFJlc3Rhbmd1bGFyIHtcbiAgcHJvdmlkZXI6IHtcbiAgICBzZXRCYXNlVXJsOiBhbnksXG4gICAgc2V0RGVmYXVsdEhlYWRlcnM6IGFueSxcbiAgICBjb25maWd1cmF0aW9uOiBhbnksXG4gICAgc2V0U2VsZkxpbmtBYnNvbHV0ZVVybDogYW55LFxuICAgIHNldEV4dHJhRmllbGRzOiBhbnksXG4gICAgc2V0RGVmYXVsdEh0dHBGaWVsZHM6IGFueSxcbiAgICBzZXRQbGFpbkJ5RGVmYXVsdDogYW55LFxuICAgIHNldEVuY29kZUlkczogYW55LFxuICAgIHNldERlZmF1bHRSZXF1ZXN0UGFyYW1zOiBhbnksXG4gICAgcmVxdWVzdFBhcmFtczogYW55LFxuICAgIGRlZmF1bHRIZWFkZXJzOiBhbnksXG4gICAgc2V0RGVmYXVsdFJlc3BvbnNlTWV0aG9kOiBhbnksXG4gICAgZGVmYXVsdFJlc3BvbnNlTWV0aG9kOiBhbnksXG4gICAgc2V0TWV0aG9kT3ZlcnJpZGVyczogYW55LFxuICAgIHNldEpzb25wOiBhbnksXG4gICAgc2V0VXJsQ3JlYXRvcjogYW55LFxuICAgIHNldFJlc3Rhbmd1bGFyRmllbGRzOiBhbnksXG4gICAgc2V0VXNlQ2Fubm9uaWNhbElkOiBhbnksXG4gICAgYWRkUmVzcG9uc2VJbnRlcmNlcHRvcjogYW55LFxuICAgIGFkZEVycm9ySW50ZXJjZXB0b3I6IGFueSxcbiAgICBzZXRSZXNwb25zZUludGVyY2VwdG9yOiBhbnksXG4gICAgc2V0UmVzcG9uc2VFeHRyYWN0b3I6IGFueSxcbiAgICBzZXRFcnJvckludGVyY2VwdG9yOiBhbnksXG4gICAgYWRkUmVxdWVzdEludGVyY2VwdG9yOiBhbnksXG4gICAgc2V0UmVxdWVzdEludGVyY2VwdG9yOiBhbnksXG4gICAgc2V0RnVsbFJlcXVlc3RJbnRlcmNlcHRvcjogYW55LFxuICAgIGFkZEZ1bGxSZXF1ZXN0SW50ZXJjZXB0b3I6IGFueSxcbiAgICBzZXRPbkJlZm9yZUVsZW1SZXN0YW5ndWxhcml6ZWQ6IGFueSxcbiAgICBzZXRSZXN0YW5ndWxhcml6ZVByb21pc2VJbnRlcmNlcHRvcjogYW55LFxuICAgIHNldE9uRWxlbVJlc3Rhbmd1bGFyaXplZDogYW55LFxuICAgIHNldFBhcmVudGxlc3M6IGFueSxcbiAgICBzZXRSZXF1ZXN0U3VmZml4OiBhbnksXG4gICAgYWRkRWxlbWVudFRyYW5zZm9ybWVyOiBhbnksXG4gICAgZXh0ZW5kQ29sbGVjdGlvbjogYW55LFxuICAgIGV4dGVuZE1vZGVsOiBhbnksXG4gICAgc2V0VHJhbnNmb3JtT25seVNlcnZlckVsZW1lbnRzOiBhbnksXG4gICAgc2V0RnVsbFJlc3BvbnNlOiBhbnksXG4gICAgJGdldDogYW55XG4gIH07XG4gIGFkZEVsZW1lbnRUcmFuc2Zvcm1lcjogYW55O1xuICBleHRlbmRDb2xsZWN0aW9uOiBhbnk7XG4gIGV4dGVuZE1vZGVsOiBhbnk7XG4gIGNvcHk7XG4gIGNvbmZpZ3VyYXRpb247XG4gIHNlcnZpY2U7XG4gIGlkO1xuICByb3V0ZTtcbiAgcGFyZW50UmVzb3VyY2U7XG4gIHJlc3Rhbmd1bGFyQ29sbGVjdGlvbjtcbiAgY2Fubm9uaWNhbElkO1xuICBldGFnO1xuICBzZWxmTGluaztcbiAgZ2V0O1xuICBnZXRMaXN0O1xuICBwdXQ7XG4gIHBvc3Q7XG4gIHJlbW92ZTtcbiAgaGVhZDtcbiAgdHJhY2U7XG4gIG9wdGlvbnM7XG4gIHBhdGNoO1xuICBnZXRSZXN0YW5ndWxhclVybDtcbiAgZ2V0UmVxdWVzdGVkVXJsO1xuICBwdXRFbGVtZW50O1xuICBhZGRSZXN0YW5ndWxhck1ldGhvZDtcbiAgZ2V0UGFyZW50TGlzdDtcbiAgY2xvbmU7XG4gIGlkcztcbiAgaHR0cENvbmZpZztcbiAgcmVxUGFyYW1zO1xuICBvbmU7XG4gIGFsbDtcbiAgc2V2ZXJhbDtcbiAgb25lVXJsO1xuICBhbGxVcmw7XG4gIGN1c3RvbVBVVDtcbiAgY3VzdG9tUEFUQ0g7XG4gIGN1c3RvbVBPU1Q7XG4gIGN1c3RvbURFTEVURTtcbiAgY3VzdG9tR0VUO1xuICBjdXN0b21HRVRMSVNUO1xuICBjdXN0b21PcGVyYXRpb247XG4gIGRvUFVUO1xuICBkb1BBVENIO1xuICBkb1BPU1Q7XG4gIGRvREVMRVRFO1xuICBkb0dFVDtcbiAgZG9HRVRMSVNUO1xuICBmcm9tU2VydmVyO1xuICB3aXRoQ29uZmlnO1xuICB3aXRoSHR0cENvbmZpZztcbiAgc2luZ2xlT25lO1xuICBwbGFpbjtcbiAgc2F2ZTtcbiAgcmVzdGFuZ3VsYXJpemVkO1xuICByZXN0YW5ndWxhcml6ZUVsZW1lbnQ7XG4gIHJlc3Rhbmd1bGFyaXplQ29sbGVjdGlvbjtcblxuICBjb25zdHJ1Y3RvcihcbiAgICBAT3B0aW9uYWwoKSBASW5qZWN0KFJFU1RBTkdVTEFSKSBwdWJsaWMgY29uZmlnT2JqLFxuICAgIHByaXZhdGUgaW5qZWN0b3I6IEluamVjdG9yLFxuICAgIHByaXZhdGUgaHR0cDogUmVzdGFuZ3VsYXJIdHRwXG4gICkge1xuICAgIHRoaXMucHJvdmlkZXIgPSBuZXcgcHJvdmlkZXJDb25maWcoaHR0cCk7XG4gICAgY29uc3QgZWxlbWVudCA9IHRoaXMucHJvdmlkZXIuJGdldCgpO1xuICAgIGFzc2lnbih0aGlzLCBlbGVtZW50KTtcblxuICAgIHRoaXMuc2V0RGVmYXVsdENvbmZpZygpO1xuICB9XG5cbiAgc2V0RGVmYXVsdENvbmZpZygpIHtcbiAgICBpZiAoIXRoaXMuY29uZmlnT2JqIHx8ICFpc0Z1bmN0aW9uKHRoaXMuY29uZmlnT2JqLmZuKSkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIGNvbnN0IGFyckRJID0gbWFwKHRoaXMuY29uZmlnT2JqLmFyclNlcnZpY2VzLCAoc2VydmljZXM6IFR5cGU8YW55PikgPT4ge1xuICAgICAgcmV0dXJuIHRoaXMuaW5qZWN0b3IuZ2V0KHNlcnZpY2VzKTtcbiAgICB9KTtcblxuICAgIHRoaXMuY29uZmlnT2JqLmZuKC4uLlt0aGlzLnByb3ZpZGVyLCAuLi5hcnJESV0pO1xuICB9XG59XG5cbmZ1bmN0aW9uIHByb3ZpZGVyQ29uZmlnKCRodHRwKSB7XG4gIGNvbnN0IGdsb2JhbENvbmZpZ3VyYXRpb24gPSB7fTtcblxuICBSZXN0YW5ndWxhckNvbmZpZ3VyZXIodGhpcywgZ2xvYmFsQ29uZmlndXJhdGlvbik7XG5cbiAgdGhpcy4kZ2V0ID0gJGdldDtcblxuICBmdW5jdGlvbiAkZ2V0KCkge1xuXG4gICAgZnVuY3Rpb24gY3JlYXRlU2VydmljZUZvckNvbmZpZ3VyYXRpb24oY29uZmlnKSB7XG4gICAgICBjb25zdCBzZXJ2aWNlOiBhbnkgPSB7fTtcblxuICAgICAgY29uc3QgdXJsSGFuZGxlciA9IG5ldyBjb25maWcudXJsQ3JlYXRvckZhY3RvcnlbY29uZmlnLnVybENyZWF0b3JdKCk7XG4gICAgICB1cmxIYW5kbGVyLnNldENvbmZpZyhjb25maWcpO1xuXG4gICAgICBmdW5jdGlvbiByZXN0YW5ndWxhcml6ZUJhc2UocGFyZW50LCBlbGVtLCByb3V0ZSwgcmVxUGFyYW1zLCBmcm9tU2VydmVyKSB7XG4gICAgICAgIGVsZW1bY29uZmlnLnJlc3Rhbmd1bGFyRmllbGRzLnJvdXRlXSA9IHJvdXRlO1xuICAgICAgICBlbGVtW2NvbmZpZy5yZXN0YW5ndWxhckZpZWxkcy5nZXRSZXN0YW5ndWxhclVybF0gPSBiaW5kKHVybEhhbmRsZXIuZmV0Y2hVcmwsIHVybEhhbmRsZXIsIGVsZW0pO1xuICAgICAgICBlbGVtW2NvbmZpZy5yZXN0YW5ndWxhckZpZWxkcy5nZXRSZXF1ZXN0ZWRVcmxdID0gYmluZCh1cmxIYW5kbGVyLmZldGNoUmVxdWVzdGVkVXJsLCB1cmxIYW5kbGVyLCBlbGVtKTtcbiAgICAgICAgZWxlbVtjb25maWcucmVzdGFuZ3VsYXJGaWVsZHMuYWRkUmVzdGFuZ3VsYXJNZXRob2RdID0gYmluZChhZGRSZXN0YW5ndWxhck1ldGhvZEZ1bmN0aW9uLCBlbGVtKTtcbiAgICAgICAgZWxlbVtjb25maWcucmVzdGFuZ3VsYXJGaWVsZHMuY2xvbmVdID0gYmluZChjb3B5UmVzdGFuZ3VsYXJpemVkRWxlbWVudCwgZWxlbSk7XG4gICAgICAgIGVsZW1bY29uZmlnLnJlc3Rhbmd1bGFyRmllbGRzLnJlcVBhcmFtc10gPSBpc0VtcHR5KHJlcVBhcmFtcykgPyBudWxsIDogcmVxUGFyYW1zO1xuICAgICAgICBlbGVtW2NvbmZpZy5yZXN0YW5ndWxhckZpZWxkcy53aXRoSHR0cENvbmZpZ10gPSBiaW5kKHdpdGhIdHRwQ29uZmlnLCBlbGVtKTtcbiAgICAgICAgZWxlbVtjb25maWcucmVzdGFuZ3VsYXJGaWVsZHMucGxhaW5dID0gYmluZChzdHJpcFJlc3Rhbmd1bGFyLCBlbGVtLCBlbGVtKTtcblxuICAgICAgICAvLyBUYWcgZWxlbWVudCBhcyByZXN0YW5ndWxhcml6ZWRcbiAgICAgICAgZWxlbVtjb25maWcucmVzdGFuZ3VsYXJGaWVsZHMucmVzdGFuZ3VsYXJpemVkXSA9IHRydWU7XG5cbiAgICAgICAgLy8gUmVxdWVzdExlc3MgY29ubmVjdGlvblxuICAgICAgICBlbGVtW2NvbmZpZy5yZXN0YW5ndWxhckZpZWxkcy5vbmVdID0gYmluZChvbmUsIGVsZW0sIGVsZW0pO1xuICAgICAgICBlbGVtW2NvbmZpZy5yZXN0YW5ndWxhckZpZWxkcy5hbGxdID0gYmluZChhbGwsIGVsZW0sIGVsZW0pO1xuICAgICAgICBlbGVtW2NvbmZpZy5yZXN0YW5ndWxhckZpZWxkcy5zZXZlcmFsXSA9IGJpbmQoc2V2ZXJhbCwgZWxlbSwgZWxlbSk7XG4gICAgICAgIGVsZW1bY29uZmlnLnJlc3Rhbmd1bGFyRmllbGRzLm9uZVVybF0gPSBiaW5kKG9uZVVybCwgZWxlbSwgZWxlbSk7XG4gICAgICAgIGVsZW1bY29uZmlnLnJlc3Rhbmd1bGFyRmllbGRzLmFsbFVybF0gPSBiaW5kKGFsbFVybCwgZWxlbSwgZWxlbSk7XG5cbiAgICAgICAgZWxlbVtjb25maWcucmVzdGFuZ3VsYXJGaWVsZHMuZnJvbVNlcnZlcl0gPSAhIWZyb21TZXJ2ZXI7XG5cbiAgICAgICAgaWYgKHBhcmVudCAmJiBjb25maWcuc2hvdWxkU2F2ZVBhcmVudChyb3V0ZSkpIHtcbiAgICAgICAgICBjb25zdCBwYXJlbnRJZCA9IGNvbmZpZy5nZXRJZEZyb21FbGVtKHBhcmVudCk7XG4gICAgICAgICAgY29uc3QgcGFyZW50VXJsID0gY29uZmlnLmdldFVybEZyb21FbGVtKHBhcmVudCk7XG5cbiAgICAgICAgICBjb25zdCByZXN0YW5ndWxhckZpZWxkc0ZvclBhcmVudCA9IHVuaW9uKFxuICAgICAgICAgICAgdmFsdWVzKHBpY2soY29uZmlnLnJlc3Rhbmd1bGFyRmllbGRzLCBbJ3JvdXRlJywgJ3NpbmdsZU9uZScsICdwYXJlbnRSZXNvdXJjZSddKSksXG4gICAgICAgICAgICBjb25maWcuZXh0cmFGaWVsZHNcbiAgICAgICAgICApO1xuICAgICAgICAgIGNvbnN0IHBhcmVudFJlc291cmNlID0gcGljayhwYXJlbnQsIHJlc3Rhbmd1bGFyRmllbGRzRm9yUGFyZW50KTtcblxuICAgICAgICAgIGlmIChjb25maWcuaXNWYWxpZElkKHBhcmVudElkKSkge1xuICAgICAgICAgICAgY29uZmlnLnNldElkVG9FbGVtKHBhcmVudFJlc291cmNlLCBwYXJlbnRJZCwgcm91dGUpO1xuICAgICAgICAgIH1cbiAgICAgICAgICBpZiAoY29uZmlnLmlzVmFsaWRJZChwYXJlbnRVcmwpKSB7XG4gICAgICAgICAgICBjb25maWcuc2V0VXJsVG9FbGVtKHBhcmVudFJlc291cmNlLCBwYXJlbnRVcmwsIHJvdXRlKTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBlbGVtW2NvbmZpZy5yZXN0YW5ndWxhckZpZWxkcy5wYXJlbnRSZXNvdXJjZV0gPSBwYXJlbnRSZXNvdXJjZTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBlbGVtW2NvbmZpZy5yZXN0YW5ndWxhckZpZWxkcy5wYXJlbnRSZXNvdXJjZV0gPSBudWxsO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBlbGVtO1xuICAgICAgfVxuXG4gICAgICBmdW5jdGlvbiBvbmUocGFyZW50LCByb3V0ZSwgaWQsIHNpbmdsZU9uZSkge1xuICAgICAgICBsZXQgZXJyb3I7XG4gICAgICAgIGlmIChpc051bWJlcihyb3V0ZSkgfHwgaXNOdW1iZXIocGFyZW50KSkge1xuICAgICAgICAgIGVycm9yID0gJ1lvdVxcJ3JlIGNyZWF0aW5nIGEgUmVzdGFuZ3VsYXIgZW50aXR5IHdpdGggdGhlIG51bWJlciAnO1xuICAgICAgICAgIGVycm9yICs9ICdpbnN0ZWFkIG9mIHRoZSByb3V0ZSBvciB0aGUgcGFyZW50LiBGb3IgZXhhbXBsZSwgeW91IGNhblxcJ3QgY2FsbCAub25lKDEyKS4nO1xuICAgICAgICAgIHRocm93IG5ldyBFcnJvcihlcnJvcik7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGlzVW5kZWZpbmVkKHJvdXRlKSkge1xuICAgICAgICAgIGVycm9yID0gJ1lvdVxcJ3JlIGNyZWF0aW5nIGEgUmVzdGFuZ3VsYXIgZW50aXR5IGVpdGhlciB3aXRob3V0IHRoZSBwYXRoLiAnO1xuICAgICAgICAgIGVycm9yICs9ICdGb3IgZXhhbXBsZSB5b3UgY2FuXFwndCBjYWxsIC5vbmUoKS4gUGxlYXNlIGNoZWNrIGlmIHlvdXIgYXJndW1lbnRzIGFyZSB2YWxpZC4nO1xuICAgICAgICAgIHRocm93IG5ldyBFcnJvcihlcnJvcik7XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgZWxlbSA9IHt9O1xuICAgICAgICBjb25maWcuc2V0SWRUb0VsZW0oZWxlbSwgaWQsIHJvdXRlKTtcbiAgICAgICAgY29uZmlnLnNldEZpZWxkVG9FbGVtKGNvbmZpZy5yZXN0YW5ndWxhckZpZWxkcy5zaW5nbGVPbmUsIGVsZW0sIHNpbmdsZU9uZSk7XG4gICAgICAgIHJldHVybiByZXN0YW5ndWxhcml6ZUVsZW0ocGFyZW50LCBlbGVtLCByb3V0ZSwgZmFsc2UpO1xuICAgICAgfVxuXG4gICAgICBmdW5jdGlvbiBhbGwocGFyZW50LCByb3V0ZSkge1xuICAgICAgICByZXR1cm4gcmVzdGFuZ3VsYXJpemVDb2xsZWN0aW9uKHBhcmVudCwgW10sIHJvdXRlLCBmYWxzZSk7XG4gICAgICB9XG5cbiAgICAgIGZ1bmN0aW9uIHNldmVyYWwocGFyZW50LCByb3V0ZSAvKiwgaWRzICovKSB7XG4gICAgICAgIGNvbnN0IGNvbGxlY3Rpb24gPSBbXTtcbiAgICAgICAgY29sbGVjdGlvbltjb25maWcucmVzdGFuZ3VsYXJGaWVsZHMuaWRzXSA9IEFycmF5LnByb3RvdHlwZS5zcGxpY2UuY2FsbChhcmd1bWVudHMsIDIpO1xuICAgICAgICByZXR1cm4gcmVzdGFuZ3VsYXJpemVDb2xsZWN0aW9uKHBhcmVudCwgY29sbGVjdGlvbiwgcm91dGUsIGZhbHNlKTtcbiAgICAgIH1cblxuICAgICAgZnVuY3Rpb24gb25lVXJsKHBhcmVudCwgcm91dGUsIHVybCkge1xuICAgICAgICBpZiAoIXJvdXRlKSB7XG4gICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdSb3V0ZSBpcyBtYW5kYXRvcnkgd2hlbiBjcmVhdGluZyBuZXcgUmVzdGFuZ3VsYXIgb2JqZWN0cy4nKTtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBlbGVtID0ge307XG4gICAgICAgIGNvbmZpZy5zZXRVcmxUb0VsZW0oZWxlbSwgdXJsLCByb3V0ZSk7XG4gICAgICAgIHJldHVybiByZXN0YW5ndWxhcml6ZUVsZW0ocGFyZW50LCBlbGVtLCByb3V0ZSwgZmFsc2UpO1xuICAgICAgfVxuXG4gICAgICBmdW5jdGlvbiBhbGxVcmwocGFyZW50LCByb3V0ZSwgdXJsKSB7XG4gICAgICAgIGlmICghcm91dGUpIHtcbiAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ1JvdXRlIGlzIG1hbmRhdG9yeSB3aGVuIGNyZWF0aW5nIG5ldyBSZXN0YW5ndWxhciBvYmplY3RzLicpO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IGVsZW0gPSB7fTtcbiAgICAgICAgY29uZmlnLnNldFVybFRvRWxlbShlbGVtLCB1cmwsIHJvdXRlKTtcbiAgICAgICAgcmV0dXJuIHJlc3Rhbmd1bGFyaXplQ29sbGVjdGlvbihwYXJlbnQsIGVsZW0sIHJvdXRlLCBmYWxzZSk7XG4gICAgICB9XG5cbiAgICAgIC8vIFByb21pc2VzXG4gICAgICBmdW5jdGlvbiByZXN0YW5ndWxhcml6ZVJlc3BvbnNlKHN1YmplY3QsIGlzQ29sbGVjdGlvbiwgdmFsdWVUb0ZpbGwpIHtcbiAgICAgICAgcmV0dXJuIHN1YmplY3QucGlwZShmaWx0ZXIocmVzID0+ICEhcmVzKSk7XG4gICAgICB9XG5cbiAgICAgIGZ1bmN0aW9uIHJlc29sdmVQcm9taXNlKHN1YmplY3QsIHJlc3BvbnNlLCBkYXRhLCBmaWxsZWRWYWx1ZSkge1xuICAgICAgICBleHRlbmQoZmlsbGVkVmFsdWUsIGRhdGEpO1xuXG4gICAgICAgIC8vIFRyaWdnZXIgdGhlIGZ1bGwgcmVzcG9uc2UgaW50ZXJjZXB0b3IuXG4gICAgICAgIGlmIChjb25maWcuZnVsbFJlc3BvbnNlKSB7XG4gICAgICAgICAgc3ViamVjdC5uZXh0KGV4dGVuZChyZXNwb25zZSwge1xuICAgICAgICAgICAgZGF0YTogZGF0YVxuICAgICAgICAgIH0pKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBzdWJqZWN0Lm5leHQoZGF0YSk7XG4gICAgICAgIH1cblxuICAgICAgICBzdWJqZWN0LmNvbXBsZXRlKCk7XG4gICAgICB9XG5cbiAgICAgIC8vIEVsZW1lbnRzXG4gICAgICBmdW5jdGlvbiBzdHJpcFJlc3Rhbmd1bGFyKGVsZW0pIHtcbiAgICAgICAgaWYgKGlzQXJyYXkoZWxlbSkpIHtcbiAgICAgICAgICBjb25zdCBhcnJheSA9IFtdO1xuICAgICAgICAgIGVhY2goZWxlbSwgZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgICAgICBhcnJheS5wdXNoKGNvbmZpZy5pc1Jlc3Rhbmd1bGFyaXplZCh2YWx1ZSkgPyBzdHJpcFJlc3Rhbmd1bGFyKHZhbHVlKSA6IHZhbHVlKTtcbiAgICAgICAgICB9KTtcbiAgICAgICAgICByZXR1cm4gYXJyYXk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgcmV0dXJuIG9taXQoZWxlbSwgdmFsdWVzKG9taXQoY29uZmlnLnJlc3Rhbmd1bGFyRmllbGRzLCAnaWQnKSkpO1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIGZ1bmN0aW9uIGFkZEN1c3RvbU9wZXJhdGlvbihlbGVtKSB7XG4gICAgICAgIGVsZW1bY29uZmlnLnJlc3Rhbmd1bGFyRmllbGRzLmN1c3RvbU9wZXJhdGlvbl0gPSBiaW5kKGN1c3RvbUZ1bmN0aW9uLCBlbGVtKTtcbiAgICAgICAgY29uc3QgcmVxdWVzdE1ldGhvZHMgPSB7Z2V0OiBjdXN0b21GdW5jdGlvbiwgZGVsZXRlOiBjdXN0b21GdW5jdGlvbn07XG4gICAgICAgIGVhY2goWydwdXQnLCAncGF0Y2gnLCAncG9zdCddLCBmdW5jdGlvbiAobmFtZSkge1xuICAgICAgICAgIHJlcXVlc3RNZXRob2RzW25hbWVdID0gZnVuY3Rpb24gKG9wZXJhdGlvbiwgZWxlbWVudCwgcGF0aCwgcGFyYW1zLCBoZWFkZXJzKSB7XG4gICAgICAgICAgICByZXR1cm4gYmluZChjdXN0b21GdW5jdGlvbiwgdGhpcykob3BlcmF0aW9uLCBwYXRoLCBwYXJhbXMsIGhlYWRlcnMsIGVsZW1lbnQpO1xuICAgICAgICAgIH07XG4gICAgICAgIH0pO1xuICAgICAgICBlYWNoKHJlcXVlc3RNZXRob2RzLCBmdW5jdGlvbiAocmVxdWVzdEZ1bmMsIG5hbWUpIHtcbiAgICAgICAgICBjb25zdCBjYWxsT3BlcmF0aW9uID0gbmFtZSA9PT0gJ2RlbGV0ZScgPyAncmVtb3ZlJyA6IG5hbWU7XG4gICAgICAgICAgZWFjaChbJ2RvJywgJ2N1c3RvbSddLCBmdW5jdGlvbiAoYWxpYXMpIHtcbiAgICAgICAgICAgIGVsZW1bYWxpYXMgKyBuYW1lLnRvVXBwZXJDYXNlKCldID0gYmluZChyZXF1ZXN0RnVuYywgZWxlbSwgY2FsbE9wZXJhdGlvbik7XG4gICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgICAgICBlbGVtW2NvbmZpZy5yZXN0YW5ndWxhckZpZWxkcy5jdXN0b21HRVRMSVNUXSA9IGJpbmQoZmV0Y2hGdW5jdGlvbiwgZWxlbSk7XG4gICAgICAgIGVsZW1bY29uZmlnLnJlc3Rhbmd1bGFyRmllbGRzLmRvR0VUTElTVF0gPSBlbGVtW2NvbmZpZy5yZXN0YW5ndWxhckZpZWxkcy5jdXN0b21HRVRMSVNUXTtcbiAgICAgIH1cblxuICAgICAgZnVuY3Rpb24gY29weVJlc3Rhbmd1bGFyaXplZEVsZW1lbnQoZnJvbUVsZW1lbnQsIHRvRWxlbWVudCA9IHt9KSB7XG4gICAgICAgIGNvbnN0IGNvcGllZEVsZW1lbnQgPSBhc3NpZ24odG9FbGVtZW50LCBmcm9tRWxlbWVudCk7XG4gICAgICAgIHJldHVybiByZXN0YW5ndWxhcml6ZUVsZW0oY29waWVkRWxlbWVudFtjb25maWcucmVzdGFuZ3VsYXJGaWVsZHMucGFyZW50UmVzb3VyY2VdLFxuICAgICAgICAgIGNvcGllZEVsZW1lbnQsIGNvcGllZEVsZW1lbnRbY29uZmlnLnJlc3Rhbmd1bGFyRmllbGRzLnJvdXRlXSwgdHJ1ZSk7XG4gICAgICB9XG5cbiAgICAgIGZ1bmN0aW9uIHJlc3Rhbmd1bGFyaXplRWxlbShwYXJlbnQsIGVsZW1lbnQsIHJvdXRlLCBmcm9tU2VydmVyPywgY29sbGVjdGlvbj8sIHJlcVBhcmFtcz8pIHtcbiAgICAgICAgY29uc3QgZWxlbSA9IGNvbmZpZy5vbkJlZm9yZUVsZW1SZXN0YW5ndWxhcml6ZWQoZWxlbWVudCwgZmFsc2UsIHJvdXRlKTtcblxuICAgICAgICBjb25zdCBsb2NhbEVsZW0gPSByZXN0YW5ndWxhcml6ZUJhc2UocGFyZW50LCBlbGVtLCByb3V0ZSwgcmVxUGFyYW1zLCBmcm9tU2VydmVyKTtcblxuICAgICAgICBpZiAoY29uZmlnLnVzZUNhbm5vbmljYWxJZCkge1xuICAgICAgICAgIGxvY2FsRWxlbVtjb25maWcucmVzdGFuZ3VsYXJGaWVsZHMuY2Fubm9uaWNhbElkXSA9IGNvbmZpZy5nZXRJZEZyb21FbGVtKGxvY2FsRWxlbSk7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoY29sbGVjdGlvbikge1xuICAgICAgICAgIGxvY2FsRWxlbVtjb25maWcucmVzdGFuZ3VsYXJGaWVsZHMuZ2V0UGFyZW50TGlzdF0gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gY29sbGVjdGlvbjtcbiAgICAgICAgICB9O1xuICAgICAgICB9XG5cbiAgICAgICAgbG9jYWxFbGVtW2NvbmZpZy5yZXN0YW5ndWxhckZpZWxkcy5yZXN0YW5ndWxhckNvbGxlY3Rpb25dID0gZmFsc2U7XG4gICAgICAgIGxvY2FsRWxlbVtjb25maWcucmVzdGFuZ3VsYXJGaWVsZHMuZ2V0XSA9IGJpbmQoZ2V0RnVuY3Rpb24sIGxvY2FsRWxlbSk7XG4gICAgICAgIGxvY2FsRWxlbVtjb25maWcucmVzdGFuZ3VsYXJGaWVsZHMuZ2V0TGlzdF0gPSBiaW5kKGZldGNoRnVuY3Rpb24sIGxvY2FsRWxlbSk7XG4gICAgICAgIGxvY2FsRWxlbVtjb25maWcucmVzdGFuZ3VsYXJGaWVsZHMucHV0XSA9IGJpbmQocHV0RnVuY3Rpb24sIGxvY2FsRWxlbSk7XG4gICAgICAgIGxvY2FsRWxlbVtjb25maWcucmVzdGFuZ3VsYXJGaWVsZHMucG9zdF0gPSBiaW5kKHBvc3RGdW5jdGlvbiwgbG9jYWxFbGVtKTtcbiAgICAgICAgbG9jYWxFbGVtW2NvbmZpZy5yZXN0YW5ndWxhckZpZWxkcy5yZW1vdmVdID0gYmluZChkZWxldGVGdW5jdGlvbiwgbG9jYWxFbGVtKTtcbiAgICAgICAgbG9jYWxFbGVtW2NvbmZpZy5yZXN0YW5ndWxhckZpZWxkcy5oZWFkXSA9IGJpbmQoaGVhZEZ1bmN0aW9uLCBsb2NhbEVsZW0pO1xuICAgICAgICBsb2NhbEVsZW1bY29uZmlnLnJlc3Rhbmd1bGFyRmllbGRzLnRyYWNlXSA9IGJpbmQodHJhY2VGdW5jdGlvbiwgbG9jYWxFbGVtKTtcbiAgICAgICAgbG9jYWxFbGVtW2NvbmZpZy5yZXN0YW5ndWxhckZpZWxkcy5vcHRpb25zXSA9IGJpbmQob3B0aW9uc0Z1bmN0aW9uLCBsb2NhbEVsZW0pO1xuICAgICAgICBsb2NhbEVsZW1bY29uZmlnLnJlc3Rhbmd1bGFyRmllbGRzLnBhdGNoXSA9IGJpbmQocGF0Y2hGdW5jdGlvbiwgbG9jYWxFbGVtKTtcbiAgICAgICAgbG9jYWxFbGVtW2NvbmZpZy5yZXN0YW5ndWxhckZpZWxkcy5zYXZlXSA9IGJpbmQoc2F2ZSwgbG9jYWxFbGVtKTtcblxuICAgICAgICBhZGRDdXN0b21PcGVyYXRpb24obG9jYWxFbGVtKTtcbiAgICAgICAgcmV0dXJuIGNvbmZpZy50cmFuc2Zvcm1FbGVtKGxvY2FsRWxlbSwgZmFsc2UsIHJvdXRlLCBzZXJ2aWNlLCB0cnVlKTtcbiAgICAgIH1cblxuICAgICAgZnVuY3Rpb24gcmVzdGFuZ3VsYXJpemVDb2xsZWN0aW9uKHBhcmVudCwgZWxlbWVudCwgcm91dGUsIGZyb21TZXJ2ZXI/LCByZXFQYXJhbXM/KSB7XG4gICAgICAgIGNvbnN0IGVsZW0gPSBjb25maWcub25CZWZvcmVFbGVtUmVzdGFuZ3VsYXJpemVkKGVsZW1lbnQsIHRydWUsIHJvdXRlKTtcblxuICAgICAgICBjb25zdCBsb2NhbEVsZW0gPSByZXN0YW5ndWxhcml6ZUJhc2UocGFyZW50LCBlbGVtLCByb3V0ZSwgcmVxUGFyYW1zLCBmcm9tU2VydmVyKTtcbiAgICAgICAgbG9jYWxFbGVtW2NvbmZpZy5yZXN0YW5ndWxhckZpZWxkcy5yZXN0YW5ndWxhckNvbGxlY3Rpb25dID0gdHJ1ZTtcbiAgICAgICAgbG9jYWxFbGVtW2NvbmZpZy5yZXN0YW5ndWxhckZpZWxkcy5wb3N0XSA9IGJpbmQocG9zdEZ1bmN0aW9uLCBsb2NhbEVsZW0sIG51bGwpO1xuICAgICAgICBsb2NhbEVsZW1bY29uZmlnLnJlc3Rhbmd1bGFyRmllbGRzLnJlbW92ZV0gPSBiaW5kKGRlbGV0ZUZ1bmN0aW9uLCBsb2NhbEVsZW0pO1xuICAgICAgICBsb2NhbEVsZW1bY29uZmlnLnJlc3Rhbmd1bGFyRmllbGRzLmhlYWRdID0gYmluZChoZWFkRnVuY3Rpb24sIGxvY2FsRWxlbSk7XG4gICAgICAgIGxvY2FsRWxlbVtjb25maWcucmVzdGFuZ3VsYXJGaWVsZHMudHJhY2VdID0gYmluZCh0cmFjZUZ1bmN0aW9uLCBsb2NhbEVsZW0pO1xuICAgICAgICBsb2NhbEVsZW1bY29uZmlnLnJlc3Rhbmd1bGFyRmllbGRzLnB1dEVsZW1lbnRdID0gYmluZChwdXRFbGVtZW50RnVuY3Rpb24sIGxvY2FsRWxlbSk7XG4gICAgICAgIGxvY2FsRWxlbVtjb25maWcucmVzdGFuZ3VsYXJGaWVsZHMub3B0aW9uc10gPSBiaW5kKG9wdGlvbnNGdW5jdGlvbiwgbG9jYWxFbGVtKTtcbiAgICAgICAgbG9jYWxFbGVtW2NvbmZpZy5yZXN0YW5ndWxhckZpZWxkcy5wYXRjaF0gPSBiaW5kKHBhdGNoRnVuY3Rpb24sIGxvY2FsRWxlbSk7XG4gICAgICAgIGxvY2FsRWxlbVtjb25maWcucmVzdGFuZ3VsYXJGaWVsZHMuZ2V0XSA9IGJpbmQoZ2V0QnlJZCwgbG9jYWxFbGVtKTtcbiAgICAgICAgbG9jYWxFbGVtW2NvbmZpZy5yZXN0YW5ndWxhckZpZWxkcy5nZXRMaXN0XSA9IGJpbmQoZmV0Y2hGdW5jdGlvbiwgbG9jYWxFbGVtLCBudWxsKTtcblxuICAgICAgICBhZGRDdXN0b21PcGVyYXRpb24obG9jYWxFbGVtKTtcbiAgICAgICAgcmV0dXJuIGNvbmZpZy50cmFuc2Zvcm1FbGVtKGxvY2FsRWxlbSwgdHJ1ZSwgcm91dGUsIHNlcnZpY2UsIHRydWUpO1xuICAgICAgfVxuXG4gICAgICBmdW5jdGlvbiByZXN0YW5ndWxhcml6ZUNvbGxlY3Rpb25BbmRFbGVtZW50cyhwYXJlbnQsIGVsZW1lbnQsIHJvdXRlKSB7XG4gICAgICAgIGNvbnN0IGNvbGxlY3Rpb24gPSByZXN0YW5ndWxhcml6ZUNvbGxlY3Rpb24ocGFyZW50LCBlbGVtZW50LCByb3V0ZSwgZmFsc2UpO1xuICAgICAgICBlYWNoKGNvbGxlY3Rpb24sIGZ1bmN0aW9uIChlbGVtKSB7XG4gICAgICAgICAgaWYgKGVsZW0pIHtcbiAgICAgICAgICAgIHJlc3Rhbmd1bGFyaXplRWxlbShwYXJlbnQsIGVsZW0sIHJvdXRlLCBmYWxzZSk7XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIGNvbGxlY3Rpb247XG4gICAgICB9XG5cbiAgICAgIGZ1bmN0aW9uIGdldEJ5SWQoaWQsIHJlcVBhcmFtcywgaGVhZGVycykge1xuICAgICAgICByZXR1cm4gdGhpcy5jdXN0b21HRVQoaWQudG9TdHJpbmcoKSwgcmVxUGFyYW1zLCBoZWFkZXJzKTtcbiAgICAgIH1cblxuICAgICAgZnVuY3Rpb24gcHV0RWxlbWVudEZ1bmN0aW9uKGlkeCwgcGFyYW1zLCBoZWFkZXJzKSB7XG4gICAgICAgIGNvbnN0IF9fdGhpcyA9IHRoaXM7XG4gICAgICAgIGNvbnN0IGVsZW1Ub1B1dCA9IHRoaXNbaWR4XTtcbiAgICAgICAgY29uc3Qgc3ViamVjdCA9IG5ldyBCZWhhdmlvclN1YmplY3QobnVsbCk7XG4gICAgICAgIGxldCBmaWxsZWRBcnJheSA9IFtdO1xuICAgICAgICBmaWxsZWRBcnJheSA9IGNvbmZpZy50cmFuc2Zvcm1FbGVtKGZpbGxlZEFycmF5LCB0cnVlLCBlbGVtVG9QdXRbY29uZmlnLnJlc3Rhbmd1bGFyRmllbGRzLnJvdXRlXSwgc2VydmljZSk7XG5cbiAgICAgICAgZWxlbVRvUHV0LnB1dChwYXJhbXMsIGhlYWRlcnMpXG4gICAgICAgIC5zdWJzY3JpYmUoZnVuY3Rpb24gKHNlcnZlckVsZW0pIHtcbiAgICAgICAgICBjb25zdCBuZXdBcnJheSA9IGNvcHlSZXN0YW5ndWxhcml6ZWRFbGVtZW50KF9fdGhpcyk7XG4gICAgICAgICAgbmV3QXJyYXlbaWR4XSA9IHNlcnZlckVsZW07XG4gICAgICAgICAgZmlsbGVkQXJyYXkgPSBuZXdBcnJheTtcbiAgICAgICAgICBzdWJqZWN0Lm5leHQobmV3QXJyYXkpO1xuICAgICAgICB9LCBmdW5jdGlvbiAocmVzcG9uc2UpIHtcbiAgICAgICAgICBzdWJqZWN0LmVycm9yKHJlc3BvbnNlKTtcbiAgICAgICAgfSwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgIHN1YmplY3QuY29tcGxldGUoKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgcmV0dXJuIHJlc3Rhbmd1bGFyaXplUmVzcG9uc2Uoc3ViamVjdCwgdHJ1ZSwgZmlsbGVkQXJyYXkpO1xuICAgICAgfVxuXG4gICAgICBmdW5jdGlvbiBwYXJzZVJlc3BvbnNlKHJlc0RhdGEsIG9wZXJhdGlvbiwgcm91dGUsIGZldGNoVXJsLCByZXNwb25zZSwgc3ViamVjdCkge1xuICAgICAgICBjb25zdCBkYXRhID0gY29uZmlnLnJlc3BvbnNlRXh0cmFjdG9yKHJlc0RhdGEsIG9wZXJhdGlvbiwgcm91dGUsIGZldGNoVXJsLCByZXNwb25zZSwgc3ViamVjdCk7XG4gICAgICAgIGNvbnN0IGV0YWcgPSByZXNwb25zZS5oZWFkZXJzLmdldCgnRVRhZycpO1xuICAgICAgICBpZiAoZGF0YSAmJiBldGFnKSB7XG4gICAgICAgICAgZGF0YVtjb25maWcucmVzdGFuZ3VsYXJGaWVsZHMuZXRhZ10gPSBldGFnO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBkYXRhO1xuICAgICAgfVxuXG4gICAgICBmdW5jdGlvbiBmZXRjaEZ1bmN0aW9uKHdoYXQsIHJlcVBhcmFtcywgaGVhZGVycykge1xuICAgICAgICBjb25zdCBfX3RoaXMgPSB0aGlzO1xuICAgICAgICBjb25zdCBzdWJqZWN0ID0gbmV3IEJlaGF2aW9yU3ViamVjdChudWxsKTtcbiAgICAgICAgY29uc3Qgb3BlcmF0aW9uID0gJ2dldExpc3QnO1xuICAgICAgICBjb25zdCB1cmwgPSB1cmxIYW5kbGVyLmZldGNoVXJsKHRoaXMsIHdoYXQpO1xuICAgICAgICBjb25zdCB3aGF0RmV0Y2hlZCA9IHdoYXQgfHwgX190aGlzW2NvbmZpZy5yZXN0YW5ndWxhckZpZWxkcy5yb3V0ZV07XG5cbiAgICAgICAgY29uc3QgcmVxdWVzdCA9IGNvbmZpZy5mdWxsUmVxdWVzdEludGVyY2VwdG9yKG51bGwsIG9wZXJhdGlvbixcbiAgICAgICAgICB3aGF0RmV0Y2hlZCwgdXJsLCBoZWFkZXJzIHx8IHt9LCByZXFQYXJhbXMgfHwge30sIHRoaXNbY29uZmlnLnJlc3Rhbmd1bGFyRmllbGRzLmh0dHBDb25maWddIHx8IHt9KTtcblxuICAgICAgICBsZXQgZmlsbGVkQXJyYXkgPSBbXTtcbiAgICAgICAgZmlsbGVkQXJyYXkgPSBjb25maWcudHJhbnNmb3JtRWxlbShmaWxsZWRBcnJheSwgdHJ1ZSwgd2hhdEZldGNoZWQsIHNlcnZpY2UpO1xuXG4gICAgICAgIGxldCBtZXRob2QgPSAnZ2V0TGlzdCc7XG5cbiAgICAgICAgaWYgKGNvbmZpZy5qc29ucCkge1xuICAgICAgICAgIG1ldGhvZCA9ICdqc29ucCc7XG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCBva0NhbGxiYWNrID0gZnVuY3Rpb24gKHJlc3BvbnNlKSB7XG4gICAgICAgICAgY29uc3QgcmVzRGF0YSA9IHJlc3BvbnNlLmJvZHk7XG4gICAgICAgICAgY29uc3QgZnVsbFBhcmFtcyA9IHJlc3BvbnNlLmNvbmZpZy5wYXJhbXM7XG4gICAgICAgICAgbGV0IGRhdGEgPSBwYXJzZVJlc3BvbnNlKHJlc0RhdGEsIG9wZXJhdGlvbiwgd2hhdEZldGNoZWQsIHVybCwgcmVzcG9uc2UsIHN1YmplY3QpO1xuXG4gICAgICAgICAgLy8gc3VwcG9ydCBlbXB0eSByZXNwb25zZSBmb3IgZ2V0TGlzdCgpIGNhbGxzIChzb21lIEFQSXMgcmVzcG9uZCB3aXRoIDIwNCBhbmQgZW1wdHkgYm9keSlcbiAgICAgICAgICBpZiAoaXNVbmRlZmluZWQoZGF0YSkgfHwgJycgPT09IGRhdGEpIHtcbiAgICAgICAgICAgIGRhdGEgPSBbXTtcbiAgICAgICAgICB9XG4gICAgICAgICAgaWYgKCFpc0FycmF5KGRhdGEpKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ1Jlc3BvbnNlIGZvciBnZXRMaXN0IFNIT1VMRCBiZSBhbiBhcnJheSBhbmQgbm90IGFuIG9iamVjdCBvciBzb21ldGhpbmcgZWxzZScpO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIGlmICh0cnVlID09PSBjb25maWcucGxhaW5CeURlZmF1bHQpIHtcbiAgICAgICAgICAgIHJldHVybiByZXNvbHZlUHJvbWlzZShzdWJqZWN0LCByZXNwb25zZSwgZGF0YSwgZmlsbGVkQXJyYXkpO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIGxldCBwcm9jZXNzZWREYXRhID0gbWFwKGRhdGEsIGZ1bmN0aW9uIChlbGVtKSB7XG4gICAgICAgICAgICBpZiAoIV9fdGhpc1tjb25maWcucmVzdGFuZ3VsYXJGaWVsZHMucmVzdGFuZ3VsYXJDb2xsZWN0aW9uXSkge1xuICAgICAgICAgICAgICByZXR1cm4gcmVzdGFuZ3VsYXJpemVFbGVtKF9fdGhpcywgZWxlbSwgd2hhdCwgdHJ1ZSwgZGF0YSk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICByZXR1cm4gcmVzdGFuZ3VsYXJpemVFbGVtKF9fdGhpc1tjb25maWcucmVzdGFuZ3VsYXJGaWVsZHMucGFyZW50UmVzb3VyY2VdLFxuICAgICAgICAgICAgICAgIGVsZW0sIF9fdGhpc1tjb25maWcucmVzdGFuZ3VsYXJGaWVsZHMucm91dGVdLCB0cnVlLCBkYXRhKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9KTtcblxuICAgICAgICAgIHByb2Nlc3NlZERhdGEgPSBleHRlbmQoZGF0YSwgcHJvY2Vzc2VkRGF0YSk7XG5cbiAgICAgICAgICBpZiAoIV9fdGhpc1tjb25maWcucmVzdGFuZ3VsYXJGaWVsZHMucmVzdGFuZ3VsYXJDb2xsZWN0aW9uXSkge1xuICAgICAgICAgICAgcmVzb2x2ZVByb21pc2UoXG4gICAgICAgICAgICAgIHN1YmplY3QsXG4gICAgICAgICAgICAgIHJlc3BvbnNlLFxuICAgICAgICAgICAgICByZXN0YW5ndWxhcml6ZUNvbGxlY3Rpb24oXG4gICAgICAgICAgICAgICAgX190aGlzLFxuICAgICAgICAgICAgICAgIHByb2Nlc3NlZERhdGEsXG4gICAgICAgICAgICAgICAgd2hhdCxcbiAgICAgICAgICAgICAgICB0cnVlLFxuICAgICAgICAgICAgICAgIGZ1bGxQYXJhbXNcbiAgICAgICAgICAgICAgKSxcbiAgICAgICAgICAgICAgZmlsbGVkQXJyYXlcbiAgICAgICAgICAgICk7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHJlc29sdmVQcm9taXNlKFxuICAgICAgICAgICAgICBzdWJqZWN0LFxuICAgICAgICAgICAgICByZXNwb25zZSxcbiAgICAgICAgICAgICAgcmVzdGFuZ3VsYXJpemVDb2xsZWN0aW9uKFxuICAgICAgICAgICAgICAgIF9fdGhpc1tjb25maWcucmVzdGFuZ3VsYXJGaWVsZHMucGFyZW50UmVzb3VyY2VdLFxuICAgICAgICAgICAgICAgIHByb2Nlc3NlZERhdGEsXG4gICAgICAgICAgICAgICAgX190aGlzW2NvbmZpZy5yZXN0YW5ndWxhckZpZWxkcy5yb3V0ZV0sXG4gICAgICAgICAgICAgICAgdHJ1ZSxcbiAgICAgICAgICAgICAgICBmdWxsUGFyYW1zXG4gICAgICAgICAgICAgICksXG4gICAgICAgICAgICAgIGZpbGxlZEFycmF5XG4gICAgICAgICAgICApO1xuICAgICAgICAgIH1cbiAgICAgICAgfTtcblxuICAgICAgICB1cmxIYW5kbGVyLnJlc291cmNlKHRoaXMsICRodHRwLCByZXF1ZXN0Lmh0dHBDb25maWcsIHJlcXVlc3QuaGVhZGVycywgcmVxdWVzdC5wYXJhbXMsIHdoYXQsXG4gICAgICAgICAgdGhpc1tjb25maWcucmVzdGFuZ3VsYXJGaWVsZHMuZXRhZ10sIG9wZXJhdGlvbilbbWV0aG9kXSgpXG4gICAgICAgIC5zdWJzY3JpYmUob2tDYWxsYmFjaywgZnVuY3Rpb24gZXJyb3IocmVzcG9uc2UpIHtcbiAgICAgICAgICBpZiAocmVzcG9uc2Uuc3RhdHVzID09PSAzMDQgJiYgX190aGlzW2NvbmZpZy5yZXN0YW5ndWxhckZpZWxkcy5yZXN0YW5ndWxhckNvbGxlY3Rpb25dKSB7XG4gICAgICAgICAgICByZXNvbHZlUHJvbWlzZShzdWJqZWN0LCByZXNwb25zZSwgX190aGlzLCBmaWxsZWRBcnJheSk7XG4gICAgICAgICAgfSBlbHNlIGlmIChldmVyeShjb25maWcuZXJyb3JJbnRlcmNlcHRvcnMsIGZ1bmN0aW9uIChjYjogYW55KSB7XG5cbiAgICAgICAgICAgIHJldHVybiBjYihyZXNwb25zZSwgc3ViamVjdCwgb2tDYWxsYmFjaykgIT09IGZhbHNlO1xuICAgICAgICAgIH0pKSB7XG4gICAgICAgICAgICAvLyB0cmlnZ2VyZWQgaWYgbm8gY2FsbGJhY2sgcmV0dXJucyBmYWxzZVxuICAgICAgICAgICAgc3ViamVjdC5lcnJvcihyZXNwb25zZSk7XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcblxuICAgICAgICByZXR1cm4gcmVzdGFuZ3VsYXJpemVSZXNwb25zZShzdWJqZWN0LCB0cnVlLCBmaWxsZWRBcnJheSk7XG4gICAgICB9XG5cbiAgICAgIGZ1bmN0aW9uIHdpdGhIdHRwQ29uZmlnKGh0dHBDb25maWcpIHtcbiAgICAgICAgdGhpc1tjb25maWcucmVzdGFuZ3VsYXJGaWVsZHMuaHR0cENvbmZpZ10gPSBodHRwQ29uZmlnO1xuICAgICAgICByZXR1cm4gdGhpcztcbiAgICAgIH1cblxuICAgICAgZnVuY3Rpb24gc2F2ZShwYXJhbXMsIGhlYWRlcnMpIHtcbiAgICAgICAgaWYgKHRoaXNbY29uZmlnLnJlc3Rhbmd1bGFyRmllbGRzLmZyb21TZXJ2ZXJdKSB7XG4gICAgICAgICAgcmV0dXJuIHRoaXNbY29uZmlnLnJlc3Rhbmd1bGFyRmllbGRzLnB1dF0ocGFyYW1zLCBoZWFkZXJzKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICByZXR1cm4gYmluZChlbGVtRnVuY3Rpb24sIHRoaXMpKCdwb3N0JywgdW5kZWZpbmVkLCBwYXJhbXMsIHVuZGVmaW5lZCwgaGVhZGVycyk7XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgZnVuY3Rpb24gZWxlbUZ1bmN0aW9uKG9wZXJhdGlvbiwgd2hhdCwgcGFyYW1zLCBvYmosIGhlYWRlcnMpIHtcbiAgICAgICAgY29uc3QgX190aGlzID0gdGhpcztcbiAgICAgICAgY29uc3Qgc3ViamVjdCA9IG5ldyBCZWhhdmlvclN1YmplY3QobnVsbCk7XG4gICAgICAgIGNvbnN0IHJlc1BhcmFtcyA9IHBhcmFtcyB8fCB7fTtcbiAgICAgICAgY29uc3Qgcm91dGUgPSB3aGF0IHx8IHRoaXNbY29uZmlnLnJlc3Rhbmd1bGFyRmllbGRzLnJvdXRlXTtcbiAgICAgICAgY29uc3QgZmV0Y2hVcmwgPSB1cmxIYW5kbGVyLmZldGNoVXJsKHRoaXMsIHdoYXQpO1xuXG4gICAgICAgIGxldCBjYWxsT2JqID0gb2JqIHx8IHRoaXM7XG4gICAgICAgIC8vIGZhbGxiYWNrIHRvIGV0YWcgb24gcmVzdGFuZ3VsYXIgb2JqZWN0IChzaW5jZSBmb3IgY3VzdG9tIG1ldGhvZHMgd2UgcHJvYmFibHkgZG9uJ3QgZXhwbGljaXRseSBzcGVjaWZ5IHRoZSBldGFnIGZpZWxkKVxuICAgICAgICBjb25zdCBldGFnID0gY2FsbE9ialtjb25maWcucmVzdGFuZ3VsYXJGaWVsZHMuZXRhZ10gfHwgKG9wZXJhdGlvbiAhPT0gJ3Bvc3QnID8gdGhpc1tjb25maWcucmVzdGFuZ3VsYXJGaWVsZHMuZXRhZ10gOiBudWxsKTtcblxuICAgICAgICBpZiAoaXNPYmplY3QoY2FsbE9iaikgJiYgY29uZmlnLmlzUmVzdGFuZ3VsYXJpemVkKGNhbGxPYmopKSB7XG4gICAgICAgICAgY2FsbE9iaiA9IHN0cmlwUmVzdGFuZ3VsYXIoY2FsbE9iaik7XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgcmVxdWVzdCA9IGNvbmZpZy5mdWxsUmVxdWVzdEludGVyY2VwdG9yKFxuICAgICAgICAgIGNhbGxPYmosXG4gICAgICAgICAgb3BlcmF0aW9uLFxuICAgICAgICAgIHJvdXRlLFxuICAgICAgICAgIGZldGNoVXJsLFxuICAgICAgICAgIGhlYWRlcnMgfHwge30sXG4gICAgICAgICAgcmVzUGFyYW1zIHx8IHt9LFxuICAgICAgICAgIHRoaXNbY29uZmlnLnJlc3Rhbmd1bGFyRmllbGRzLmh0dHBDb25maWddIHx8IHt9XG4gICAgICAgICk7XG5cbiAgICAgICAgbGV0IGZpbGxlZE9iamVjdCA9IHt9O1xuICAgICAgICBmaWxsZWRPYmplY3QgPSBjb25maWcudHJhbnNmb3JtRWxlbShmaWxsZWRPYmplY3QsIGZhbHNlLCByb3V0ZSwgc2VydmljZSk7XG5cbiAgICAgICAgY29uc3Qgb2tDYWxsYmFjayA9IGZ1bmN0aW9uIChyZXNwb25zZSkge1xuICAgICAgICAgIGNvbnN0IHJlc0RhdGEgPSBnZXQocmVzcG9uc2UsICdib2R5Jyk7XG4gICAgICAgICAgY29uc3QgZnVsbFBhcmFtcyA9IGdldChyZXNwb25zZSwgJ2NvbmZpZy5wYXJhbXMnKTtcblxuICAgICAgICAgIGNvbnN0IGVsZW0gPSBwYXJzZVJlc3BvbnNlKHJlc0RhdGEsIG9wZXJhdGlvbiwgcm91dGUsIGZldGNoVXJsLCByZXNwb25zZSwgc3ViamVjdCk7XG5cbiAgICAgICAgICBpZiAoZWxlbSkge1xuICAgICAgICAgICAgbGV0IGRhdGE7XG4gICAgICAgICAgICBpZiAodHJ1ZSA9PT0gY29uZmlnLnBsYWluQnlEZWZhdWx0KSB7XG4gICAgICAgICAgICAgIHJldHVybiByZXNvbHZlUHJvbWlzZShzdWJqZWN0LCByZXNwb25zZSwgZWxlbSwgZmlsbGVkT2JqZWN0KTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKG9wZXJhdGlvbiA9PT0gJ3Bvc3QnICYmICFfX3RoaXNbY29uZmlnLnJlc3Rhbmd1bGFyRmllbGRzLnJlc3Rhbmd1bGFyQ29sbGVjdGlvbl0pIHtcbiAgICAgICAgICAgICAgZGF0YSA9IHJlc3Rhbmd1bGFyaXplRWxlbShcbiAgICAgICAgICAgICAgICBfX3RoaXNbY29uZmlnLnJlc3Rhbmd1bGFyRmllbGRzLnBhcmVudFJlc291cmNlXSxcbiAgICAgICAgICAgICAgICBlbGVtLFxuICAgICAgICAgICAgICAgIHJvdXRlLFxuICAgICAgICAgICAgICAgIHRydWUsXG4gICAgICAgICAgICAgICAgbnVsbCxcbiAgICAgICAgICAgICAgICBmdWxsUGFyYW1zXG4gICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgIHJlc29sdmVQcm9taXNlKHN1YmplY3QsIHJlc3BvbnNlLCBkYXRhLCBmaWxsZWRPYmplY3QpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgZGF0YSA9IHJlc3Rhbmd1bGFyaXplRWxlbShcbiAgICAgICAgICAgICAgICBfX3RoaXNbY29uZmlnLnJlc3Rhbmd1bGFyRmllbGRzLnBhcmVudFJlc291cmNlXSxcbiAgICAgICAgICAgICAgICBlbGVtLFxuICAgICAgICAgICAgICAgIF9fdGhpc1tjb25maWcucmVzdGFuZ3VsYXJGaWVsZHMucm91dGVdLFxuICAgICAgICAgICAgICAgIHRydWUsXG4gICAgICAgICAgICAgICAgbnVsbCxcbiAgICAgICAgICAgICAgICBmdWxsUGFyYW1zXG4gICAgICAgICAgICAgICk7XG5cbiAgICAgICAgICAgICAgZGF0YVtjb25maWcucmVzdGFuZ3VsYXJGaWVsZHMuc2luZ2xlT25lXSA9IF9fdGhpc1tjb25maWcucmVzdGFuZ3VsYXJGaWVsZHMuc2luZ2xlT25lXTtcbiAgICAgICAgICAgICAgcmVzb2x2ZVByb21pc2Uoc3ViamVjdCwgcmVzcG9uc2UsIGRhdGEsIGZpbGxlZE9iamVjdCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcmVzb2x2ZVByb21pc2Uoc3ViamVjdCwgcmVzcG9uc2UsIHVuZGVmaW5lZCwgZmlsbGVkT2JqZWN0KTtcbiAgICAgICAgICB9XG4gICAgICAgIH07XG5cbiAgICAgICAgY29uc3QgZXJyb3JDYWxsYmFjayA9IGZ1bmN0aW9uIChyZXNwb25zZSkge1xuICAgICAgICAgIGlmIChyZXNwb25zZS5zdGF0dXMgPT09IDMwNCAmJiBjb25maWcuaXNTYWZlKG9wZXJhdGlvbikpIHtcbiAgICAgICAgICAgIHJlc29sdmVQcm9taXNlKHN1YmplY3QsIHJlc3BvbnNlLCBfX3RoaXMsIGZpbGxlZE9iamVjdCk7XG4gICAgICAgICAgfSBlbHNlIGlmIChldmVyeShjb25maWcuZXJyb3JJbnRlcmNlcHRvcnMsIGZ1bmN0aW9uIChjYjogYW55KSB7XG4gICAgICAgICAgICByZXR1cm4gY2IocmVzcG9uc2UsIHN1YmplY3QsIG9rQ2FsbGJhY2spICE9PSBmYWxzZTtcbiAgICAgICAgICB9KSkge1xuICAgICAgICAgICAgLy8gdHJpZ2dlcmVkIGlmIG5vIGNhbGxiYWNrIHJldHVybnMgZmFsc2VcbiAgICAgICAgICAgIHN1YmplY3QuZXJyb3IocmVzcG9uc2UpO1xuICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgLy8gT3ZlcnJpZGluZyBIVFRQIE1ldGhvZFxuICAgICAgICBsZXQgY2FsbE9wZXJhdGlvbiA9IG9wZXJhdGlvbjtcbiAgICAgICAgbGV0IGNhbGxIZWFkZXJzID0gZXh0ZW5kKHt9LCByZXF1ZXN0LmhlYWRlcnMpO1xuICAgICAgICBjb25zdCBpc092ZXJyaWRlT3BlcmF0aW9uID0gY29uZmlnLmlzT3ZlcnJpZGVuTWV0aG9kKG9wZXJhdGlvbik7XG4gICAgICAgIGlmIChpc092ZXJyaWRlT3BlcmF0aW9uKSB7XG4gICAgICAgICAgY2FsbE9wZXJhdGlvbiA9ICdwb3N0JztcbiAgICAgICAgICBjYWxsSGVhZGVycyA9IGV4dGVuZChjYWxsSGVhZGVycywgeydYLUhUVFAtTWV0aG9kLU92ZXJyaWRlJzogb3BlcmF0aW9uID09PSAncmVtb3ZlJyA/ICdERUxFVEUnIDogb3BlcmF0aW9uLnRvVXBwZXJDYXNlKCl9KTtcbiAgICAgICAgfSBlbHNlIGlmIChjb25maWcuanNvbnAgJiYgY2FsbE9wZXJhdGlvbiA9PT0gJ2dldCcpIHtcbiAgICAgICAgICBjYWxsT3BlcmF0aW9uID0gJ2pzb25wJztcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChjb25maWcuaXNTYWZlKG9wZXJhdGlvbikpIHtcbiAgICAgICAgICBpZiAoaXNPdmVycmlkZU9wZXJhdGlvbikge1xuICAgICAgICAgICAgdXJsSGFuZGxlci5yZXNvdXJjZSh0aGlzLCAkaHR0cCwgcmVxdWVzdC5odHRwQ29uZmlnLCBjYWxsSGVhZGVycywgcmVxdWVzdC5wYXJhbXMsXG4gICAgICAgICAgICAgIHdoYXQsIGV0YWcsIGNhbGxPcGVyYXRpb24pW2NhbGxPcGVyYXRpb25dKHt9KS5zdWJzY3JpYmUob2tDYWxsYmFjaywgZXJyb3JDYWxsYmFjayk7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHVybEhhbmRsZXIucmVzb3VyY2UodGhpcywgJGh0dHAsIHJlcXVlc3QuaHR0cENvbmZpZywgY2FsbEhlYWRlcnMsIHJlcXVlc3QucGFyYW1zLFxuICAgICAgICAgICAgICB3aGF0LCBldGFnLCBjYWxsT3BlcmF0aW9uKVtjYWxsT3BlcmF0aW9uXSgpLnN1YnNjcmliZShva0NhbGxiYWNrLCBlcnJvckNhbGxiYWNrKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgdXJsSGFuZGxlci5yZXNvdXJjZSh0aGlzLCAkaHR0cCwgcmVxdWVzdC5odHRwQ29uZmlnLCBjYWxsSGVhZGVycywgcmVxdWVzdC5wYXJhbXMsXG4gICAgICAgICAgICB3aGF0LCBldGFnLCBjYWxsT3BlcmF0aW9uKVtjYWxsT3BlcmF0aW9uXShyZXF1ZXN0LmVsZW1lbnQpLnN1YnNjcmliZShva0NhbGxiYWNrLCBlcnJvckNhbGxiYWNrKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiByZXN0YW5ndWxhcml6ZVJlc3BvbnNlKHN1YmplY3QsIGZhbHNlLCBmaWxsZWRPYmplY3QpO1xuICAgICAgfVxuXG4gICAgICBmdW5jdGlvbiBnZXRGdW5jdGlvbihwYXJhbXMsIGhlYWRlcnMpIHtcbiAgICAgICAgcmV0dXJuIGJpbmQoZWxlbUZ1bmN0aW9uLCB0aGlzKSgnZ2V0JywgdW5kZWZpbmVkLCBwYXJhbXMsIHVuZGVmaW5lZCwgaGVhZGVycyk7XG4gICAgICB9XG5cbiAgICAgIGZ1bmN0aW9uIGRlbGV0ZUZ1bmN0aW9uKHBhcmFtcywgaGVhZGVycykge1xuICAgICAgICByZXR1cm4gYmluZChlbGVtRnVuY3Rpb24sIHRoaXMpKCdyZW1vdmUnLCB1bmRlZmluZWQsIHBhcmFtcywgdW5kZWZpbmVkLCBoZWFkZXJzKTtcbiAgICAgIH1cblxuICAgICAgZnVuY3Rpb24gcHV0RnVuY3Rpb24ocGFyYW1zLCBoZWFkZXJzKSB7XG4gICAgICAgIHJldHVybiBiaW5kKGVsZW1GdW5jdGlvbiwgdGhpcykoJ3B1dCcsIHVuZGVmaW5lZCwgcGFyYW1zLCB1bmRlZmluZWQsIGhlYWRlcnMpO1xuICAgICAgfVxuXG4gICAgICBmdW5jdGlvbiBwb3N0RnVuY3Rpb24od2hhdCwgZWxlbSwgcGFyYW1zLCBoZWFkZXJzKSB7XG4gICAgICAgIHJldHVybiBiaW5kKGVsZW1GdW5jdGlvbiwgdGhpcykoJ3Bvc3QnLCB3aGF0LCBwYXJhbXMsIGVsZW0sIGhlYWRlcnMpO1xuICAgICAgfVxuXG4gICAgICBmdW5jdGlvbiBoZWFkRnVuY3Rpb24ocGFyYW1zLCBoZWFkZXJzKSB7XG4gICAgICAgIHJldHVybiBiaW5kKGVsZW1GdW5jdGlvbiwgdGhpcykoJ2hlYWQnLCB1bmRlZmluZWQsIHBhcmFtcywgdW5kZWZpbmVkLCBoZWFkZXJzKTtcbiAgICAgIH1cblxuICAgICAgZnVuY3Rpb24gdHJhY2VGdW5jdGlvbihwYXJhbXMsIGhlYWRlcnMpIHtcbiAgICAgICAgcmV0dXJuIGJpbmQoZWxlbUZ1bmN0aW9uLCB0aGlzKSgndHJhY2UnLCB1bmRlZmluZWQsIHBhcmFtcywgdW5kZWZpbmVkLCBoZWFkZXJzKTtcbiAgICAgIH1cblxuICAgICAgZnVuY3Rpb24gb3B0aW9uc0Z1bmN0aW9uKHBhcmFtcywgaGVhZGVycykge1xuICAgICAgICByZXR1cm4gYmluZChlbGVtRnVuY3Rpb24sIHRoaXMpKCdvcHRpb25zJywgdW5kZWZpbmVkLCBwYXJhbXMsIHVuZGVmaW5lZCwgaGVhZGVycyk7XG4gICAgICB9XG5cbiAgICAgIGZ1bmN0aW9uIHBhdGNoRnVuY3Rpb24oZWxlbSwgcGFyYW1zLCBoZWFkZXJzKSB7XG4gICAgICAgIHJldHVybiBiaW5kKGVsZW1GdW5jdGlvbiwgdGhpcykoJ3BhdGNoJywgdW5kZWZpbmVkLCBwYXJhbXMsIGVsZW0sIGhlYWRlcnMpO1xuICAgICAgfVxuXG4gICAgICBmdW5jdGlvbiBjdXN0b21GdW5jdGlvbihvcGVyYXRpb24sIHBhdGgsIHBhcmFtcywgaGVhZGVycywgZWxlbSkge1xuICAgICAgICByZXR1cm4gYmluZChlbGVtRnVuY3Rpb24sIHRoaXMpKG9wZXJhdGlvbiwgcGF0aCwgcGFyYW1zLCBlbGVtLCBoZWFkZXJzKTtcbiAgICAgIH1cblxuICAgICAgZnVuY3Rpb24gYWRkUmVzdGFuZ3VsYXJNZXRob2RGdW5jdGlvbihuYW1lLCBvcGVyYXRpb24sIHBhdGgsIGRlZmF1bHRQYXJhbXMsIGRlZmF1bHRIZWFkZXJzLCBkZWZhdWx0RWxlbSkge1xuICAgICAgICBsZXQgYmluZGVkRnVuY3Rpb247XG4gICAgICAgIGlmIChvcGVyYXRpb24gPT09ICdnZXRMaXN0Jykge1xuICAgICAgICAgIGJpbmRlZEZ1bmN0aW9uID0gYmluZChmZXRjaEZ1bmN0aW9uLCB0aGlzLCBwYXRoKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBiaW5kZWRGdW5jdGlvbiA9IGJpbmQoY3VzdG9tRnVuY3Rpb24sIHRoaXMsIG9wZXJhdGlvbiwgcGF0aCk7XG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCBjcmVhdGVkRnVuY3Rpb24gPSBmdW5jdGlvbiAocGFyYW1zLCBoZWFkZXJzLCBlbGVtKSB7XG4gICAgICAgICAgY29uc3QgY2FsbFBhcmFtcyA9IGRlZmF1bHRzKHtcbiAgICAgICAgICAgIHBhcmFtczogcGFyYW1zLFxuICAgICAgICAgICAgaGVhZGVyczogaGVhZGVycyxcbiAgICAgICAgICAgIGVsZW06IGVsZW1cbiAgICAgICAgICB9LCB7XG4gICAgICAgICAgICBwYXJhbXM6IGRlZmF1bHRQYXJhbXMsXG4gICAgICAgICAgICBoZWFkZXJzOiBkZWZhdWx0SGVhZGVycyxcbiAgICAgICAgICAgIGVsZW06IGRlZmF1bHRFbGVtXG4gICAgICAgICAgfSk7XG4gICAgICAgICAgcmV0dXJuIGJpbmRlZEZ1bmN0aW9uKGNhbGxQYXJhbXMucGFyYW1zLCBjYWxsUGFyYW1zLmhlYWRlcnMsIGNhbGxQYXJhbXMuZWxlbSk7XG4gICAgICAgIH07XG5cbiAgICAgICAgaWYgKGNvbmZpZy5pc1NhZmUob3BlcmF0aW9uKSkge1xuICAgICAgICAgIHRoaXNbbmFtZV0gPSBjcmVhdGVkRnVuY3Rpb247XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgdGhpc1tuYW1lXSA9IGZ1bmN0aW9uIChlbGVtLCBwYXJhbXMsIGhlYWRlcnMpIHtcbiAgICAgICAgICAgIHJldHVybiBjcmVhdGVkRnVuY3Rpb24ocGFyYW1zLCBoZWFkZXJzLCBlbGVtKTtcbiAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIGZ1bmN0aW9uIHdpdGhDb25maWd1cmF0aW9uRnVuY3Rpb24oY29uZmlndXJlcikge1xuICAgICAgICBjb25zdCBuZXdDb25maWcgPSBjbG9uZShvbWl0KGNvbmZpZywgJ2NvbmZpZ3VyYXRpb24nKSk7XG4gICAgICAgIFJlc3Rhbmd1bGFyQ29uZmlndXJlcihuZXdDb25maWcsIG5ld0NvbmZpZyk7XG4gICAgICAgIGNvbmZpZ3VyZXIobmV3Q29uZmlnKTtcbiAgICAgICAgcmV0dXJuIGNyZWF0ZVNlcnZpY2VGb3JDb25maWd1cmF0aW9uKG5ld0NvbmZpZyk7XG4gICAgICB9XG5cbiAgICAgIGZ1bmN0aW9uIHRvU2VydmljZShyb3V0ZSwgcGFyZW50KSB7XG4gICAgICAgIGNvbnN0IGtub3duQ29sbGVjdGlvbk1ldGhvZHMgPSB2YWx1ZXMoY29uZmlnLnJlc3Rhbmd1bGFyRmllbGRzKTtcbiAgICAgICAgY29uc3Qgc2VydjogYW55ID0ge307XG4gICAgICAgIGNvbnN0IGNvbGxlY3Rpb24gPSAocGFyZW50IHx8IHNlcnZpY2UpLmFsbChyb3V0ZSk7XG4gICAgICAgIHNlcnYub25lID0gYmluZChvbmUsIChwYXJlbnQgfHwgc2VydmljZSksIHBhcmVudCwgcm91dGUpO1xuICAgICAgICBzZXJ2LmFsbCA9IGJpbmQoY29sbGVjdGlvbi5hbGwsIGNvbGxlY3Rpb24pO1xuICAgICAgICBzZXJ2LnBvc3QgPSBiaW5kKGNvbGxlY3Rpb24ucG9zdCwgY29sbGVjdGlvbik7XG4gICAgICAgIHNlcnYuZ2V0TGlzdCA9IGJpbmQoY29sbGVjdGlvbi5nZXRMaXN0LCBjb2xsZWN0aW9uKTtcbiAgICAgICAgc2Vydi53aXRoSHR0cENvbmZpZyA9IGJpbmQoY29sbGVjdGlvbi53aXRoSHR0cENvbmZpZywgY29sbGVjdGlvbik7XG4gICAgICAgIHNlcnYuZ2V0ID0gYmluZChjb2xsZWN0aW9uLmdldCwgY29sbGVjdGlvbik7XG5cbiAgICAgICAgZm9yIChjb25zdCBwcm9wIGluIGNvbGxlY3Rpb24pIHtcbiAgICAgICAgICBpZiAoY29sbGVjdGlvbi5oYXNPd25Qcm9wZXJ0eShwcm9wKSAmJiBpc0Z1bmN0aW9uKGNvbGxlY3Rpb25bcHJvcF0pICYmICFpbmNsdWRlcyhrbm93bkNvbGxlY3Rpb25NZXRob2RzLCBwcm9wKSkge1xuICAgICAgICAgICAgc2Vydltwcm9wXSA9IGJpbmQoY29sbGVjdGlvbltwcm9wXSwgY29sbGVjdGlvbik7XG4gICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHNlcnY7XG4gICAgICB9XG5cbiAgICAgIFJlc3Rhbmd1bGFyQ29uZmlndXJlcihzZXJ2aWNlLCBjb25maWcpO1xuXG4gICAgICBzZXJ2aWNlLmNvcHkgPSBiaW5kKGNvcHlSZXN0YW5ndWxhcml6ZWRFbGVtZW50LCBzZXJ2aWNlKTtcblxuICAgICAgc2VydmljZS5zZXJ2aWNlID0gYmluZCh0b1NlcnZpY2UsIHNlcnZpY2UpO1xuXG4gICAgICBzZXJ2aWNlLndpdGhDb25maWcgPSBiaW5kKHdpdGhDb25maWd1cmF0aW9uRnVuY3Rpb24sIHNlcnZpY2UpO1xuXG4gICAgICBzZXJ2aWNlLm9uZSA9IGJpbmQob25lLCBzZXJ2aWNlLCBudWxsKTtcblxuICAgICAgc2VydmljZS5hbGwgPSBiaW5kKGFsbCwgc2VydmljZSwgbnVsbCk7XG5cbiAgICAgIHNlcnZpY2Uuc2V2ZXJhbCA9IGJpbmQoc2V2ZXJhbCwgc2VydmljZSwgbnVsbCk7XG5cbiAgICAgIHNlcnZpY2Uub25lVXJsID0gYmluZChvbmVVcmwsIHNlcnZpY2UsIG51bGwpO1xuXG4gICAgICBzZXJ2aWNlLmFsbFVybCA9IGJpbmQoYWxsVXJsLCBzZXJ2aWNlLCBudWxsKTtcblxuICAgICAgc2VydmljZS5zdHJpcFJlc3Rhbmd1bGFyID0gYmluZChzdHJpcFJlc3Rhbmd1bGFyLCBzZXJ2aWNlKTtcblxuICAgICAgc2VydmljZS5yZXN0YW5ndWxhcml6ZUVsZW1lbnQgPSBiaW5kKHJlc3Rhbmd1bGFyaXplRWxlbSwgc2VydmljZSk7XG5cbiAgICAgIHNlcnZpY2UucmVzdGFuZ3VsYXJpemVDb2xsZWN0aW9uID0gYmluZChyZXN0YW5ndWxhcml6ZUNvbGxlY3Rpb25BbmRFbGVtZW50cywgc2VydmljZSk7XG5cbiAgICAgIHJldHVybiBzZXJ2aWNlO1xuICAgIH1cblxuICAgIHJldHVybiBjcmVhdGVTZXJ2aWNlRm9yQ29uZmlndXJhdGlvbihnbG9iYWxDb25maWd1cmF0aW9uKTtcbiAgfVxuXG59XG4iXX0=